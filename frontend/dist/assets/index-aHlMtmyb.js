import{j as e,B as k,V as u,T as n,a as O,_ as Cs,b as Ft,H as h,I as It,u as ps,c as Oe,d as ge,e as Le,f as La,E as Wa,M as Ve,g as We,h as qe,i as Me,k as Z,l as He,m as $e,U as at,L as Te,D as hs,C as Ma,n as xr,o as Hs,F as vs,p as _e,q as Jr,r as Kr,s as $a,t as Ba,v as Va,w as ye,x as An,y as En,z as qa,A as Ha,G as Tn,J as gr,K as is,N as F,O as L,P as De,Q as Ie,R as U,S as G,W as re,X as Ze,Y as os,Z as Ge,$ as Ye,a0 as Xe,a1 as Qe,a2 as Ss,a3 as Ct,a4 as kr,a5 as Ua,a6 as Je,a7 as ks,a8 as As,a9 as Pe,aa as Nr,ab as Vt,ac as Dn,ad as Ga,ae as Ws,af as ar,ag as ir,ah as Rr,ai as Or,aj as In,ak as _n,al as Zs,am as et,an as ms,ao as oe,ap as st,aq as le,ar as Ya,as as Xa,at as Qa,au as Zr,av as Ja,aw as en,ax as kn,ay as Ka,az as Za,aA as ei,aB as si,aC as ti,aD as mr,aE as sn,aF as fr,aG as jr,aH as ri,aI as ni,aJ as ai}from"./chakra-CWkQ078C.js";import{a as ii,r as S,b as pe}from"./vendor-Q3K9tvtn.js";import{N as ft,O as Nn,u as tt,a as oi,b as Rn,c as li,R as ci,d as ns,B as di}from"./router-HhaMLxGd.js";import{a as as,c as pt}from"./utils-DzZC5mzC.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var br={},tn=ii;br.createRoot=tn.createRoot,br.hydrateRoot=tn.hydrateRoot;function On(s){var t,r,a="";if(typeof s=="string"||typeof s=="number")a+=s;else if(typeof s=="object")if(Array.isArray(s)){var i=s.length;for(t=0;t<i;t++)s[t]&&(r=On(s[t]))&&(a&&(a+=" "),a+=r)}else for(r in s)s[r]&&(a&&(a+=" "),a+=r);return a}function Gs(){for(var s,t,r=0,a="",i=arguments.length;r<i;r++)(s=arguments[r])&&(t=On(s))&&(a&&(a+=" "),a+=t);return a}function ui(s){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=s:r.appendChild(document.createTextNode(s))}ui(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var wt=s=>typeof s=="number"&&!isNaN(s),Js=s=>typeof s=="string",Os=s=>typeof s=="function",hi=s=>Js(s)||wt(s),yr=s=>Js(s)||Os(s)?s:null,pi=(s,t)=>s===!1||wt(s)&&s>0?s:t,vr=s=>S.isValidElement(s)||Js(s)||Os(s)||wt(s);function xi(s,t,r=300){let{scrollHeight:a,style:i}=s;requestAnimationFrame(()=>{i.minHeight="initial",i.height=a+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,r)})})}function gi({enter:s,exit:t,appendPosition:r=!1,collapse:a=!0,collapseDuration:i=300}){return function({children:l,position:o,preventExitTransition:c,done:d,nodeRef:f,isIn:P,playToast:I}){let m=r?`${s}--${o}`:s,T=r?`${t}--${o}`:t,C=S.useRef(0);return S.useLayoutEffect(()=>{let D=f.current,_=m.split(" "),y=z=>{z.target===f.current&&(I(),D.removeEventListener("animationend",y),D.removeEventListener("animationcancel",y),C.current===0&&z.type!=="animationcancel"&&D.classList.remove(..._))};D.classList.add(..._),D.addEventListener("animationend",y),D.addEventListener("animationcancel",y)},[]),S.useEffect(()=>{let D=f.current,_=()=>{D.removeEventListener("animationend",_),a?xi(D,d,i):d()};P||(c?_():(C.current=1,D.className+=` ${T}`,D.addEventListener("animationend",_)))},[P]),pe.createElement(pe.Fragment,null,l)}}function rn(s,t){return{content:Fn(s.content,s.props),containerId:s.props.containerId,id:s.props.toastId,theme:s.props.theme,type:s.props.type,data:s.props.data||{},isLoading:s.props.isLoading,icon:s.props.icon,reason:s.removalReason,status:t}}function Fn(s,t,r=!1){return S.isValidElement(s)&&!Js(s.type)?S.cloneElement(s,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):Os(s)?s({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):s}function mi({closeToast:s,theme:t,ariaLabel:r="close"}){return pe.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:a=>{a.stopPropagation(),s(!0)},"aria-label":r},pe.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},pe.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function fi({delay:s,isRunning:t,closeToast:r,type:a="default",hide:i,className:l,controlledProgress:o,progress:c,rtl:d,isIn:f,theme:P}){let I=i||o&&c===0,m={animationDuration:`${s}ms`,animationPlayState:t?"running":"paused"};o&&(m.transform=`scaleX(${c})`);let T=Gs("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${P}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":d}),C=Os(l)?l({rtl:d,type:a,defaultClassName:T}):Gs(T,l),D={[o&&c>=1?"onTransitionEnd":"onAnimationEnd"]:o&&c<1?null:()=>{f&&r()}};return pe.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":I},pe.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${P} Toastify__progress-bar--${a}`}),pe.createElement("div",{role:"progressbar","aria-hidden":I?"true":"false","aria-label":"notification timer",className:C,style:m,...D}))}var ji=1,Ln=()=>`${ji++}`;function bi(s,t,r){let a=1,i=0,l=[],o=[],c=t,d=new Map,f=new Set,P=z=>(f.add(z),()=>f.delete(z)),I=()=>{o=Array.from(d.values()),f.forEach(z=>z())},m=({containerId:z,toastId:E,updateId:N})=>{let $=z?z!==s:s!==1,R=d.has(E)&&N==null;return $||R},T=(z,E)=>{d.forEach(N=>{var $;(E==null||E===N.props.toastId)&&(($=N.toggle)==null||$.call(N,z))})},C=z=>{var E,N;(N=(E=z.props)==null?void 0:E.onClose)==null||N.call(E,z.removalReason),z.isActive=!1},D=z=>{if(z==null)d.forEach(C);else{let E=d.get(z);E&&C(E)}I()},_=()=>{i-=l.length,l=[]},y=z=>{var E,N;let{toastId:$,updateId:R}=z.props,p=R==null;z.staleId&&d.delete(z.staleId),z.isActive=!0,d.set($,z),I(),r(rn(z,p?"added":"updated")),p&&((N=(E=z.props).onOpen)==null||N.call(E))};return{id:s,props:c,observe:P,toggle:T,removeToast:D,toasts:d,clearQueue:_,buildToast:(z,E)=>{if(m(E))return;let{toastId:N,updateId:$,data:R,staleId:p,delay:H}=E,b=$==null;b&&i++;let ae={...c,style:c.toastStyle,key:a++,...Object.fromEntries(Object.entries(E).filter(([B,V])=>V!=null)),toastId:N,updateId:$,data:R,isIn:!1,className:yr(E.className||c.toastClassName),progressClassName:yr(E.progressClassName||c.progressClassName),autoClose:E.isLoading?!1:pi(E.autoClose,c.autoClose),closeToast(B){d.get(N).removalReason=B,D(N)},deleteToast(){let B=d.get(N);if(B!=null){if(r(rn(B,"removed")),d.delete(N),i--,i<0&&(i=0),l.length>0){y(l.shift());return}I()}}};ae.closeButton=c.closeButton,E.closeButton===!1||vr(E.closeButton)?ae.closeButton=E.closeButton:E.closeButton===!0&&(ae.closeButton=vr(c.closeButton)?c.closeButton:!0);let g={content:z,props:ae,staleId:p};c.limit&&c.limit>0&&i>c.limit&&b?l.push(g):wt(H)?setTimeout(()=>{y(g)},H):y(g)},setProps(z){c=z},setToggle:(z,E)=>{let N=d.get(z);N&&(N.toggle=E)},isToastActive:z=>{var E;return(E=d.get(z))==null?void 0:E.isActive},getSnapshot:()=>o}}var xs=new Map,yt=[],Sr=new Set,yi=s=>Sr.forEach(t=>t(s)),Wn=()=>xs.size>0;function vi(){yt.forEach(s=>$n(s.content,s.options)),yt=[]}var Si=(s,{containerId:t})=>{var r;return(r=xs.get(t||1))==null?void 0:r.toasts.get(s)};function Mn(s,t){var r;if(t)return!!((r=xs.get(t))!=null&&r.isToastActive(s));let a=!1;return xs.forEach(i=>{i.isToastActive(s)&&(a=!0)}),a}function Ci(s){if(!Wn()){yt=yt.filter(t=>s!=null&&t.options.toastId!==s);return}if(s==null||hi(s))xs.forEach(t=>{t.removeToast(s)});else if(s&&("containerId"in s||"id"in s)){let t=xs.get(s.containerId);t?t.removeToast(s.id):xs.forEach(r=>{r.removeToast(s.id)})}}var wi=(s={})=>{xs.forEach(t=>{t.props.limit&&(!s.containerId||t.id===s.containerId)&&t.clearQueue()})};function $n(s,t){vr(s)&&(Wn()||yt.push({content:s,options:t}),xs.forEach(r=>{r.buildToast(s,t)}))}function zi(s){var t;(t=xs.get(s.containerId||1))==null||t.setToggle(s.id,s.fn)}function Bn(s,t){xs.forEach(r=>{(t==null||!(t!=null&&t.containerId)||(t==null?void 0:t.containerId)===r.id)&&r.toggle(s,t==null?void 0:t.id)})}function Pi(s){let t=s.containerId||1;return{subscribe(r){let a=bi(t,s,yi);xs.set(t,a);let i=a.observe(r);return vi(),()=>{i(),xs.delete(t)}},setProps(r){var a;(a=xs.get(t))==null||a.setProps(r)},getSnapshot(){var r;return(r=xs.get(t))==null?void 0:r.getSnapshot()}}}function Ai(s){return Sr.add(s),()=>{Sr.delete(s)}}function Ei(s){return s&&(Js(s.toastId)||wt(s.toastId))?s.toastId:Ln()}function zt(s,t){return $n(s,t),t.toastId}function qt(s,t){return{...t,type:t&&t.type||s,toastId:Ei(t)}}function Ht(s){return(t,r)=>zt(t,qt(s,r))}function ke(s,t){return zt(s,qt("default",t))}ke.loading=(s,t)=>zt(s,qt("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function Ti(s,{pending:t,error:r,success:a},i){let l;t&&(l=Js(t)?ke.loading(t,i):ke.loading(t.render,{...i,...t}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(f,P,I)=>{if(P==null){ke.dismiss(l);return}let m={type:f,...o,...i,data:I},T=Js(P)?{render:P}:P;return l?ke.update(l,{...m,...T}):ke(T.render,{...m,...T}),I},d=Os(s)?s():s;return d.then(f=>c("success",a,f)).catch(f=>c("error",r,f)),d}ke.promise=Ti;ke.success=Ht("success");ke.info=Ht("info");ke.error=Ht("error");ke.warning=Ht("warning");ke.warn=ke.warning;ke.dark=(s,t)=>zt(s,qt("default",{theme:"dark",...t}));function Di(s){Ci(s)}ke.dismiss=Di;ke.clearWaitingQueue=wi;ke.isActive=Mn;ke.update=(s,t={})=>{let r=Si(s,t);if(r){let{props:a,content:i}=r,l={delay:100,...a,...t,toastId:t.toastId||s,updateId:Ln()};l.toastId!==s&&(l.staleId=s);let o=l.render||i;delete l.render,zt(o,l)}};ke.done=s=>{ke.update(s,{progress:1})};ke.onChange=Ai;ke.play=s=>Bn(!0,s);ke.pause=s=>Bn(!1,s);function Ii(s){var t;let{subscribe:r,getSnapshot:a,setProps:i}=S.useRef(Pi(s)).current;i(s);let l=(t=S.useSyncExternalStore(r,a,a))==null?void 0:t.slice();function o(c){if(!l)return[];let d=new Map;return s.newestOnTop&&l.reverse(),l.forEach(f=>{let{position:P}=f.props;d.has(P)||d.set(P,[]),d.get(P).push(f)}),Array.from(d,f=>c(f[0],f[1]))}return{getToastToRender:o,isToastActive:Mn,count:l==null?void 0:l.length}}function _i(s){let[t,r]=S.useState(!1),[a,i]=S.useState(!1),l=S.useRef(null),o=S.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:c,pauseOnHover:d,closeToast:f,onClick:P,closeOnClick:I}=s;zi({id:s.toastId,containerId:s.containerId,fn:r}),S.useEffect(()=>{if(s.pauseOnFocusLoss)return m(),()=>{T()}},[s.pauseOnFocusLoss]);function m(){document.hasFocus()||y(),window.addEventListener("focus",_),window.addEventListener("blur",y)}function T(){window.removeEventListener("focus",_),window.removeEventListener("blur",y)}function C(p){if(s.draggable===!0||s.draggable===p.pointerType){z();let H=l.current;o.canCloseOnClick=!0,o.canDrag=!0,H.style.transition="none",s.draggableDirection==="x"?(o.start=p.clientX,o.removalDistance=H.offsetWidth*(s.draggablePercent/100)):(o.start=p.clientY,o.removalDistance=H.offsetHeight*(s.draggablePercent===80?s.draggablePercent*1.5:s.draggablePercent)/100)}}function D(p){let{top:H,bottom:b,left:ae,right:g}=l.current.getBoundingClientRect();p.nativeEvent.type!=="touchend"&&s.pauseOnHover&&p.clientX>=ae&&p.clientX<=g&&p.clientY>=H&&p.clientY<=b?y():_()}function _(){r(!0)}function y(){r(!1)}function z(){o.didMove=!1,document.addEventListener("pointermove",N),document.addEventListener("pointerup",$)}function E(){document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",$)}function N(p){let H=l.current;if(o.canDrag&&H){o.didMove=!0,t&&y(),s.draggableDirection==="x"?o.delta=p.clientX-o.start:o.delta=p.clientY-o.start,o.start!==p.clientX&&(o.canCloseOnClick=!1);let b=s.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;H.style.transform=`translate3d(${b},0)`,H.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function $(){E();let p=l.current;if(o.canDrag&&o.didMove&&p){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){i(!0),s.closeToast(!0),s.collapseAll();return}p.style.transition="transform 0.2s, opacity 0.2s",p.style.removeProperty("transform"),p.style.removeProperty("opacity")}}let R={onPointerDown:C,onPointerUp:D};return c&&d&&(R.onMouseEnter=y,s.stacked||(R.onMouseLeave=_)),I&&(R.onClick=p=>{P&&P(p),o.canCloseOnClick&&f(!0)}),{playToast:_,pauseToast:y,isRunning:t,preventExitTransition:a,toastRef:l,eventHandlers:R}}var ki=typeof window<"u"?S.useLayoutEffect:S.useEffect,Ut=({theme:s,type:t,isLoading:r,...a})=>pe.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:s==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...a});function Ni(s){return pe.createElement(Ut,{...s},pe.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Ri(s){return pe.createElement(Ut,{...s},pe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Oi(s){return pe.createElement(Ut,{...s},pe.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Fi(s){return pe.createElement(Ut,{...s},pe.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Li(){return pe.createElement("div",{className:"Toastify__spinner"})}var Cr={info:Ri,warning:Ni,success:Oi,error:Fi,spinner:Li},Wi=s=>s in Cr;function Mi({theme:s,type:t,isLoading:r,icon:a}){let i=null,l={theme:s,type:t};return a===!1||(Os(a)?i=a({...l,isLoading:r}):S.isValidElement(a)?i=S.cloneElement(a,l):r?i=Cr.spinner():Wi(t)&&(i=Cr[t](l))),i}var $i=s=>{let{isRunning:t,preventExitTransition:r,toastRef:a,eventHandlers:i,playToast:l}=_i(s),{closeButton:o,children:c,autoClose:d,onClick:f,type:P,hideProgressBar:I,closeToast:m,transition:T,position:C,className:D,style:_,progressClassName:y,updateId:z,role:E,progress:N,rtl:$,toastId:R,deleteToast:p,isIn:H,isLoading:b,closeOnClick:ae,theme:g,ariaLabel:B}=s,V=Gs("Toastify__toast",`Toastify__toast-theme--${g}`,`Toastify__toast--${P}`,{"Toastify__toast--rtl":$},{"Toastify__toast--close-on-click":ae}),te=Os(D)?D({rtl:$,position:C,type:P,defaultClassName:V}):Gs(V,D),Ce=Mi(s),xe=!!N||!d,Ae={closeToast:m,type:P,theme:g},Ne=null;return o===!1||(Os(o)?Ne=o(Ae):S.isValidElement(o)?Ne=S.cloneElement(o,Ae):Ne=mi(Ae)),pe.createElement(T,{isIn:H,done:p,position:C,preventExitTransition:r,nodeRef:a,playToast:l},pe.createElement("div",{id:R,tabIndex:0,onClick:f,"data-in":H,className:te,...i,style:_,ref:a,...H&&{role:E,"aria-label":B}},Ce!=null&&pe.createElement("div",{className:Gs("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!b})},Ce),Fn(c,s,!t),Ne,!s.customProgressBar&&pe.createElement(fi,{...z&&!xe?{key:`p-${z}`}:{},rtl:$,theme:g,delay:d,isRunning:t,isIn:H,closeToast:m,hide:I,type:P,className:y,controlledProgress:xe,progress:N||0})))},Bi=(s,t=!1)=>({enter:`Toastify--animate Toastify__${s}-enter`,exit:`Toastify--animate Toastify__${s}-exit`,appendPosition:t}),Vi=gi(Bi("bounce",!0)),qi={position:"top-right",transition:Vi,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:s=>s.altKey&&s.code==="KeyT"};function Hi(s){let t={...qi,...s},r=s.stacked,[a,i]=S.useState(!0),l=S.useRef(null),{getToastToRender:o,isToastActive:c,count:d}=Ii(t),{className:f,style:P,rtl:I,containerId:m,hotKeys:T}=t;function C(_){let y=Gs("Toastify__toast-container",`Toastify__toast-container--${_}`,{"Toastify__toast-container--rtl":I});return Os(f)?f({position:_,rtl:I,defaultClassName:y}):Gs(y,yr(f))}function D(){r&&(i(!0),ke.play())}return ki(()=>{var _;if(r){let y=l.current.querySelectorAll('[data-in="true"]'),z=12,E=(_=t.position)==null?void 0:_.includes("top"),N=0,$=0;Array.from(y).reverse().forEach((R,p)=>{let H=R;H.classList.add("Toastify__toast--stacked"),p>0&&(H.dataset.collapsed=`${a}`),H.dataset.pos||(H.dataset.pos=E?"top":"bot");let b=N*(a?.2:1)+(a?0:z*p);H.style.setProperty("--y",`${E?b:b*-1}px`),H.style.setProperty("--g",`${z}`),H.style.setProperty("--s",`${1-(a?$:0)}`),N+=H.offsetHeight,$+=.025})}},[a,d,r]),S.useEffect(()=>{function _(y){var z;let E=l.current;T(y)&&((z=E.querySelector('[tabIndex="0"]'))==null||z.focus(),i(!1),ke.pause()),y.key==="Escape"&&(document.activeElement===E||E!=null&&E.contains(document.activeElement))&&(i(!0),ke.play())}return document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}},[T]),pe.createElement("section",{ref:l,className:"Toastify",id:m,onMouseEnter:()=>{r&&(i(!1),ke.pause())},onMouseLeave:D,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},o((_,y)=>{let z=y.length?{...P}:{...P,pointerEvents:"none"};return pe.createElement("div",{tabIndex:-1,className:C(_),"data-stacked":r,style:z,key:`c-${_}`},y.map(({content:E,props:N})=>pe.createElement($i,{...N,stacked:r,collapseAll:D,isIn:c(N.toastId,N.containerId),key:`t-${N.key}`},E)))}))}const X=as.create({baseURL:"https://aquayara.onrender.com",headers:{"Content-Type":"application/json"},withCredentials:!0});X.interceptors.request.use(s=>{const t=localStorage.getItem("token");return console.log("🌐 URL completa:",s.baseURL+s.url),console.log("🌐 BaseURL configurado:",s.baseURL),console.log("🌐 URL relativa:",s.url),console.log("🔑 Token presente:",t?"Sí":"No"),console.log("🔑 Token completo:",t),t?(s.headers.Authorization=`Bearer ${t}`,console.log("🔑 Token enviado para:",s.url),console.log("🔑 Header configurado:",s.headers.Authorization)):console.log("❌ No hay token disponible"),s},s=>(console.error("❌ Error en interceptor de request:",s),Promise.reject(s)));X.interceptors.response.use(s=>(console.log("📦 Respuesta recibida de:",s.config.url),console.log("📦 Status:",s.status),console.log("📦 Content-Type:",s.headers["content-type"]),s),async s=>{var a,i,l;const t=s.config,r=localStorage.getItem("token");if(console.log("❌ Error en respuesta:",(a=s.response)==null?void 0:a.status,(i=s.config)==null?void 0:i.url),s.response&&s.response.status===401&&!t._retry&&r&&!((l=t.url)!=null&&l.includes("/auth/profile"))){console.log("🔄 Token expirado, se reintentará automáticamente"),t._retry=!0;try{const o=await as.post("https://aquayara.onrender.com/api/auth/refresh",{},{headers:{Authorization:`Bearer ${r}`}});if(o.data.success){const c=o.data.token;return localStorage.setItem("token",c),t.headers.Authorization=`Bearer ${c}`,console.log("✅ Token renovado exitosamente"),X(t)}}catch(o){return console.error("❌ Error al renovar token:",o),localStorage.removeItem("token"),window.location.href="/login",Promise.reject(o)}}return s.response&&s.response.status===404&&console.log("Recurso no encontrado:",s.response.data),Promise.reject(s)});const Rs=pt((s,t)=>({token:localStorage.getItem("token")||null,user:null,loading:!1,error:null,login:async(r,a)=>{var i,l,o,c;s({loading:!0,error:null});try{let d;try{d=await X.post("/api/delivery/login",{username:r,password:a})}catch{d=await X.post("/api/auth/login",{username:r,password:a})}const{token:f,user:P}=d.data;localStorage.setItem("token",f),X.defaults.headers.common.Authorization=`Bearer ${f}`;try{const I=await X.get("/api/auth/profile");s({token:f,user:I.data,loading:!1})}catch{s({token:f,user:P,loading:!1})}return{success:!0}}catch(d){return s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al iniciar sesión",loading:!1}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al iniciar sesión"}}},register:async r=>{var a,i,l,o;s({loading:!0,error:null});try{const c=await X.post("/api/auth/register",r);return s({loading:!1}),{success:!0,data:c.data}}catch(c){return s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al registrar usuario",loading:!1}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al registrar usuario"}}},logout:()=>{localStorage.removeItem("token"),delete X.defaults.headers.common.Authorization,s({token:null,user:null})},checkAuth:async()=>{var a,i,l;const r=localStorage.getItem("token");if(console.log("🔍 Token encontrado en localStorage:",!!r),!r)return console.log("❌ No hay token, usuario no autenticado"),s({token:null,user:null}),!1;try{console.log("🔄 Verificando token con el servidor..."),X.defaults.headers.common.Authorization=`Bearer ${r}`;const o=await X.get("/api/auth/profile");return console.log("✅ Token válido, usuario autenticado:",o.data),s({user:o.data,token:r}),!0}catch(o){return console.error("❌ Token inválido o error del servidor:",o),console.error("❌ Status:",(a=o.response)==null?void 0:a.status),console.error("❌ Message:",(l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message),localStorage.removeItem("token"),delete X.defaults.headers.common.Authorization,s({token:null,user:null}),!1}},clearError:()=>s({error:null})})),Vn=()=>{const{user:s}=Rs(),t=c=>!s||!s.role?!1:Array.isArray(c)?c.includes(s.role):s.role===c;return{user:s,hasRole:t,isAdmin:()=>t("admin"),isSeller:()=>t(["admin","vendedor"]),isClient:()=>t("cliente"),isDeliveryPerson:()=>t("repartidor"),canAccess:c=>t(c)}};var qn={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},nn=pe.createContext&&pe.createContext(qn),Ui=["attr","size","title"];function Gi(s,t){if(s==null)return{};var r=Yi(s,t),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)a=l[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(r[a]=s[a])}return r}function Yi(s,t){if(s==null)return{};var r={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(t.indexOf(a)>=0)continue;r[a]=s[a]}return r}function Lt(){return Lt=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(s[a]=r[a])}return s},Lt.apply(this,arguments)}function an(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function Wt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?an(Object(r),!0).forEach(function(a){Xi(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):an(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function Xi(s,t,r){return t=Qi(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Qi(s){var t=Ji(s,"string");return typeof t=="symbol"?t:t+""}function Ji(s,t){if(typeof s!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Hn(s){return s&&s.map((t,r)=>pe.createElement(t.tag,Wt({key:r},t.attr),Hn(t.child)))}function ce(s){return t=>pe.createElement(Ki,Lt({attr:Wt({},s.attr)},t),Hn(s.child))}function Ki(s){var t=r=>{var{attr:a,size:i,title:l}=s,o=Gi(s,Ui),c=i||r.size||"1em",d;return r.className&&(d=r.className),s.className&&(d=(d?d+" ":"")+s.className),pe.createElement("svg",Lt({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,o,{className:d,style:Wt(Wt({color:s.color||r.color},r.style),s.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),l&&pe.createElement("title",null,l),s.children)};return nn!==void 0?pe.createElement(nn.Consumer,null,r=>t(r)):t(qn)}function it(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(s)}function Zi(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(s)}function or(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M509.5 184.6L458.9 32.8C452.4 13.2 434.1 0 413.4 0H272v192h238.7c-.4-2.5-.4-5-1.2-7.4zM240 0H98.6c-20.7 0-39 13.2-45.5 32.8L2.5 184.6c-.8 2.4-.8 4.9-1.2 7.4H240V0zM0 224v240c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V224H0z"},child:[]}]})(s)}function _s(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(s)}function Ps(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(s)}function lr(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(s)}function on(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(s)}function Bs(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V256H0v176zm192-68c0-6.6 5.4-12 12-12h136c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-40zm-128 0c0-6.6 5.4-12 12-12h72c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM576 80v48H0V80c0-26.5 21.5-48 48-48h480c26.5 0 48 21.5 48 48z"},child:[]}]})(s)}function eo(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.61 233.32L278.68 9.39c-12.52-12.52-32.83-12.52-45.36 0L9.39 233.32c-12.52 12.53-12.52 32.83 0 45.36l223.93 223.93c12.52 12.53 32.83 12.53 45.36 0l223.93-223.93c12.52-12.53 12.52-32.83 0-45.36zm-100.98 12.56l-84.21 77.73c-5.12 4.73-13.43 1.1-13.43-5.88V264h-96v64c0 4.42-3.58 8-8 8h-32c-4.42 0-8-3.58-8-8v-80c0-17.67 14.33-32 32-32h112v-53.73c0-6.97 8.3-10.61 13.43-5.88l84.21 77.73c3.43 3.17 3.43 8.59 0 11.76z"},child:[]}]})(s)}function Fr(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(s)}function wr(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(s)}function so(s){return ce({attr:{viewBox:"0 0 192 512"},child:[{tag:"path",attr:{d:"M96 184c39.8 0 72 32.2 72 72s-32.2 72-72 72-72-32.2-72-72 32.2-72 72-72zM24 80c0 39.8 32.2 72 72 72s72-32.2 72-72S135.8 8 96 8 24 40.2 24 80zm0 352c0 39.8 32.2 72 72 72s72-32.2 72-72-32.2-72-72-72-72 32.2-72 72z"},child:[]}]})(s)}function Lr(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(s)}function to(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(s)}function Un(s){return ce({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(s)}function Vs(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(s)}function Gn(s){return ce({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(s)}function ro(s){return ce({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 64c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16zm192.81 248H304c8.84 0 16 7.16 16 16s-7.16 16-16 16h-47.19c-16.45 0-31.27-9.14-38.64-23.86-2.95-5.92-8.09-6.52-10.17-6.52s-7.22.59-10.02 6.19l-7.67 15.34a15.986 15.986 0 0 1-14.31 8.84c-.38 0-.75-.02-1.14-.05-6.45-.45-12-4.75-14.03-10.89L144 354.59l-10.61 31.88c-5.89 17.66-22.38 29.53-41 29.53H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h12.39c4.83 0 9.11-3.08 10.64-7.66l18.19-54.64c3.3-9.81 12.44-16.41 22.78-16.41s19.48 6.59 22.77 16.41l13.88 41.64c19.77-16.19 54.05-9.7 66 14.16 2.02 4.06 5.96 6.5 10.16 6.5zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"},child:[]}]})(s)}function Wr(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 448c0 17.7 14.3 32 32 32h160V320H32v128zm256 32h160c17.7 0 32-14.3 32-32V320H288v160zm192-320h-42.1c6.2-12.1 10.1-25.5 10.1-40 0-48.5-39.5-88-88-88-41.6 0-68.5 21.3-103 68.3-34.5-47-61.4-68.3-103-68.3-48.5 0-88 39.5-88 88 0 14.5 3.8 27.9 10.1 40H32c-17.7 0-32 14.3-32 32v80c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16v-80c0-17.7-14.3-32-32-32zm-326.1 0c-22.1 0-40-17.9-40-40s17.9-40 40-40c19.9 0 34.6 3.3 86.1 80h-86.1zm206.1 0h-86.1c51.4-76.5 65.7-80 86.1-80 22.1 0 40 17.9 40 40s-17.9 40-40 40z"},child:[]}]})(s)}function zr(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(s)}function Yn(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 32H48C21.5 32 0 53.5 0 80v16h576V80c0-26.5-21.5-48-48-48zM0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V128H0v304zm352-232c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zM176 192c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zM67.1 396.2C75.5 370.5 99.6 352 128 352h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.9-5.2 19.8-15.6 19.8H82.7c-10.4 0-18.8-10-15.6-19.8z"},child:[]}]})(s)}function no(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(s)}function ao(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(s)}function vt(s){return ce({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(s)}function ys(s){return ce({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M621.16 54.46C582.37 38.19 543.55 32 504.75 32c-123.17-.01-246.33 62.34-369.5 62.34-30.89 0-61.76-3.92-92.65-13.72-3.47-1.1-6.95-1.62-10.35-1.62C15.04 79 0 92.32 0 110.81v317.26c0 12.63 7.23 24.6 18.84 29.46C57.63 473.81 96.45 480 135.25 480c123.17 0 246.34-62.35 369.51-62.35 30.89 0 61.76 3.92 92.65 13.72 3.47 1.1 6.95 1.62 10.35 1.62 17.21 0 32.25-13.32 32.25-31.81V83.93c-.01-12.64-7.24-24.6-18.85-29.47zM48 132.22c20.12 5.04 41.12 7.57 62.72 8.93C104.84 170.54 79 192.69 48 192.69v-60.47zm0 285v-47.78c34.37 0 62.18 27.27 63.71 61.4-22.53-1.81-43.59-6.31-63.71-13.62zM320 352c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 27.78c-17.52-4.39-35.71-6.85-54.32-8.44 5.87-26.08 27.5-45.88 54.32-49.28v57.72zm0-236.11c-30.89-3.91-54.86-29.7-55.81-61.55 19.54 2.17 38.09 6.23 55.81 12.66v48.89z"},child:[]}]})(s)}function Ks(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(s)}function io(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(s)}function ot(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(s)}function oo(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 192V77.25c0-8.49-3.37-16.62-9.37-22.63L393.37 9.37c-6-6-14.14-9.37-22.63-9.37H96C78.33 0 64 14.33 64 32v160c-35.35 0-64 28.65-64 64v112c0 8.84 7.16 16 16 16h48v96c0 17.67 14.33 32 32 32h320c17.67 0 32-14.33 32-32v-96h48c8.84 0 16-7.16 16-16V256c0-35.35-28.65-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.84 7.16 16 16 16h48v96zm48 72c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"},child:[]}]})(s)}function Ys(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"},child:[]}]})(s)}function Xn(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(s)}function lo(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(s)}function cr(s){return ce({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(s)}function ln(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"},child:[]}]})(s)}function co(s){return ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(s)}function uo(s){return ce({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(s)}function cn(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(s)}function ws(s){return ce({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h16c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"},child:[]}]})(s)}function ho(s){return ce({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z"},child:[]}]})(s)}function qs(s){return ce({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(s)}function Qn(s){return ce({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(s)}const Ds=({children:s,requiredRoles:t,fallbackPath:r="/login",showAccessDenied:a=!0})=>{const{canAccess:i,user:l}=Vn();return l?i(t)?s:(console.log("🔍 ProtectedRoute: Usuario no tiene permisos",{userRole:l.role,requiredRoles:t,canAccess:i(t)}),a?e.jsx(k,{minH:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bg:"gray.50",children:e.jsxs(u,{spacing:6,p:8,bg:"white",borderRadius:"lg",boxShadow:"lg",maxW:"md",w:"full",children:[e.jsx(k,{color:"red.500",fontSize:"4xl",children:e.jsx(lo,{})}),e.jsxs(u,{spacing:2,textAlign:"center",children:[e.jsx(n,{fontSize:"2xl",fontWeight:"bold",color:"gray.800",children:"Acceso Denegado"}),e.jsx(n,{color:"gray.600",children:"No tienes permisos para acceder a esta sección."}),e.jsxs(n,{fontSize:"sm",color:"gray.500",children:["Tu rol actual: ",e.jsx("strong",{children:l.role})]}),e.jsxs(n,{fontSize:"sm",color:"gray.500",children:["Roles requeridos: ",e.jsx("strong",{children:Array.isArray(t)?t.join(", "):t})]})]}),e.jsx(O,{leftIcon:e.jsx(Zi,{}),colorScheme:"blue",variant:"outline",onClick:()=>window.history.back(),children:"Volver"})]})}):e.jsx(ft,{to:"/dashboard",replace:!0})):(console.log("🔍 ProtectedRoute: No hay usuario autenticado, redirigiendo al login"),e.jsx(ft,{to:r,replace:!0}))};var Fe="-ms-",jt="-moz-",ze="-webkit-",Jn="comm",Gt="rule",Mr="decl",po="@import",Kn="@keyframes",xo="@layer",Zn=Math.abs,$r=String.fromCharCode,Pr=Object.assign;function go(s,t){return us(s,0)^45?(((t<<2^us(s,0))<<2^us(s,1))<<2^us(s,2))<<2^us(s,3):0}function ea(s){return s.trim()}function Ns(s,t){return(s=t.exec(s))?s[0]:s}function he(s,t,r){return s.replace(t,r)}function _t(s,t,r){return s.indexOf(t,r)}function us(s,t){return s.charCodeAt(t)|0}function lt(s,t,r){return s.slice(t,r)}function Is(s){return s.length}function sa(s){return s.length}function mt(s,t){return t.push(s),s}function mo(s,t){return s.map(t).join("")}function dn(s,t){return s.filter(function(r){return!Ns(r,t)})}var Yt=1,ct=1,ta=0,zs=0,es=0,xt="";function Xt(s,t,r,a,i,l,o,c){return{value:s,root:t,parent:r,type:a,props:i,children:l,line:Yt,column:ct,length:o,return:"",siblings:c}}function $s(s,t){return Pr(Xt("",null,null,"",null,null,0,s.siblings),s,{length:-s.length},t)}function rt(s){for(;s.root;)s=$s(s.root,{children:[s]});mt(s,s.siblings)}function fo(){return es}function jo(){return es=zs>0?us(xt,--zs):0,ct--,es===10&&(ct=1,Yt--),es}function Es(){return es=zs<ta?us(xt,zs++):0,ct++,es===10&&(ct=1,Yt++),es}function Xs(){return us(xt,zs)}function kt(){return zs}function Qt(s,t){return lt(xt,s,t)}function Ar(s){switch(s){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function bo(s){return Yt=ct=1,ta=Is(xt=s),zs=0,[]}function yo(s){return xt="",s}function dr(s){return ea(Qt(zs-1,Er(s===91?s+2:s===40?s+1:s)))}function vo(s){for(;(es=Xs())&&es<33;)Es();return Ar(s)>2||Ar(es)>3?"":" "}function So(s,t){for(;--t&&Es()&&!(es<48||es>102||es>57&&es<65||es>70&&es<97););return Qt(s,kt()+(t<6&&Xs()==32&&Es()==32))}function Er(s){for(;Es();)switch(es){case s:return zs;case 34:case 39:s!==34&&s!==39&&Er(es);break;case 40:s===41&&Er(s);break;case 92:Es();break}return zs}function Co(s,t){for(;Es()&&s+es!==57;)if(s+es===84&&Xs()===47)break;return"/*"+Qt(t,zs-1)+"*"+$r(s===47?s:Es())}function wo(s){for(;!Ar(Xs());)Es();return Qt(s,zs)}function zo(s){return yo(Nt("",null,null,null,[""],s=bo(s),0,[0],s))}function Nt(s,t,r,a,i,l,o,c,d){for(var f=0,P=0,I=o,m=0,T=0,C=0,D=1,_=1,y=1,z=0,E="",N=i,$=l,R=a,p=E;_;)switch(C=z,z=Es()){case 40:if(C!=108&&us(p,I-1)==58){_t(p+=he(dr(z),"&","&\f"),"&\f",Zn(f?c[f-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:p+=dr(z);break;case 9:case 10:case 13:case 32:p+=vo(C);break;case 92:p+=So(kt()-1,7);continue;case 47:switch(Xs()){case 42:case 47:mt(Po(Co(Es(),kt()),t,r,d),d);break;default:p+="/"}break;case 123*D:c[f++]=Is(p)*y;case 125*D:case 59:case 0:switch(z){case 0:case 125:_=0;case 59+P:y==-1&&(p=he(p,/\f/g,"")),T>0&&Is(p)-I&&mt(T>32?hn(p+";",a,r,I-1,d):hn(he(p," ","")+";",a,r,I-2,d),d);break;case 59:p+=";";default:if(mt(R=un(p,t,r,f,P,i,c,E,N=[],$=[],I,l),l),z===123)if(P===0)Nt(p,t,R,R,N,l,I,c,$);else switch(m===99&&us(p,3)===110?100:m){case 100:case 108:case 109:case 115:Nt(s,R,R,a&&mt(un(s,R,R,0,0,i,c,E,i,N=[],I,$),$),i,$,I,c,a?N:$);break;default:Nt(p,R,R,R,[""],$,0,c,$)}}f=P=T=0,D=y=1,E=p="",I=o;break;case 58:I=1+Is(p),T=C;default:if(D<1){if(z==123)--D;else if(z==125&&D++==0&&jo()==125)continue}switch(p+=$r(z),z*D){case 38:y=P>0?1:(p+="\f",-1);break;case 44:c[f++]=(Is(p)-1)*y,y=1;break;case 64:Xs()===45&&(p+=dr(Es())),m=Xs(),P=I=Is(E=p+=wo(kt())),z++;break;case 45:C===45&&Is(p)==2&&(D=0)}}return l}function un(s,t,r,a,i,l,o,c,d,f,P,I){for(var m=i-1,T=i===0?l:[""],C=sa(T),D=0,_=0,y=0;D<a;++D)for(var z=0,E=lt(s,m+1,m=Zn(_=o[D])),N=s;z<C;++z)(N=ea(_>0?T[z]+" "+E:he(E,/&\f/g,T[z])))&&(d[y++]=N);return Xt(s,t,r,i===0?Gt:c,d,f,P,I)}function Po(s,t,r,a){return Xt(s,t,r,Jn,$r(fo()),lt(s,2,-2),0,a)}function hn(s,t,r,a,i){return Xt(s,t,r,Mr,lt(s,0,a),lt(s,a+1,-1),a,i)}function ra(s,t,r){switch(go(s,t)){case 5103:return ze+"print-"+s+s;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ze+s+s;case 4789:return jt+s+s;case 5349:case 4246:case 4810:case 6968:case 2756:return ze+s+jt+s+Fe+s+s;case 5936:switch(us(s,t+11)){case 114:return ze+s+Fe+he(s,/[svh]\w+-[tblr]{2}/,"tb")+s;case 108:return ze+s+Fe+he(s,/[svh]\w+-[tblr]{2}/,"tb-rl")+s;case 45:return ze+s+Fe+he(s,/[svh]\w+-[tblr]{2}/,"lr")+s}case 6828:case 4268:case 2903:return ze+s+Fe+s+s;case 6165:return ze+s+Fe+"flex-"+s+s;case 5187:return ze+s+he(s,/(\w+).+(:[^]+)/,ze+"box-$1$2"+Fe+"flex-$1$2")+s;case 5443:return ze+s+Fe+"flex-item-"+he(s,/flex-|-self/g,"")+(Ns(s,/flex-|baseline/)?"":Fe+"grid-row-"+he(s,/flex-|-self/g,""))+s;case 4675:return ze+s+Fe+"flex-line-pack"+he(s,/align-content|flex-|-self/g,"")+s;case 5548:return ze+s+Fe+he(s,"shrink","negative")+s;case 5292:return ze+s+Fe+he(s,"basis","preferred-size")+s;case 6060:return ze+"box-"+he(s,"-grow","")+ze+s+Fe+he(s,"grow","positive")+s;case 4554:return ze+he(s,/([^-])(transform)/g,"$1"+ze+"$2")+s;case 6187:return he(he(he(s,/(zoom-|grab)/,ze+"$1"),/(image-set)/,ze+"$1"),s,"")+s;case 5495:case 3959:return he(s,/(image-set\([^]*)/,ze+"$1$`$1");case 4968:return he(he(s,/(.+:)(flex-)?(.*)/,ze+"box-pack:$3"+Fe+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ze+s+s;case 4200:if(!Ns(s,/flex-|baseline/))return Fe+"grid-column-align"+lt(s,t)+s;break;case 2592:case 3360:return Fe+he(s,"template-","")+s;case 4384:case 3616:return r&&r.some(function(a,i){return t=i,Ns(a.props,/grid-\w+-end/)})?~_t(s+(r=r[t].value),"span",0)?s:Fe+he(s,"-start","")+s+Fe+"grid-row-span:"+(~_t(r,"span",0)?Ns(r,/\d+/):+Ns(r,/\d+/)-+Ns(s,/\d+/))+";":Fe+he(s,"-start","")+s;case 4896:case 4128:return r&&r.some(function(a){return Ns(a.props,/grid-\w+-start/)})?s:Fe+he(he(s,"-end","-span"),"span ","")+s;case 4095:case 3583:case 4068:case 2532:return he(s,/(.+)-inline(.+)/,ze+"$1$2")+s;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Is(s)-1-t>6)switch(us(s,t+1)){case 109:if(us(s,t+4)!==45)break;case 102:return he(s,/(.+:)(.+)-([^]+)/,"$1"+ze+"$2-$3$1"+jt+(us(s,t+3)==108?"$3":"$2-$3"))+s;case 115:return~_t(s,"stretch",0)?ra(he(s,"stretch","fill-available"),t,r)+s:s}break;case 5152:case 5920:return he(s,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(a,i,l,o,c,d,f){return Fe+i+":"+l+f+(o?Fe+i+"-span:"+(c?d:+d-+l)+f:"")+s});case 4949:if(us(s,t+6)===121)return he(s,":",":"+ze)+s;break;case 6444:switch(us(s,us(s,14)===45?18:11)){case 120:return he(s,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+ze+(us(s,14)===45?"inline-":"")+"box$3$1"+ze+"$2$3$1"+Fe+"$2box$3")+s;case 100:return he(s,":",":"+Fe)+s}break;case 5719:case 2647:case 2135:case 3927:case 2391:return he(s,"scroll-","scroll-snap-")+s}return s}function Mt(s,t){for(var r="",a=0;a<s.length;a++)r+=t(s[a],a,s,t)||"";return r}function Ao(s,t,r,a){switch(s.type){case xo:if(s.children.length)break;case po:case Mr:return s.return=s.return||s.value;case Jn:return"";case Kn:return s.return=s.value+"{"+Mt(s.children,a)+"}";case Gt:if(!Is(s.value=s.props.join(",")))return""}return Is(r=Mt(s.children,a))?s.return=s.value+"{"+r+"}":""}function Eo(s){var t=sa(s);return function(r,a,i,l){for(var o="",c=0;c<t;c++)o+=s[c](r,a,i,l)||"";return o}}function To(s){return function(t){t.root||(t=t.return)&&s(t)}}function Do(s,t,r,a){if(s.length>-1&&!s.return)switch(s.type){case Mr:s.return=ra(s.value,s.length,r);return;case Kn:return Mt([$s(s,{value:he(s.value,"@","@"+ze)})],a);case Gt:if(s.length)return mo(r=s.props,function(i){switch(Ns(i,a=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":rt($s(s,{props:[he(i,/:(read-\w+)/,":"+jt+"$1")]})),rt($s(s,{props:[i]})),Pr(s,{props:dn(r,a)});break;case"::placeholder":rt($s(s,{props:[he(i,/:(plac\w+)/,":"+ze+"input-$1")]})),rt($s(s,{props:[he(i,/:(plac\w+)/,":"+jt+"$1")]})),rt($s(s,{props:[he(i,/:(plac\w+)/,Fe+"input-$1")]})),rt($s(s,{props:[i]})),Pr(s,{props:dn(r,a)});break}return""})}}var Io={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},bs={},dt=typeof process<"u"&&bs!==void 0&&(bs.REACT_APP_SC_ATTR||bs.SC_ATTR)||"data-styled",na="active",aa="data-styled-version",Jt="6.1.19",Br=`/*!sc*/
`,$t=typeof window<"u"&&typeof document<"u",_o=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&bs!==void 0&&bs.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&bs.REACT_APP_SC_DISABLE_SPEEDY!==""?bs.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&bs.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&bs!==void 0&&bs.SC_DISABLE_SPEEDY!==void 0&&bs.SC_DISABLE_SPEEDY!==""&&bs.SC_DISABLE_SPEEDY!=="false"&&bs.SC_DISABLE_SPEEDY),Kt=Object.freeze([]),ut=Object.freeze({});function ko(s,t,r){return r===void 0&&(r=ut),s.theme!==r.theme&&s.theme||t||r.theme}var ia=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),No=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ro=/(^-|-$)/g;function pn(s){return s.replace(No,"-").replace(Ro,"")}var Oo=/(a)(d)/gi,Tt=52,xn=function(s){return String.fromCharCode(s+(s>25?39:97))};function Tr(s){var t,r="";for(t=Math.abs(s);t>Tt;t=t/Tt|0)r=xn(t%Tt)+r;return(xn(t%Tt)+r).replace(Oo,"$1-$2")}var ur,oa=5381,nt=function(s,t){for(var r=t.length;r;)s=33*s^t.charCodeAt(--r);return s},la=function(s){return nt(oa,s)};function Fo(s){return Tr(la(s)>>>0)}function Lo(s){return s.displayName||s.name||"Component"}function hr(s){return typeof s=="string"&&!0}var ca=typeof Symbol=="function"&&Symbol.for,da=ca?Symbol.for("react.memo"):60115,Wo=ca?Symbol.for("react.forward_ref"):60112,Mo={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},$o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},ua={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Bo=((ur={})[Wo]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ur[da]=ua,ur);function gn(s){return("type"in(t=s)&&t.type.$$typeof)===da?ua:"$$typeof"in s?Bo[s.$$typeof]:Mo;var t}var Vo=Object.defineProperty,qo=Object.getOwnPropertyNames,mn=Object.getOwnPropertySymbols,Ho=Object.getOwnPropertyDescriptor,Uo=Object.getPrototypeOf,fn=Object.prototype;function ha(s,t,r){if(typeof t!="string"){if(fn){var a=Uo(t);a&&a!==fn&&ha(s,a,r)}var i=qo(t);mn&&(i=i.concat(mn(t)));for(var l=gn(s),o=gn(t),c=0;c<i.length;++c){var d=i[c];if(!(d in $o||r&&r[d]||o&&d in o||l&&d in l)){var f=Ho(t,d);try{Vo(s,d,f)}catch{}}}}return s}function ht(s){return typeof s=="function"}function Vr(s){return typeof s=="object"&&"styledComponentId"in s}function Us(s,t){return s&&t?"".concat(s," ").concat(t):s||t||""}function jn(s,t){if(s.length===0)return"";for(var r=s[0],a=1;a<s.length;a++)r+=s[a];return r}function St(s){return s!==null&&typeof s=="object"&&s.constructor.name===Object.name&&!("props"in s&&s.$$typeof)}function Dr(s,t,r){if(r===void 0&&(r=!1),!r&&!St(s)&&!Array.isArray(s))return t;if(Array.isArray(t))for(var a=0;a<t.length;a++)s[a]=Dr(s[a],t[a]);else if(St(t))for(var a in t)s[a]=Dr(s[a],t[a]);return s}function qr(s,t){Object.defineProperty(s,"toString",{value:t})}function Pt(s){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(s," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Go=function(){function s(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return s.prototype.indexOfGroup=function(t){for(var r=0,a=0;a<t;a++)r+=this.groupSizes[a];return r},s.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var a=this.groupSizes,i=a.length,l=i;t>=l;)if((l<<=1)<0)throw Pt(16,"".concat(t));this.groupSizes=new Uint32Array(l),this.groupSizes.set(a),this.length=l;for(var o=i;o<l;o++)this.groupSizes[o]=0}for(var c=this.indexOfGroup(t+1),d=(o=0,r.length);o<d;o++)this.tag.insertRule(c,r[o])&&(this.groupSizes[t]++,c++)},s.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],a=this.indexOfGroup(t),i=a+r;this.groupSizes[t]=0;for(var l=a;l<i;l++)this.tag.deleteRule(a)}},s.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var a=this.groupSizes[t],i=this.indexOfGroup(t),l=i+a,o=i;o<l;o++)r+="".concat(this.tag.getRule(o)).concat(Br);return r},s}(),Rt=new Map,Bt=new Map,Ot=1,Dt=function(s){if(Rt.has(s))return Rt.get(s);for(;Bt.has(Ot);)Ot++;var t=Ot++;return Rt.set(s,t),Bt.set(t,s),t},Yo=function(s,t){Ot=t+1,Rt.set(s,t),Bt.set(t,s)},Xo="style[".concat(dt,"][").concat(aa,'="').concat(Jt,'"]'),Qo=new RegExp("^".concat(dt,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Jo=function(s,t,r){for(var a,i=r.split(","),l=0,o=i.length;l<o;l++)(a=i[l])&&s.registerName(t,a)},Ko=function(s,t){for(var r,a=((r=t.textContent)!==null&&r!==void 0?r:"").split(Br),i=[],l=0,o=a.length;l<o;l++){var c=a[l].trim();if(c){var d=c.match(Qo);if(d){var f=0|parseInt(d[1],10),P=d[2];f!==0&&(Yo(P,f),Jo(s,P,d[3]),s.getTag().insertRules(f,i)),i.length=0}else i.push(c)}}},bn=function(s){for(var t=document.querySelectorAll(Xo),r=0,a=t.length;r<a;r++){var i=t[r];i&&i.getAttribute(dt)!==na&&(Ko(s,i),i.parentNode&&i.parentNode.removeChild(i))}};function Zo(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var pa=function(s){var t=document.head,r=s||t,a=document.createElement("style"),i=function(c){var d=Array.from(c.querySelectorAll("style[".concat(dt,"]")));return d[d.length-1]}(r),l=i!==void 0?i.nextSibling:null;a.setAttribute(dt,na),a.setAttribute(aa,Jt);var o=Zo();return o&&a.setAttribute("nonce",o),r.insertBefore(a,l),a},el=function(){function s(t){this.element=pa(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var a=document.styleSheets,i=0,l=a.length;i<l;i++){var o=a[i];if(o.ownerNode===r)return o}throw Pt(17)}(this.element),this.length=0}return s.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},s.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},s.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},s}(),sl=function(){function s(t){this.element=pa(t),this.nodes=this.element.childNodes,this.length=0}return s.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var a=document.createTextNode(r);return this.element.insertBefore(a,this.nodes[t]||null),this.length++,!0}return!1},s.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},s.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},s}(),tl=function(){function s(t){this.rules=[],this.length=0}return s.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},s.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},s.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},s}(),yn=$t,rl={isServer:!$t,useCSSOMInjection:!_o},xa=function(){function s(t,r,a){t===void 0&&(t=ut),r===void 0&&(r={});var i=this;this.options=Cs(Cs({},rl),t),this.gs=r,this.names=new Map(a),this.server=!!t.isServer,!this.server&&$t&&yn&&(yn=!1,bn(this)),qr(this,function(){return function(l){for(var o=l.getTag(),c=o.length,d="",f=function(I){var m=function(y){return Bt.get(y)}(I);if(m===void 0)return"continue";var T=l.names.get(m),C=o.getGroup(I);if(T===void 0||!T.size||C.length===0)return"continue";var D="".concat(dt,".g").concat(I,'[id="').concat(m,'"]'),_="";T!==void 0&&T.forEach(function(y){y.length>0&&(_+="".concat(y,","))}),d+="".concat(C).concat(D,'{content:"').concat(_,'"}').concat(Br)},P=0;P<c;P++)f(P);return d}(i)})}return s.registerId=function(t){return Dt(t)},s.prototype.rehydrate=function(){!this.server&&$t&&bn(this)},s.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new s(Cs(Cs({},this.options),t),this.gs,r&&this.names||void 0)},s.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},s.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var a=r.useCSSOMInjection,i=r.target;return r.isServer?new tl(i):a?new el(i):new sl(i)}(this.options),new Go(t)));var t},s.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},s.prototype.registerName=function(t,r){if(Dt(t),this.names.has(t))this.names.get(t).add(r);else{var a=new Set;a.add(r),this.names.set(t,a)}},s.prototype.insertRules=function(t,r,a){this.registerName(t,r),this.getTag().insertRules(Dt(t),a)},s.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},s.prototype.clearRules=function(t){this.getTag().clearGroup(Dt(t)),this.clearNames(t)},s.prototype.clearTag=function(){this.tag=void 0},s}(),nl=/&/g,al=/^\s*\/\/.*$/gm;function ga(s,t){return s.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(a){return"".concat(t," ").concat(a)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=ga(r.children,t)),r})}function il(s){var t,r,a,i=ut,l=i.options,o=l===void 0?ut:l,c=i.plugins,d=c===void 0?Kt:c,f=function(m,T,C){return C.startsWith(r)&&C.endsWith(r)&&C.replaceAll(r,"").length>0?".".concat(t):m},P=d.slice();P.push(function(m){m.type===Gt&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(nl,r).replace(a,f))}),o.prefix&&P.push(Do),P.push(Ao);var I=function(m,T,C,D){T===void 0&&(T=""),C===void 0&&(C=""),D===void 0&&(D="&"),t=D,r=T,a=new RegExp("\\".concat(r,"\\b"),"g");var _=m.replace(al,""),y=zo(C||T?"".concat(C," ").concat(T," { ").concat(_," }"):_);o.namespace&&(y=ga(y,o.namespace));var z=[];return Mt(y,Eo(P.concat(To(function(E){return z.push(E)})))),z};return I.hash=d.length?d.reduce(function(m,T){return T.name||Pt(15),nt(m,T.name)},oa).toString():"",I}var ol=new xa,Ir=il(),ma=pe.createContext({shouldForwardProp:void 0,styleSheet:ol,stylis:Ir});ma.Consumer;pe.createContext(void 0);function vn(){return S.useContext(ma)}var ll=function(){function s(t,r){var a=this;this.inject=function(i,l){l===void 0&&(l=Ir);var o=a.name+l.hash;i.hasNameForId(a.id,o)||i.insertRules(a.id,o,l(a.rules,o,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,qr(this,function(){throw Pt(12,String(a.name))})}return s.prototype.getName=function(t){return t===void 0&&(t=Ir),this.name+t.hash},s}(),cl=function(s){return s>="A"&&s<="Z"};function Sn(s){for(var t="",r=0;r<s.length;r++){var a=s[r];if(r===1&&a==="-"&&s[0]==="-")return s;cl(a)?t+="-"+a.toLowerCase():t+=a}return t.startsWith("ms-")?"-"+t:t}var fa=function(s){return s==null||s===!1||s===""},ja=function(s){var t,r,a=[];for(var i in s){var l=s[i];s.hasOwnProperty(i)&&!fa(l)&&(Array.isArray(l)&&l.isCss||ht(l)?a.push("".concat(Sn(i),":"),l,";"):St(l)?a.push.apply(a,Ft(Ft(["".concat(i," {")],ja(l),!1),["}"],!1)):a.push("".concat(Sn(i),": ").concat((t=i,(r=l)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in Io||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return a};function Qs(s,t,r,a){if(fa(s))return[];if(Vr(s))return[".".concat(s.styledComponentId)];if(ht(s)){if(!ht(l=s)||l.prototype&&l.prototype.isReactComponent||!t)return[s];var i=s(t);return Qs(i,t,r,a)}var l;return s instanceof ll?r?(s.inject(r,a),[s.getName(a)]):[s]:St(s)?ja(s):Array.isArray(s)?Array.prototype.concat.apply(Kt,s.map(function(o){return Qs(o,t,r,a)})):[s.toString()]}function dl(s){for(var t=0;t<s.length;t+=1){var r=s[t];if(ht(r)&&!Vr(r))return!1}return!0}var ul=la(Jt),hl=function(){function s(t,r,a){this.rules=t,this.staticRulesId="",this.isStatic=(a===void 0||a.isStatic)&&dl(t),this.componentId=r,this.baseHash=nt(ul,r),this.baseStyle=a,xa.registerId(r)}return s.prototype.generateAndInjectStyles=function(t,r,a){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,a):"";if(this.isStatic&&!a.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))i=Us(i,this.staticRulesId);else{var l=jn(Qs(this.rules,t,r,a)),o=Tr(nt(this.baseHash,l)>>>0);if(!r.hasNameForId(this.componentId,o)){var c=a(l,".".concat(o),void 0,this.componentId);r.insertRules(this.componentId,o,c)}i=Us(i,o),this.staticRulesId=o}else{for(var d=nt(this.baseHash,a.hash),f="",P=0;P<this.rules.length;P++){var I=this.rules[P];if(typeof I=="string")f+=I;else if(I){var m=jn(Qs(I,t,r,a));d=nt(d,m+P),f+=m}}if(f){var T=Tr(d>>>0);r.hasNameForId(this.componentId,T)||r.insertRules(this.componentId,T,a(f,".".concat(T),void 0,this.componentId)),i=Us(i,T)}}return i},s}(),ba=pe.createContext(void 0);ba.Consumer;var pr={};function pl(s,t,r){var a=Vr(s),i=s,l=!hr(s),o=t.attrs,c=o===void 0?Kt:o,d=t.componentId,f=d===void 0?function(N,$){var R=typeof N!="string"?"sc":pn(N);pr[R]=(pr[R]||0)+1;var p="".concat(R,"-").concat(Fo(Jt+R+pr[R]));return $?"".concat($,"-").concat(p):p}(t.displayName,t.parentComponentId):d,P=t.displayName,I=P===void 0?function(N){return hr(N)?"styled.".concat(N):"Styled(".concat(Lo(N),")")}(s):P,m=t.displayName&&t.componentId?"".concat(pn(t.displayName),"-").concat(t.componentId):t.componentId||f,T=a&&i.attrs?i.attrs.concat(c).filter(Boolean):c,C=t.shouldForwardProp;if(a&&i.shouldForwardProp){var D=i.shouldForwardProp;if(t.shouldForwardProp){var _=t.shouldForwardProp;C=function(N,$){return D(N,$)&&_(N,$)}}else C=D}var y=new hl(r,m,a?i.componentStyle:void 0);function z(N,$){return function(R,p,H){var b=R.attrs,ae=R.componentStyle,g=R.defaultProps,B=R.foldedComponentIds,V=R.styledComponentId,te=R.target,Ce=pe.useContext(ba),xe=vn(),Ae=R.shouldForwardProp||xe.shouldForwardProp,Ne=ko(p,Ce,g)||ut,w=function(M,Y,se){for(var fe,W=Cs(Cs({},Y),{className:void 0,theme:se}),Re=0;Re<M.length;Re+=1){var K=ht(fe=M[Re])?fe(W):fe;for(var Ee in K)W[Ee]=Ee==="className"?Us(W[Ee],K[Ee]):Ee==="style"?Cs(Cs({},W[Ee]),K[Ee]):K[Ee]}return Y.className&&(W.className=Us(W.className,Y.className)),W}(b,p,Ne),Q=w.as||te,ne={};for(var de in w)w[de]===void 0||de[0]==="$"||de==="as"||de==="theme"&&w.theme===Ne||(de==="forwardedAs"?ne.as=w.forwardedAs:Ae&&!Ae(de,Q)||(ne[de]=w[de]));var A=function(M,Y){var se=vn(),fe=M.generateAndInjectStyles(Y,se.styleSheet,se.stylis);return fe}(ae,w),me=Us(B,V);return A&&(me+=" "+A),w.className&&(me+=" "+w.className),ne[hr(Q)&&!ia.has(Q)?"class":"className"]=me,H&&(ne.ref=H),S.createElement(Q,ne)}(E,N,$)}z.displayName=I;var E=pe.forwardRef(z);return E.attrs=T,E.componentStyle=y,E.displayName=I,E.shouldForwardProp=C,E.foldedComponentIds=a?Us(i.foldedComponentIds,i.styledComponentId):"",E.styledComponentId=m,E.target=a?i.target:s,Object.defineProperty(E,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(N){this._foldedDefaultProps=a?function($){for(var R=[],p=1;p<arguments.length;p++)R[p-1]=arguments[p];for(var H=0,b=R;H<b.length;H++)Dr($,b[H],!0);return $}({},i.defaultProps,N):N}}),qr(E,function(){return".".concat(E.styledComponentId)}),l&&ha(E,s,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),E}function Cn(s,t){for(var r=[s[0]],a=0,i=t.length;a<i;a+=1)r.push(t[a],s[a+1]);return r}var wn=function(s){return Object.assign(s,{isCss:!0})};function xl(s){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(ht(s)||St(s))return wn(Qs(Cn(Kt,Ft([s],t,!0))));var a=s;return t.length===0&&a.length===1&&typeof a[0]=="string"?Qs(a):wn(Qs(Cn(a,t)))}function _r(s,t,r){if(r===void 0&&(r=ut),!t)throw Pt(1,t);var a=function(i){for(var l=[],o=1;o<arguments.length;o++)l[o-1]=arguments[o];return s(t,r,xl.apply(void 0,Ft([i],l,!1)))};return a.attrs=function(i){return _r(s,t,Cs(Cs({},r),{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},a.withConfig=function(i){return _r(s,t,Cs(Cs({},r),i))},a}var ya=function(s){return _r(pl,s)},Zt=ya;ia.forEach(function(s){Zt[s]=ya(s)});const gl=Zt.div`
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background-color: var(--background-color);
`,ml=Zt.div`
  width: 100%;
  max-width: 450px;
  padding: 2rem;
  background-color: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
`,fl=Zt.div`
  text-align: center;
  margin-bottom: 2rem;
  
  h1 {
    color: var(--primary-color);
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
  }
  
  p {
    color: var(--dark-gray);
    font-size: 1rem;
  }
`,jl=()=>e.jsx(gl,{children:e.jsxs(ml,{children:[e.jsxs(fl,{children:[e.jsx("h1",{children:"Sistema de Gestión"}),e.jsx("p",{children:"Planta de Agua"})]}),e.jsx(Nn,{})]})}),bl=()=>{const s=S.useRef(null),t=S.useRef(Date.now());S.useRef(null);const r=async()=>{try{const l=localStorage.getItem("token");if(!l)return;const o=JSON.parse(atob(l.split(".")[1])),c=Math.floor(Date.now()/1e3);if(o.exp-c<7200){console.log("🔄 Renovando token JWT...");const f=await X.post("/api/auth/refresh");f.data.token&&(localStorage.setItem("token",f.data.token),console.log("✅ Token renovado exitosamente"))}}catch(l){console.error("❌ Error al renovar token:",l),l.response&&l.response.status===401&&(localStorage.removeItem("token"),window.location.href="/")}},a=()=>{t.current=Date.now()},i=()=>{const o=Date.now()-t.current,c=60*60*1e3;o>c&&(console.log("⏰ Sesión inactiva por más de 1 hora, cerrando sesión..."),localStorage.removeItem("token"),window.location.href="/")};return S.useEffect(()=>{s.current=setInterval(r,30*60*1e3);const l=setInterval(i,10*60*1e3),o=["mousedown","mousemove","keypress","scroll","touchstart","click"];return o.forEach(c=>{document.addEventListener(c,a,!0)}),()=>{s.current&&clearInterval(s.current),clearInterval(l),o.forEach(c=>{document.removeEventListener(c,a,!0)})}},[]),{refreshToken:r}},yl="/assets/logo_aquayara2-iFhxOv8G.jpeg",bt=({size:s="md",showText:t=!0,variant:r="horizontal",color:a="blue.500",textColor:i="blue.500",taglineColor:l="teal.400"})=>{const o={xs:{logo:"20px",text:"xs",tagline:"xs"},sm:{logo:"30px",text:"sm",tagline:"xs"},md:{logo:"40px",text:"md",tagline:"sm"},lg:{logo:"60px",text:"lg",tagline:"md"},xl:{logo:"80px",text:"xl",tagline:"lg"}},c=o[s]||o.md,d=()=>e.jsx(It,{src:yl,alt:"AquaYara Logo",w:c.logo,h:c.logo,objectFit:"contain",borderRadius:"md",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"});return t?r==="vertical"?e.jsxs(u,{spacing:2,align:"center",children:[e.jsx(d,{}),e.jsxs(u,{spacing:0,align:"center",children:[e.jsxs(n,{fontSize:c.text,fontWeight:"bold",color:i,lineHeight:"1",children:["Aqua",e.jsx("span",{style:{color:"#38B2AC"},children:"Yara"})]}),e.jsx(n,{fontSize:c.tagline,color:l,fontStyle:"italic",lineHeight:"1",children:"Agua que encanta"})]})]}):e.jsxs(h,{spacing:3,align:"center",children:[e.jsx(d,{}),e.jsxs(u,{spacing:0,align:"start",children:[e.jsxs(n,{fontSize:c.text,fontWeight:"bold",color:i,lineHeight:"1",children:["Aqua",e.jsx("span",{style:{color:"#38B2AC"},children:"Yara"})]}),e.jsx(n,{fontSize:c.tagline,color:l,fontStyle:"italic",lineHeight:"1",children:"Agua que encanta"})]})]}):e.jsx(d,{})},va=({variant:s="button",size:t="sm"})=>{const r=ps(),a="+51 961 606 183",i="aguademesaaquayara@gmail.com",l=()=>{const f=`https://wa.me/51961606183?text=${encodeURIComponent("Hola, necesito ayuda con el sistema de AquaYara")}`;window.open(f,"_blank")},o=()=>{window.open(`tel:${a}`,"_self")},c=(d,f)=>{navigator.clipboard.writeText(d).then(()=>{r({title:"Copiado",description:`${f} copiado al portapapeles`,status:"success",duration:2e3,isClosable:!0})})};return s==="badge"?e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Contactar por WhatsApp",hasArrow:!0,children:e.jsx(O,{size:"xs",colorScheme:"green",leftIcon:e.jsx(ge,{as:it}),onClick:l,children:"WhatsApp"})}),e.jsx(Oe,{label:"Llamar",hasArrow:!0,children:e.jsx(O,{size:"xs",variant:"outline",leftIcon:e.jsx(ge,{as:Ks}),onClick:o,children:a})})]}):s==="info"?e.jsxs(k,{p:3,bg:"blue.50",borderRadius:"md",border:"1px solid",borderColor:"blue.200",children:[e.jsx(n,{fontSize:"sm",fontWeight:"bold",color:"blue.700",mb:2,children:"📞 Soporte Técnico"}),e.jsxs(u,{spacing:2,align:"start",children:[e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:it,color:"green.500"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["WhatsApp: ",a]}),e.jsx(O,{size:"xs",variant:"ghost",onClick:()=>c(a,"Teléfono"),children:"Copiar"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:Lr,color:"blue.500"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["Email: ",i]}),e.jsx(O,{size:"xs",variant:"ghost",onClick:()=>c(i,"Email"),children:"Copiar"})]})]})]}):e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Contactar por WhatsApp",hasArrow:!0,children:e.jsx(O,{size:t,colorScheme:"green",leftIcon:e.jsx(ge,{as:it}),onClick:l,children:"WhatsApp"})}),e.jsx(Oe,{label:"Llamar",hasArrow:!0,children:e.jsx(O,{size:t,variant:"outline",leftIcon:e.jsx(ge,{as:Ks}),onClick:o,children:a})})]})},vl=({isOpen:s,onClose:t,showAcceptButton:r=!1,onAccept:a})=>{const[i,l]=S.useState(!1),o=()=>{l(!0),a&&a(),t()};return e.jsxs(Ve,{isOpen:s,onClose:t,size:"xl",scrollBehavior:"inside",children:[e.jsx(We,{}),e.jsxs(qe,{maxH:"90vh",children:[e.jsx(Me,{children:e.jsx(Z,{size:"md",children:"Términos y Condiciones - AquaYara"})}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:[e.jsx("strong",{children:"Fecha de última actualización:"})," 10 de enero de 2025"]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"1. Información General"}),e.jsxs(n,{fontSize:"sm",mb:2,children:[e.jsx("strong",{children:"AquaYara"})," es una empresa dedicada a la purificación y distribución de agua, con domicilio legal en Pucallpa, Perú."]}),e.jsx(n,{fontSize:"sm",children:"Proporcionamos servicios de purificación de agua, distribución, sistema de suscripciones, servicio de delivery y gestión de clientes frecuentes."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"2. Aceptación de Términos"}),e.jsx(n,{fontSize:"sm",mb:2,children:"Al utilizar nuestros servicios, usted acepta estos términos y condiciones en su totalidad. Si no está de acuerdo con alguna parte de estos términos, no debe utilizar nuestros servicios."}),e.jsx(n,{fontSize:"sm",children:"Nos reservamos el derecho de modificar estos términos en cualquier momento. Las modificaciones entrarán en vigor inmediatamente después de su publicación."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"3. Servicios Ofrecidos"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsx(Te,{children:"Bidón de Agua 20L y Paquete de Botellas"}),e.jsx(Te,{children:"Servicio de entrega a domicilio con tarifas según distrito"}),e.jsx(Te,{children:"Horarios de entrega: Lunes a Sábado de 8:00 AM a 6:00 PM"}),e.jsx(Te,{children:"Sistema de suscripciones con bonificaciones"}),e.jsx(Te,{children:"Control de botellas restantes y pagos mensuales automáticos"})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"4. Precios y Pagos"}),e.jsx(n,{fontSize:"sm",mb:2,children:"Los precios están sujetos a cambios sin previo aviso. Aceptamos efectivo, tarjeta de crédito/débito, Yape y Plin."}),e.jsx(n,{fontSize:"sm",children:"Los pagos deben realizarse al momento de la entrega. Los pagos mensuales de suscripciones se procesan automáticamente."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"5. Entregas y Devoluciones"}),e.jsx(n,{fontSize:"sm",mb:2,children:"Las entregas se realizan en el horario acordado. El cliente debe estar presente para recibir el pedido. En caso de ausencia, se reprogramará la entrega."}),e.jsx(n,{fontSize:"sm",children:"No se aceptan devoluciones de productos abiertos. Las devoluciones deben solicitarse dentro de las 24 horas posteriores a la entrega."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"6. Responsabilidades del Cliente"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsx(Te,{children:"Proporcionar información veraz y actualizada"}),e.jsx(Te,{children:"No utilizar el sistema para fines ilegales"}),e.jsx(Te,{children:"No compartir credenciales de acceso"}),e.jsx(Te,{children:"Notificar cualquier uso no autorizado de su cuenta"})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"7. Privacidad y Protección de Datos"}),e.jsx(n,{fontSize:"sm",mb:2,children:"Recopilamos datos personales, de uso y técnicos para procesar pedidos, comunicarnos con usted y mejorar nuestros servicios."}),e.jsx(n,{fontSize:"sm",children:"Implementamos medidas de seguridad como encriptación de datos sensibles, acceso restringido y políticas de confidencialidad."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"8. Sus Derechos"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsx(Te,{children:"Derecho de acceso a sus datos"}),e.jsx(Te,{children:"Derecho de rectificación de información inexacta"}),e.jsx(Te,{children:"Derecho de eliminación de datos"}),e.jsx(Te,{children:"Derecho de portabilidad de datos"}),e.jsx(Te,{children:"Derecho de oposición al tratamiento"})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"9. Contacto"}),e.jsxs(n,{fontSize:"sm",mb:1,children:[e.jsx("strong",{children:"Teléfono:"})," +51 961 606 183"]}),e.jsxs(n,{fontSize:"sm",mb:1,children:[e.jsx("strong",{children:"Email:"})," aguademesaaquayara@gmail.com"]}),e.jsxs(n,{fontSize:"sm",mb:1,children:[e.jsx("strong",{children:"Dirección:"})," Pucallpa, Perú"]}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Horario:"})," Lunes a Sábado 8:00 AM - 6:00 PM"]})]}),e.jsx(hs,{}),e.jsx(n,{fontSize:"xs",color:"gray.500",textAlign:"center",children:"Al utilizar nuestros servicios, usted confirma que ha leído, entendido y aceptado estos términos y condiciones."}),r&&e.jsx(k,{textAlign:"center",pt:4,children:e.jsx(O,{colorScheme:"blue",onClick:o,isDisabled:i,size:"lg",width:"full",children:i?"Aceptado":"Acepto los Términos y Condiciones"})})]})})]})]})},Sl=({onAccept:s,showAcceptButton:t=!1})=>{const{isOpen:r,onOpen:a,onClose:i}=Le();return e.jsxs(e.Fragment,{children:[e.jsx(O,{variant:"link",size:"sm",color:"blue.500",onClick:a,leftIcon:e.jsx(La,{}),children:"Términos y Condiciones"}),e.jsx(vl,{isOpen:r,onClose:i,showAcceptButton:t,onAccept:s})]})},Cl=()=>{const{isOpen:s,onOpen:t,onClose:r}=Le();return e.jsxs(e.Fragment,{children:[e.jsx(O,{variant:"link",size:"sm",color:"blue.500",onClick:t,leftIcon:e.jsx(Wa,{}),children:"Política de Privacidad"}),e.jsxs(Ve,{isOpen:s,onClose:r,size:"xl",scrollBehavior:"inside",children:[e.jsx(We,{}),e.jsxs(qe,{maxH:"90vh",children:[e.jsx(Me,{children:e.jsx(Z,{size:"md",children:"Política de Privacidad - AquaYara"})}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:[e.jsx("strong",{children:"Fecha de última actualización:"})," 10 de enero de 2025"]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"1. Información General"}),e.jsxs(n,{fontSize:"sm",mb:2,children:[e.jsx("strong",{children:"AquaYara"})," es responsable del tratamiento de sus datos personales."]}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Contacto:"})," aguademesaaquayara@gmail.com | +51 961 606 183"]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"2. Datos que Recopilamos"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsxs(Te,{children:[e.jsx("strong",{children:"Datos Personales:"})," Nombre, DNI/RUC, email, teléfono, dirección"]}),e.jsxs(Te,{children:[e.jsx("strong",{children:"Datos de Uso:"})," Historial de pedidos, preferencias, patrones de compra"]}),e.jsxs(Te,{children:[e.jsx("strong",{children:"Datos Técnicos:"})," IP, dispositivo, navegador, fecha y hora"]})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"3. Finalidades del Tratamiento"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsx(Te,{children:"Procesar pedidos y gestionar entregas"}),e.jsx(Te,{children:"Comunicarnos con usted"}),e.jsx(Te,{children:"Procesar pagos y generar comprobantes"}),e.jsx(Te,{children:"Mejorar nuestros servicios"}),e.jsx(Te,{children:"Prevenir fraudes y proteger el sistema"})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"4. Sus Derechos"}),e.jsxs(at,{fontSize:"sm",spacing:1,children:[e.jsx(Te,{children:"Derecho de acceso a sus datos"}),e.jsx(Te,{children:"Derecho de rectificación"}),e.jsx(Te,{children:"Derecho de eliminación"}),e.jsx(Te,{children:"Derecho de portabilidad"}),e.jsx(Te,{children:"Derecho de oposición"})]})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"5. Seguridad"}),e.jsx(n,{fontSize:"sm",children:"Implementamos medidas de seguridad como encriptación de datos sensibles, acceso restringido, monitoreo continuo y políticas de confidencialidad."})]}),e.jsxs(k,{children:[e.jsx(Z,{size:"sm",mb:2,children:"6. Contacto"}),e.jsxs(n,{fontSize:"sm",mb:1,children:[e.jsx("strong",{children:"Email:"})," aguademesaaquayara@gmail.com"]}),e.jsxs(n,{fontSize:"sm",mb:1,children:[e.jsx("strong",{children:"Teléfono:"})," +51 961 606 183"]}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Autoridad de Control:"})," proteccion.datos@minjus.gob.pe"]})]}),e.jsx(hs,{}),e.jsx(n,{fontSize:"xs",color:"gray.500",textAlign:"center",children:"Esta política se rige por la Ley de Protección de Datos Personales del Perú (Ley N° 29733)."})]})})]})]})]})},wl=()=>e.jsx(k,{bg:"gray.50",py:8,mt:"auto",children:e.jsx(Ma,{maxW:"container.xl",children:e.jsxs(u,{spacing:6,children:[e.jsxs(h,{spacing:8,wrap:"wrap",justify:"center",children:[e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:Ks,color:"blue.500"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"+51 961 606 183"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:Lr,color:"blue.500"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"aguademesaaquayara@gmail.com"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:vt,color:"blue.500"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Pucallpa, Perú"})]})]}),e.jsx(hs,{}),e.jsxs(h,{spacing:6,wrap:"wrap",justify:"center",children:[e.jsx(Sl,{}),e.jsx(Cl,{}),e.jsx(xr,{href:"mailto:aguademesaaquayara@gmail.com",color:"blue.500",fontSize:"sm",_hover:{textDecoration:"underline"},children:"Soporte Técnico"})]}),e.jsx(hs,{}),e.jsxs(u,{spacing:2,children:[e.jsx(n,{fontSize:"sm",color:"gray.500",textAlign:"center",children:"© 2025 AquaYara - Agua Purificada de Calidad"}),e.jsx(n,{fontSize:"xs",color:"gray.400",textAlign:"center",children:"Todos los derechos reservados | Horario: Lunes a Sábado 8:00 AM - 6:00 PM"})]})]})})}),zn=()=>{const{user:s,logout:t}=Rs(),{isAdmin:r,isDeliveryPerson:a}=Vn(),i=tt();Le();const[l,o]=S.useState(!1),[c,d]=S.useState(()=>{const z=localStorage.getItem("sidebarCollapsed");return z?JSON.parse(z):!1});bl();const f=Hs({base:!0,lg:!1});S.useEffect(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(c))},[c]);const P=()=>{t(),i("/")},I=()=>!s||!s.username?"?":s.username.charAt(0).toUpperCase(),m=[{to:"/dashboard",label:"Dashboard",icon:"🏠"},{to:"/dashboard/orders-management",label:"Gestión de Pedidos",icon:"📦",adminOnly:!0},{to:"/dashboard/clients",label:"Clientes",icon:"👥",adminOnly:!0},{to:"/dashboard/vales",label:"Gestión de Vales",icon:"🎫",adminOnly:!0},{to:"/dashboard/collection-report",label:"Reporte de Cobranza",icon:"💰",adminOnly:!0},{to:"/dashboard/subscriptions",label:"Suscripciones",icon:"📅",adminOnly:!0},{to:"/dashboard/delivery-fees",label:"Tarifas de Envío",icon:"🚚",adminOnly:!0},{to:"/dashboard/terms-and-conditions",label:"Términos y Condiciones",icon:"📄",adminOnly:!0},{to:"/dashboard/users-management",label:"Gestión de Usuarios",icon:"👥",adminOnly:!0}],T=[{to:"/delivery-dashboard",label:"Dashboard",icon:"🏠"},{to:"/delivery-dashboard#orders",label:"Mis Pedidos",icon:"📦"},{to:"/delivery-dashboard#stats",label:"Estadísticas",icon:"📊"},{to:"/delivery-dashboard#vouchers",label:"Vales",icon:"🎫"}],D=a()?T:m.filter(z=>!z.adminOnly||r()),_=()=>{o(!1)},y=({isCollapsed:z=!1})=>e.jsxs(u,{spacing:0,h:"full",align:"stretch",children:[e.jsx(k,{p:z?3:6,borderBottom:"1px solid",borderColor:"whiteAlpha.200",children:z?e.jsx(n,{fontSize:"2xl",textAlign:"center",color:"white",children:"🏠"}):e.jsx(bt,{size:"md",variant:"vertical",color:"white",textColor:"white",taglineColor:"whiteAlpha.700"})}),e.jsx(u,{spacing:1,flex:1,align:"stretch",p:2,children:D.map(E=>e.jsx(O,{as:oi,to:E.to,variant:"ghost",color:"white",justifyContent:z?"center":"flex-start",leftIcon:e.jsx(n,{children:E.icon}),_hover:{bg:"whiteAlpha.200"},_active:{bg:"whiteAlpha.300"},size:"sm",h:"40px",onClick:_,title:z?E.label:void 0,children:!z&&E.label},E.to))}),e.jsx(k,{p:z?2:4,borderTop:"1px solid",borderColor:"whiteAlpha.200",children:e.jsxs(An,{children:[e.jsx(En,{as:O,variant:"ghost",color:"white",w:"full",justifyContent:z?"center":"flex-start",leftIcon:e.jsx(Ha,{size:"sm",name:I()}),rightIcon:z?void 0:e.jsx(qa,{}),title:z?`${s==null?void 0:s.username} (${s==null?void 0:s.role})`:void 0,children:!z&&e.jsxs(u,{spacing:0,align:"flex-start",children:[e.jsx(n,{fontSize:"sm",fontWeight:"medium",children:s==null?void 0:s.username}),e.jsx(n,{fontSize:"xs",color:"whiteAlpha.700",children:s==null?void 0:s.role})]})}),e.jsx(Tn,{children:e.jsx(gr,{onClick:()=>{P(),_()},color:"red.500",children:"Cerrar Sesión"})})]})})]});return e.jsxs(vs,{minH:"100vh",bg:"gray.50",children:[!f&&e.jsxs(k,{w:c?"60px":"280px",bg:"purple.600",color:"white",position:"fixed",h:"100vh",overflowY:"auto",zIndex:1e3,left:0,top:0,transition:"width 0.3s ease",children:[e.jsx(y,{isCollapsed:c}),e.jsx(_e,{icon:c?e.jsx(Jr,{}):e.jsx(Kr,{}),variant:"ghost",color:"white",size:"sm",position:"absolute",right:"-12px",top:"50%",transform:"translateY(-50%)",bg:"purple.600",border:"2px solid",borderColor:"purple.600",borderRadius:"full",_hover:{bg:"purple.700"},onClick:()=>d(!c),zIndex:1001})]}),e.jsxs($a,{isOpen:l,onClose:()=>o(!1),placement:"left",size:"xs",closeOnOverlayClick:!0,closeOnEsc:!0,children:[e.jsx(We,{}),e.jsxs(Ba,{children:[e.jsx(He,{}),e.jsx(Me,{bg:"purple.600",color:"white",children:e.jsx(bt,{size:"sm",variant:"horizontal",color:"white",textColor:"white",taglineColor:"whiteAlpha.700"})}),e.jsx($e,{p:0,children:e.jsx(k,{bg:"purple.600",color:"white",h:"full",children:e.jsx(y,{})})})]})]}),e.jsxs(k,{flex:1,ml:f?0:c?"60px":"280px",display:"flex",flexDirection:"column",transition:"margin-left 0.3s ease",children:[e.jsx(k,{bg:"white",px:{base:4,md:6},py:4,boxShadow:"sm",borderBottom:"1px solid",borderColor:"gray.200",position:"sticky",top:0,zIndex:999,children:e.jsxs(vs,{align:"center",justify:"space-between",children:[e.jsxs(h,{spacing:4,children:[f?e.jsx(_e,{icon:e.jsx(Va,{}),variant:"ghost",onClick:()=>o(!0),"aria-label":"Abrir menú"}):e.jsx(_e,{icon:c?e.jsx(Jr,{}):e.jsx(Kr,{}),variant:"ghost",onClick:()=>d(!c),"aria-label":c?"Expandir sidebar":"Colapsar sidebar",size:"sm"}),e.jsx(bt,{size:"sm",variant:"horizontal"}),e.jsx(n,{fontSize:"lg",fontWeight:"semibold",color:"gray.700",children:a()?"Panel de Repartidor":"Panel de Administración"})]}),e.jsxs(h,{spacing:4,children:[e.jsx(va,{variant:"badge"}),e.jsx(ye,{colorScheme:"green",variant:"subtle",children:"En línea"})]})]})}),e.jsx(k,{flex:1,p:{base:4,md:6},overflowY:"auto",position:"relative",zIndex:1,children:e.jsx(Nn,{})}),e.jsx(wl,{})]})]})},zl=()=>{const[s,t]=S.useState({username:"",password:""}),[r,a]=S.useState(!1),i=tt(),l=ps(),{login:o,error:c,clearError:d}=Rs(),f=async I=>{I.preventDefault(),a(!0);try{(await o(s.username,s.password)).success&&(l({title:"Éxito",description:"Inicio de sesión exitoso",status:"success",duration:3e3,isClosable:!0}),i("/dashboard"))}catch(m){console.error("Error en login:",m)}finally{a(!1)}},P=I=>{t({...s,[I.target.name]:I.target.value}),c&&d()};return e.jsx(is,{minH:"100vh",bg:"gray.50",children:e.jsx(k,{w:"full",maxW:"md",p:6,children:e.jsx(F,{children:e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(k,{textAlign:"center",children:[e.jsx(bt,{size:"xl",variant:"vertical",color:"blue.500",textColor:"blue.600",taglineColor:"teal.500"}),e.jsx(n,{color:"gray.600",mt:2,children:"Sistema de Gestión"})]}),e.jsx(k,{w:"full",children:e.jsx("form",{onSubmit:f,children:e.jsxs(u,{spacing:4,children:[c&&e.jsxs(De,{status:"error",borderRadius:"md",children:[e.jsx(Ie,{}),c]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Usuario"}),e.jsx(re,{name:"username",value:s.username,onChange:P,placeholder:"Ingresa tu usuario",size:"lg",autoComplete:"username"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Contraseña"}),e.jsx(re,{name:"password",type:"password",value:s.password,onChange:P,placeholder:"Ingresa tu contraseña",size:"lg",autoComplete:"current-password"})]}),e.jsx(O,{type:"submit",colorScheme:"blue",size:"lg",w:"full",isLoading:r,loadingText:"Iniciando sesión...",children:"Iniciar Sesión"})]})})}),e.jsx(k,{textAlign:"center",children:e.jsx(n,{fontSize:"sm",color:"gray.500",children:"Sistema de gestión para planta de agua"})})]})})})})})},Sa=pt((s,t)=>({products:[],loading:!1,error:null,fetchProducts:async()=>{s({loading:!0,error:null});try{const r=await X.get("/api/products");s({products:r.data,loading:!1})}catch(r){console.error("Error al cargar productos:",r),s({error:r.message,loading:!1})}},createProduct:async r=>{s({loading:!0,error:null});try{const i=(await X.post("/api/products",r)).data;return s(l=>({products:[...l.products,i],loading:!1})),{success:!0,data:i}}catch(a){return console.error("Error al crear producto:",a),s({error:a.message,loading:!1}),{success:!1,error:a.message}}},updateProduct:async(r,a)=>{s({loading:!0,error:null});try{const l=(await X.put(`/api/products/${r}`,a)).data;return s(o=>({products:o.products.map(c=>c.id===r?l:c),loading:!1})),{success:!0,data:l}}catch(i){return console.error("Error al actualizar producto:",i),s({error:i.message,loading:!1}),{success:!1,error:i.message}}},deleteProduct:async r=>{s({loading:!0,error:null});try{return await X.delete(`/api/products/${r}`),s(a=>({products:a.products.filter(i=>i.id!==r),loading:!1})),{success:!0}}catch(a){return console.error("Error al eliminar producto:",a),s({error:a.message,loading:!1}),{success:!1,error:a.message}}},calculatePrice:async(r,a)=>{try{return{success:!0,data:(await X.post(`/api/products/${r}/calculate-price`,{quantity:a})).data.data.pricing}}catch(i){return console.error("Error al calcular precio:",i),{success:!1,error:i.message}}},getPricingInfo:async r=>{try{return{success:!0,data:(await X.get(`/api/products/${r}/pricing-info`)).data.data.pricingInfo}}catch(a){return console.error("Error al obtener información de precios:",a),{success:!1,error:a.message}}},getFilteredProducts:r=>{const{products:a}=t();return a.filter(i=>{const l=i.name.toLowerCase(),o=i.description?i.description.toLowerCase():"",c=i.type?i.type.toLowerCase():"";return l.includes(r.toLowerCase())||o.includes(r.toLowerCase())||c.includes(r.toLowerCase())})},getProductById:r=>{const{products:a}=t();return a.find(i=>i.id===r)},clearError:()=>s({error:null}),reset:()=>s({products:[],loading:!1,error:null})})),Pl=pt((s,t)=>({clients:[],loading:!1,error:null,fetchClients:async()=>{s({loading:!0,error:null});try{const r=await X.get("/api/clients");console.log("🔍 API Clientes Response:",r.data);const a=r.data.success?r.data.data:r.data;console.log("🔍 Clientes Data:",a),s({clients:a||[],loading:!1})}catch(r){console.error("Error al cargar clientes:",r),s({error:r.message,loading:!1})}},createClient:async r=>{s({loading:!0,error:null});try{const i=(await X.post("/api/clients",r)).data;return s(l=>({clients:[...l.clients,i],loading:!1})),{success:!0,data:i}}catch(a){return console.error("Error al crear cliente:",a),s({error:a.message,loading:!1}),{success:!1,error:a.message}}},updateClient:async(r,a)=>{s({loading:!0,error:null});try{const l=(await X.put(`/api/clients/${r}`,a)).data;return s(o=>({clients:o.clients.map(c=>c.id===r?l:c),loading:!1})),{success:!0,data:l}}catch(i){return console.error("Error al actualizar cliente:",i),s({error:i.message,loading:!1}),{success:!1,error:i.message}}},deleteClient:async r=>{s({loading:!0,error:null});try{return await X.delete(`/api/clients/${r}`),s(a=>({clients:a.clients.filter(i=>i.id!==r),loading:!1})),{success:!0}}catch(a){return console.error("Error al eliminar cliente:",a),s({error:a.message,loading:!1}),{success:!1,error:a.message}}},getFilteredClients:r=>{const{clients:a}=t();return a.filter(i=>{const l=i.name.toLowerCase(),o=i.documentNumber.toLowerCase(),c=i.email?i.email.toLowerCase():"";return l.includes(r.toLowerCase())||o.includes(r.toLowerCase())||c.includes(r.toLowerCase())})},getClientById:r=>{const{clients:a}=t();return a.find(i=>i.id===r)},fetchClientById:async r=>{try{return(await X.get(`/api/clients/${r}`)).data}catch(a){return console.error("Error al obtener cliente:",a),null}},clearError:()=>s({error:null}),reset:()=>s({clients:[],loading:!1,error:null})})),er=pt((s,t)=>({deliveryFees:[],deliveryPersons:[],loading:!1,error:null,fetchDeliveryFees:async()=>{var r,a,i,l;console.log("🔄 fetchDeliveryFees iniciado"),s({loading:!0,error:null});try{const o=await X.get("/api/delivery-fees");console.log("📦 Respuesta del API:",o.data);const c=o.data.success?o.data.data:o.data;return s({deliveryFees:c,loading:!1}),console.log("✅ deliveryFees actualizado en store:",c),{success:!0,data:c}}catch(o){return console.error("❌ Error al cargar tarifas de envío:",o),s({error:((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Error al cargar tarifas",loading:!1}),{success:!1,error:((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al cargar tarifas"}}},createDeliveryFee:async r=>{var a,i,l,o;try{const c=await X.post("/api/delivery-fees",r);return s(d=>({deliveryFees:[...Array.isArray(d.deliveryFees)?d.deliveryFees:[],c.data]})),{success:!0,data:c.data}}catch(c){return console.error("Error al crear tarifa:",c),s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al crear tarifa"}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al crear tarifa"}}},updateDeliveryFee:async(r,a)=>{var i,l,o,c;try{const d=await X.put(`/api/delivery-fees/${r}`,a);return s(f=>({deliveryFees:Array.isArray(f.deliveryFees)?f.deliveryFees.map(P=>P.id===r?d.data:P):[]})),{success:!0,data:d.data}}catch(d){return console.error("Error al actualizar tarifa:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar tarifa"}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar tarifa"}}},deleteDeliveryFee:async r=>{var a,i,l,o;try{return await X.delete(`/api/delivery-fees/${r}`),s(c=>({deliveryFees:Array.isArray(c.deliveryFees)?c.deliveryFees.filter(d=>d.id!==r):[]})),{success:!0}}catch(c){return console.error("Error al eliminar tarifa:",c),s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al eliminar tarifa"}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al eliminar tarifa"}}},fetchDeliveryPersons:async()=>{var r,a,i,l,o,c,d;s({loading:!0,error:null});try{console.log("🔄 fetchDeliveryPersons iniciado");const f=await X.get("/api/user-management");console.log("📦 Respuesta usuarios completos:",f.data);const I=(f.data.success?f.data.data:f.data).filter(m=>m.role==="repartidor");return s({deliveryPersons:I,loading:!1}),console.log("✅ Repartidores cargados:",I.length),{success:!0,data:I}}catch(f){return console.error("❌ Error al cargar repartidores:",f),console.error("❌ Status:",(r=f.response)==null?void 0:r.status),console.error("❌ Message:",(i=(a=f.response)==null?void 0:a.data)==null?void 0:i.message),s({error:((o=(l=f.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al cargar repartidores",loading:!1}),{success:!1,error:((d=(c=f.response)==null?void 0:c.data)==null?void 0:d.message)||"Error al cargar repartidores"}}},createDeliveryPerson:async r=>{var a,i,l,o;try{const c=await X.post("/api/user-management",r);return s(d=>({deliveryPersons:[...Array.isArray(d.deliveryPersons)?d.deliveryPersons:[],c.data.data]})),{success:!0,data:c.data.data}}catch(c){return console.error("Error al crear repartidor:",c),s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al crear repartidor"}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al crear repartidor"}}},updateDeliveryPerson:async(r,a)=>{var i,l,o,c;try{const d=await X.put(`/api/user-management/${r}`,a);return s(f=>({deliveryPersons:Array.isArray(f.deliveryPersons)?f.deliveryPersons.map(P=>P.id===r?d.data.data:P):[]})),{success:!0,data:d.data.data}}catch(d){return console.error("Error al actualizar repartidor:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar repartidor"}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar repartidor"}}},updateDeliveryPersonStatus:async(r,a)=>{var i,l,o,c;try{return await X.patch(`/api/user-management/${r}/toggle-status`,{isActive:a==="available"}),s(d=>({deliveryPersons:Array.isArray(d.deliveryPersons)?d.deliveryPersons.map(f=>f.id===r?{...f,isActive:a==="available"}:f):[]})),{success:!0}}catch(d){return console.error("Error al actualizar estado:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar estado"}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar estado"}}},deleteDeliveryPerson:async r=>{var a,i,l,o;try{return await X.delete(`/api/user-management/${r}`),s(c=>({deliveryPersons:Array.isArray(c.deliveryPersons)?c.deliveryPersons.filter(d=>d.id!==r):[]})),{success:!0}}catch(c){return console.error("Error al eliminar repartidor:",c),s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al eliminar repartidor"}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al eliminar repartidor"}}},getAvailableDeliveryPersons:()=>{const{deliveryPersons:r}=t();return Array.isArray(r)?r.filter(a=>a.isActive===!0):[]},getDeliveryStats:()=>{const{deliveryPersons:r,deliveryFees:a}=t(),i=Array.isArray(r)?r:[],l=Array.isArray(a)?a:[],o=i.length,c=i.filter(I=>I.isActive===!0).length,d=i.filter(I=>I.isActive===!1).length,f=l.length,P=l.filter(I=>I.isActive).length;return{totalPersons:o,availablePersons:c,inactivePersons:d,totalFees:f,activeFees:P}},clearError:()=>s({error:null})})),Hr=pt((s,t)=>({orders:[],loading:!1,error:null,createGuestOrder:async r=>{var a,i,l,o,c;s({loading:!0,error:null});try{console.log("Enviando datos al backend:",r);const d=await X.post("/api/guest-orders",r);console.log("Respuesta completa del servidor:",d),console.log("Datos de la respuesta:",d.data);const f=d.data.data;return console.log("Procesando respuesta - newOrder:",f),s(P=>({orders:Array.isArray(P.orders)?[...P.orders,f]:[f],loading:!1})),{success:!0,data:f}}catch(d){return console.error("Error al crear pedido de invitado:",d),console.error("Detalles del error:",(a=d.response)==null?void 0:a.data),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al crear pedido",loading:!1}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al crear pedido"}}},fetchOrders:async()=>{var r,a,i,l;s({loading:!0,error:null});try{const o=await X.get("/api/guest-orders?limit=1000");console.log("Respuesta completa del servidor:",o),console.log("Datos de la respuesta:",o.data);const c=o.data.success?o.data.data:o.data;return console.log("Procesando pedidos:",c),s({orders:Array.isArray(c)?c:[],loading:!1}),{success:!0,data:c}}catch(o){return console.error("Error al cargar pedidos de invitados:",o),s({error:((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Error al cargar pedidos",loading:!1}),{success:!1,error:((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al cargar pedidos"}}},updateOrderStatus:async(r,a)=>{var i,l,o,c;try{return await X.put(`/api/guest-orders/${r}/status`,{status:a}),s(d=>({orders:Array.isArray(d.orders)?d.orders.map(f=>f.id===r?{...f,status:a}:f):[]})),{success:!0}}catch(d){return console.error("Error al actualizar estado:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar estado"}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar estado"}}},updateGuestOrder:async(r,a)=>{var i,l,o,c;s({loading:!0,error:null});try{if(a.deliveryPersonId){console.log("🔍 Asignando repartidor - Enviando petición:",{url:`/api/guest-orders/${r}/assign-delivery`,data:{deliveryPersonId:a.deliveryPersonId},headers:X.defaults.headers.common});const d=await X.put(`/api/guest-orders/${r}/assign-delivery`,{deliveryPersonId:a.deliveryPersonId}),f=d.data.data;return console.log("🔍 Asignación de repartidor - Respuesta recibida:",d.data),console.log("🔍 Asignación de repartidor - updatedOrder:",f),s(P=>({orders:Array.isArray(P.orders)?P.orders.map(I=>I.id===r?{...I,...f}:I):[],loading:!1})),{success:!0,data:f}}else{console.log("🔍 updateGuestOrder - Enviando petición:",{url:`/api/guest-orders/${r}`,data:a,headers:X.defaults.headers.common});const d=await X.put(`/api/guest-orders/${r}`,a),f=d.data;return console.log("🔍 updateGuestOrder - Respuesta recibida:",d.data),console.log("🔍 updateGuestOrder - updatedOrder:",f),s(P=>({orders:Array.isArray(P.orders)?P.orders.map(I=>I.id===r?{...I,...f}:I):[],loading:!1})),{success:!0,data:f}}}catch(d){return console.error("Error al actualizar pedido de invitado:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar pedido",loading:!1}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar pedido"}}},getOrderById:r=>{const{orders:a}=t();return Array.isArray(a)?a.find(i=>i.id===r):null},getOrdersByStatus:r=>{const{orders:a}=t();return Array.isArray(a)?a.filter(i=>i.status===r):[]},getOrderStats:()=>{const{orders:r}=t();return Array.isArray(r)?{total:r.length,pending:r.filter(a=>a.status==="pendiente").length,inProgress:r.filter(a=>a.status==="en_camino").length,delivered:r.filter(a=>a.status==="entregado").length,cancelled:r.filter(a=>a.status==="cancelado").length}:{total:0,pending:0,inProgress:0,delivered:0,cancelled:0}},clearError:()=>s({error:null})})),Al=()=>{var Ne,w,Q,ne,de,A,me,M;const s=tt(),t=Ze("white","gray.800"),r=Ze("gray.200","gray.600");Hs({base:!0,md:!1});const[a,i]=S.useState(new Date),{products:l,fetchProducts:o}=Sa(),{clients:c,fetchClients:d}=Pl(),{getDeliveryStats:f,fetchDeliveryPersons:P,fetchDeliveryFees:I}=er(),{orders:m,fetchOrders:T,getOrderStats:C}=Hr(),D=async()=>{try{const Y=await X.get("/api/vouchers/stats");console.log("📦 Respuesta vales:",Y.data),Y.data.success&&(g(Y.data.data),console.log("✅ Estadísticas de vales actualizadas:",Y.data.data))}catch(Y){console.error("Error al cargar estadísticas de vales:",Y)}},_=async()=>{try{const Y=await X.get("/api/subscriptions");if(console.log("📦 Respuesta suscripciones:",Y.data),Y.data.success){const se=Y.data.data||[];V({total:se.length,active:se.filter(fe=>fe.status==="active").length}),console.log("✅ Estadísticas de suscripciones actualizadas:",{total:se.length,active:se.filter(fe=>fe.status==="active").length})}}catch(Y){console.error("Error al cargar estadísticas de suscripciones:",Y)}};S.useEffect(()=>{(async()=>{try{await new Promise(fe=>setTimeout(fe,100)),o(),d(),I(),T(),D(),_()}catch(fe){console.error("Error cargando datos del dashboard:",fe)}})();const se=setInterval(()=>{T(),d(),D(),_(),i(new Date)},3e4);return()=>clearInterval(se)},[o,d,I,T]),C(),f();const y=(m==null?void 0:m.length)||0,z=((Ne=m==null?void 0:m.filter(Y=>Y.status==="pending"))==null?void 0:Ne.length)||0,E=((w=m==null?void 0:m.filter(Y=>Y.status==="delivered"))==null?void 0:w.length)||0,N=((Q=m==null?void 0:m.filter(Y=>Y.status==="confirmed"))==null?void 0:Q.length)||0,$=((ne=m==null?void 0:m.filter(Y=>Y.status==="preparing"))==null?void 0:ne.length)||0,R=((de=m==null?void 0:m.filter(Y=>Y.status==="ready"))==null?void 0:de.length)||0,p=((A=m==null?void 0:m.filter(Y=>Y.paymentMethod==="contraentrega"))==null?void 0:A.length)||0,H=((me=m==null?void 0:m.filter(Y=>Y.paymentMethod==="vale"))==null?void 0:me.length)||0,b=((M=m==null?void 0:m.filter(Y=>Y.paymentMethod==="suscripcion"))==null?void 0:M.length)||0,[ae,g]=S.useState({total:0,pending:0}),[B,V]=S.useState({total:0,active:0}),te=(c==null?void 0:c.length)||0;console.log("🔍 Dashboard Debug:",{clients:(c==null?void 0:c.length)||0,totalClients:te,valeOrders:H,suscripcionOrders:b});const Ce=(m==null?void 0:m.reduce((Y,se)=>Y+(parseFloat(se.totalAmount)||0),0))||0,xe=(m==null?void 0:m.filter(Y=>{const se=new Date(Y.createdAt),fe=new Date;return se.toDateString()===fe.toDateString()}).reduce((Y,se)=>Y+(parseFloat(se.totalAmount)||0),0))||0,Ae=[{title:"Pedidos",icon:ws,color:"orange",onClick:()=>s("/dashboard/orders-management"),count:y,description:"Gestionar pedidos"},{title:"Clientes",icon:Qn,color:"green",onClick:()=>s("/dashboard/clients"),count:te,description:"Base de clientes"},{title:"Suscripciones",icon:_s,color:"purple",onClick:()=>s("/dashboard/subscriptions"),count:B.active,description:`${B.total} total, ${B.active} activas`},{title:"Vales",icon:Bs,color:"blue",onClick:()=>s("/dashboard/vales"),count:ae.pending,description:`${ae.total} total, ${ae.pending} pendientes`},{title:"Cobranza",icon:Gn,color:"red",onClick:()=>s("/dashboard/collection-report"),count:ae.pending,description:"Vales por cobrar"},{title:"Términos",icon:ro,color:"teal",onClick:()=>s("/dashboard/terms-and-conditions"),count:0,description:"Términos y condiciones"},{title:"Usuarios",icon:ho,color:"cyan",onClick:()=>s("/dashboard/users-management"),count:0,description:"Gestión de usuarios"}];return e.jsxs(k,{p:{base:1,sm:2,md:4},maxW:"100%",overflow:"hidden",children:[e.jsxs(vs,{direction:{base:"column",sm:"row"},align:{base:"center",sm:"flex-start"},justify:"space-between",mb:{base:4,md:6},wrap:"wrap",gap:2,children:[e.jsxs(u,{align:{base:"center",sm:"flex-start"},spacing:{base:1,md:2},maxW:{base:"100%",sm:"70%"},children:[e.jsx(bt,{size:{base:"sm",md:"md"},variant:"horizontal",color:"blue.500",textColor:"blue.600",taglineColor:"teal.500"}),e.jsx(Z,{size:{base:"md",md:"lg"},color:"gray.700",textAlign:{base:"center",sm:"left"},children:"Dashboard Administrativo"}),e.jsx(n,{color:"gray.500",fontSize:{base:"xs",md:"sm"},textAlign:{base:"center",sm:"left"},children:"Gestión completa del negocio"}),e.jsxs(n,{color:"gray.400",fontSize:"xs",textAlign:{base:"center",sm:"left"},children:["Última actualización: ",a.toLocaleTimeString()]})]}),e.jsxs(u,{spacing:1,align:{base:"center",sm:"flex-end"},children:[e.jsx(ye,{colorScheme:"green",variant:"subtle",fontSize:"xs",children:"Sistema Activo"}),e.jsx(O,{size:"xs",colorScheme:"blue",variant:"outline",onClick:()=>{T(),d(),P(),D(),_(),i(new Date)},children:"Actualizar"})]})]}),e.jsxs(os,{columns:{base:1,sm:2,lg:5},spacing:{base:2,md:4},mb:{base:4,md:8},maxW:"100%",children:[e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"orange.600",fontSize:{base:"xs",md:"sm"},children:"📦 Pedidos Pendientes"}),e.jsx(Xe,{color:"orange.500",fontSize:{base:"xl",md:"2xl"},children:z}),e.jsxs(Qe,{fontSize:{base:"xs",md:"sm"},children:[N," confirmados"]})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"green.600",fontSize:{base:"xs",md:"sm"},children:"💰 Ingresos Hoy"}),e.jsxs(Xe,{color:"green.500",fontSize:{base:"xl",md:"2xl"},children:["S/ ",xe.toFixed(2)]}),e.jsxs(Qe,{fontSize:{base:"xs",md:"sm"},children:["Total: S/ ",Ce.toFixed(2)]})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"blue.600",fontSize:{base:"xs",md:"sm"},children:"👥 Clientes"}),e.jsx(Xe,{color:"blue.500",fontSize:{base:"xl",md:"2xl"},children:c.length}),e.jsx(Qe,{fontSize:{base:"xs",md:"sm"},children:"Clientes registrados"})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"purple.600",fontSize:{base:"xs",md:"sm"},children:"✅ Entregados"}),e.jsx(Xe,{color:"purple.500",fontSize:{base:"xl",md:"2xl"},children:E}),e.jsxs(Qe,{fontSize:{base:"xs",md:"sm"},children:[R," listos para entregar"]})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"yellow.600",fontSize:{base:"xs",md:"sm"},children:"📊 Total Pedidos"}),e.jsx(Xe,{color:"yellow.500",fontSize:{base:"xl",md:"2xl"},children:y}),e.jsxs(Qe,{fontSize:{base:"xs",md:"sm"},children:[$," en preparación"]})]})})})]}),e.jsxs(os,{columns:{base:2,sm:2,lg:4},spacing:{base:2,md:4},mb:{base:4,md:8},maxW:"100%",children:[e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:2,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"blue.600",fontSize:{base:"xs",md:"sm"},children:"💵 Contraentrega"}),e.jsx(Xe,{color:"blue.500",fontSize:{base:"lg",md:"xl"},children:p}),e.jsx(Qe,{fontSize:{base:"xs",md:"sm"},children:"Pago al recibir"})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:2,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"orange.600",fontSize:{base:"xs",md:"sm"},children:"🎫 Vales"}),e.jsx(Xe,{color:"orange.500",fontSize:{base:"lg",md:"xl"},children:H}),e.jsx(Qe,{fontSize:{base:"xs",md:"sm"},children:"Pago a crédito"})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:2,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"purple.600",fontSize:{base:"xs",md:"sm"},children:"📅 Suscripciones"}),e.jsx(Xe,{color:"purple.500",fontSize:{base:"lg",md:"xl"},children:b}),e.jsx(Qe,{fontSize:{base:"xs",md:"sm"},children:"Pago mensual"})]})})}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",children:e.jsx(L,{p:{base:2,md:4},children:e.jsxs(Ge,{children:[e.jsx(Ye,{color:"green.600",fontSize:{base:"xs",md:"sm"},children:"💧 Productos"}),e.jsx(Xe,{color:"green.500",fontSize:{base:"lg",md:"xl"},children:l.length}),e.jsx(Qe,{fontSize:{base:"xs",md:"sm"},children:"En inventario"})]})})})]}),e.jsx(F,{bg:t,borderColor:r,boxShadow:"sm",maxW:"100%",children:e.jsxs(L,{p:{base:3,md:4},children:[e.jsx(Z,{size:{base:"sm",md:"md"},mb:{base:3,md:4},color:"gray.700",children:"🚀 Acciones Rápidas"}),e.jsx(os,{columns:{base:2,sm:2,md:3,lg:6},spacing:{base:3,md:4},maxW:"100%",children:Ae.map((Y,se)=>e.jsx(F,{borderColor:`${Y.color}.200`,borderWidth:"2px",cursor:"pointer",onClick:Y.onClick,_hover:{transform:"translateY(-2px)",boxShadow:"lg",borderColor:`${Y.color}.300`,bg:`${Y.color}.50`},transition:"all 0.2s",borderRadius:"lg",bg:"white",h:{base:"130px",md:"140px"},children:e.jsx(L,{p:{base:3,md:4},h:"100%",children:e.jsxs(u,{spacing:{base:2,md:3},h:"100%",justify:"space-between",align:"center",children:[e.jsx(k,{display:"flex",alignItems:"center",justifyContent:"center",h:{base:"32px",md:"40px"},w:{base:"32px",md:"40px"},borderRadius:"full",bg:`${Y.color}.100`,flexShrink:0,children:e.jsx(Y.icon,{size:{base:18,md:22},color:`${Y.color}.600`})}),e.jsxs(u,{spacing:1,flex:1,w:"100%",textAlign:"center",children:[e.jsx(n,{fontSize:{base:"xs",md:"sm"},fontWeight:"bold",color:"gray.700",noOfLines:2,lineHeight:"1.2",minH:{base:"28px",md:"32px"},display:"flex",alignItems:"center",justifyContent:"center",children:Y.title}),e.jsx(n,{fontSize:{base:"2xs",md:"xs"},color:"gray.500",noOfLines:2,lineHeight:"1.1",minH:{base:"20px",md:"24px"},children:Y.description})]}),e.jsxs(k,{position:"relative",display:"inline-block",children:[e.jsx(k,{bg:`${Y.color}.500`,color:"white",borderRadius:"full",px:{base:3,md:4},py:{base:2,md:2.5},fontSize:{base:"lg",md:"xl"},fontWeight:"900",minW:{base:"40px",md:"44px"},h:{base:"40px",md:"44px"},display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"lg",border:"4px solid white",_hover:{transform:"scale(1.1)",boxShadow:"xl",bg:`${Y.color}.600`},transition:"all 0.3s ease",cursor:"pointer",children:Y.count}),e.jsx(k,{position:"absolute",top:"-2px",right:"-2px",w:"12px",h:"12px",bg:"white",borderRadius:"full",opacity:.8,className:"pulse-animation"})]})]})})},se))})]})})]})},El=()=>{var je,v,we,Ke,gs,ss,Ue;const{orders:s,loading:t,fetchOrders:r,updateGuestOrder:a}=Hr(),{deliveryPersons:i,fetchDeliveryPersons:l}=er(),[o,c]=S.useState(""),[d,f]=S.useState("all"),[P,I]=S.useState("all"),[m,T]=S.useState(null),[C,D]=S.useState(""),[_,y]=S.useState(new Date),[z,E]=S.useState(""),{isOpen:N,onOpen:$,onClose:R}=Le(),{isOpen:p,onOpen:H,onClose:b}=Le(),{isOpen:ae,onOpen:g,onClose:B}=Le(),V=ps();S.useEffect(()=>{r(),l();const x=setInterval(()=>{r(),y(new Date)},3e4);return()=>clearInterval(x)},[r,l]);const te=s.map(x=>({...x,type:"guest",orderNumber:x.orderNumber||`PED-${x.id}`,clientName:x.clientName||x.customerName,clientPhone:x.clientPhone||x.customerPhone,clientAddress:x.clientAddress||x.deliveryAddress,clientDistrict:x.clientDistrict||x.deliveryDistrict})).sort((x,ue)=>new Date(ue.createdAt)-new Date(x.createdAt));console.log("🔍 Pedidos cargados:",te.length),console.log("🔍 Repartidores cargados:",i.length),console.log("🔍 Primer pedido completo:",te[0]),console.log("🔍 Estructura del cliente:",(je=te[0])==null?void 0:je.Client),console.log("🔍 Datos del cliente:",{clientName:(v=te[0])==null?void 0:v.clientName,clientPhone:(we=te[0])==null?void 0:we.clientPhone,clientAddress:(Ke=te[0])==null?void 0:Ke.clientAddress,Client:(gs=te[0])==null?void 0:gs.Client,deliveryAddress:(ss=te[0])==null?void 0:ss.deliveryAddress,deliveryDistrict:(Ue=te[0])==null?void 0:Ue.deliveryDistrict});const Ce=te.filter(x=>x.deliveryPersonId);console.log("🔍 Pedidos asignados:",Ce.length),Ce.forEach(x=>{console.log(`🔍 Pedido ${x.id} asignado a repartidor ${x.deliveryPersonId}:`,{id:x.id,status:x.status,deliveryPersonId:x.deliveryPersonId,deliveryPerson:x.deliveryPerson})}),console.log("🔍 Repartidores disponibles:",i.map(x=>({id:x.id,name:x.name,type:typeof x.id}))),te.forEach((x,ue)=>{ue<3&&console.log(`🔍 Pedido ${ue+1}:`,{id:x.id,type:x.type,clientName:x.clientName,clientPhone:x.clientPhone,Client:x.Client,customerName:x.customerName,customerPhone:x.customerPhone,deliveryAddress:x.deliveryAddress,products:x.products,orderDetails:x.orderDetails})});const xe=(te||[]).filter(x=>{var fs,js,Se,Ts;const ue=((fs=x.orderNumber)==null?void 0:fs.toLowerCase().includes(o.toLowerCase()))||((js=x.clientName)==null?void 0:js.toLowerCase().includes(o.toLowerCase()))||((Ts=(Se=x.client)==null?void 0:Se.name)==null?void 0:Ts.toLowerCase().includes(o.toLowerCase())),ie=d==="all"||x.status===d,ls=P==="all"||P==="efectivo"&&x.paymentType==="efectivo"||P==="plin"&&x.paymentType==="plin"||P==="vale"&&x.paymentMethod==="vale"||P==="suscripcion"&&x.paymentMethod==="suscripcion"||P==="contraentrega"&&x.paymentMethod==="contraentrega";return ue&&ie&&ls}),Ae={pending:xe.filter(x=>x.status==="pending")||[],confirmed:xe.filter(x=>x.status==="confirmed")||[],preparing:xe.filter(x=>x.status==="preparing")||[],ready:xe.filter(x=>x.status==="ready")||[],delivered:xe.filter(x=>x.status==="delivered")||[],cancelled:xe.filter(x=>x.status==="cancelled")||[]},Ne=x=>{switch(x){case"pending":return"orange";case"confirmed":return"blue";case"preparing":return"yellow";case"ready":return"purple";case"delivered":return"green";case"cancelled":return"red";case"pendiente":return"orange";case"asignado":return"blue";case"en_camino":return"purple";case"entregado":return"green";case"cancelado":return"red";default:return"gray"}},w=x=>{switch(x){case"pending":return"Pendiente";case"confirmed":return"Asignado";case"preparing":return"Preparando";case"ready":return"Listo";case"delivered":return"Entregado";case"cancelled":return"Cancelado";case"pendiente":return"Pendiente";case"asignado":return"Asignado";case"en_camino":return"En Camino";case"entregado":return"Entregado";case"cancelado":return"Cancelado";default:return x}},Q=(x,ue)=>{if(ue==="suscripcion")return _s;switch(x){case"cash":case"efectivo":return ys;case"plin":return Ys;case"yape":return Ys;case"transfer":return FaCreditCard;default:return ys}},ne=x=>{let ue=[];return x.type==="regular"&&x.orderDetails&&(ue=x.orderDetails.map(ie=>{var ls,fs;return{name:((ls=ie.product)==null?void 0:ls.name)||((fs=ie.Product)==null?void 0:fs.name)||"Producto",quantity:ie.quantity||0,price:ie.unitPrice||ie.price||0}})),x.type==="guest"&&x.products&&(ue=x.products.map(ie=>{var ls;return{name:((ls=ie.product)==null?void 0:ls.name)||ie.name||"Producto",quantity:ie.quantity||0,price:ie.price||ie.unitPrice||0}})),ue.length===0?e.jsx(n,{fontSize:"xs",color:"gray.500",fontStyle:"italic",children:"Sin productos"}):e.jsx(u,{spacing:1,align:"start",w:"full",children:ue.map((ie,ls)=>e.jsxs(h,{justify:"space-between",w:"full",fontSize:"xs",children:[e.jsx(n,{noOfLines:1,flex:1,children:ie.name}),e.jsxs(n,{color:"gray.600",minW:"fit-content",children:["x",ie.quantity]}),e.jsxs(n,{color:"green.600",fontWeight:"medium",minW:"fit-content",children:["S/ ",(ie.price*ie.quantity).toFixed(2)]})]},ls))})},de=async()=>{if(!m||!C){V({title:"Datos incompletos",description:"Selecciona un repartidor",status:"warning",duration:3e3,isClosable:!0});return}if(m.status==="cancelled"){V({title:"Acción no permitida",description:"No se puede asignar repartidor a un pedido cancelado",status:"error",duration:3e3,isClosable:!0}),R();return}try{const x={status:"confirmed",deliveryPersonId:C,notes:z};console.log("🔍 Asignando repartidor:",{orderId:m.id,deliveryPersonId:C,updateData:x});const ue=await a(m.id,x);console.log("🔍 Resultado de la asignación:",ue),V({title:"Repartidor asignado",description:"El pedido ha sido asignado exitosamente",status:"success",duration:3e3,isClosable:!0}),r(),R(),T(null),D(""),E("")}catch{V({title:"Error",description:"No se pudo asignar el repartidor",status:"error",duration:3e3,isClosable:!0})}},A=x=>{T(x),g()},me=async()=>{if(m)try{const x={status:"cancelled"};await a(m.id,x),V({title:"Pedido anulado",description:`El pedido #${m.id} ha sido anulado exitosamente`,status:"success",duration:3e3,isClosable:!0}),B(),T(null),r()}catch{V({title:"Error",description:"No se pudo anular el pedido",status:"error",duration:3e3,isClosable:!0})}},M=async(x,ue)=>{try{const ie={status:ue};await a(x.id,ie),V({title:"Estado actualizado",description:`El pedido ahora está ${w(ue).toLowerCase()}`,status:"success",duration:3e3,isClosable:!0})}catch{V({title:"Error",description:"No se pudo actualizar el estado",status:"error",duration:3e3,isClosable:!0})}},Y=x=>{if(x.status==="cancelled"){V({title:"Acción no permitida",description:"No se puede asignar repartidor a un pedido cancelado",status:"warning",duration:3e3,isClosable:!0});return}T(x),D(x.deliveryPersonId||""),E(x.notes||""),$()},se=x=>{T(x),H()},fe=async x=>{var ue;try{console.log("🔍 Descargando boleta para pedido:",x);const ie=await fetch("/api/admin/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({orderData:{id:x.id,customerName:x.clientName||x.customerName,customerPhone:x.clientPhone||x.customerPhone,customerEmail:x.customerEmail||((ue=x.client)==null?void 0:ue.email),deliveryAddress:x.clientAddress||x.deliveryAddress,deliveryDistrict:x.clientDistrict||x.deliveryDistrict,subtotal:x.subtotal||x.total||x.totalAmount,deliveryFee:x.deliveryFee||0,total:x.total||x.totalAmount,paymentMethod:x.paymentMethod,paymentType:x.paymentType,items:(x.products||x.orderDetails||[]).map(Se=>{var Ts;return{name:((Ts=Se.product)==null?void 0:Ts.name)||Se.name||"Producto",quantity:Se.quantity||1,price:Se.price||Se.unitPrice||0,subtotal:Se.subtotal||(Se.price||Se.unitPrice||0)*(Se.quantity||1)}}),products:(x.products||x.orderDetails||[]).map(Se=>{var Ts;return{name:((Ts=Se.product)==null?void 0:Ts.name)||Se.name||"Producto",quantity:Se.quantity||1,price:Se.price||Se.unitPrice||0,subtotal:Se.subtotal||(Se.price||Se.unitPrice||0)*(Se.quantity||1)}}),originalProducts:x.products,originalOrderDetails:x.orderDetails},documentType:"boleta"})});if(console.log("🔍 Respuesta del servidor:",ie.status,ie.statusText),!ie.ok){const Se=await ie.text();throw console.error("❌ Error del servidor:",Se),new Error(`Error al generar la boleta: ${ie.status} ${ie.statusText}`)}const ls=await ie.blob();console.log("✅ Blob generado, tamaño:",ls.size);const fs=window.URL.createObjectURL(ls),js=document.createElement("a");js.href=fs,js.download=`boleta_${x.orderNumber||x.id}.pdf`,document.body.appendChild(js),js.click(),window.URL.revokeObjectURL(fs),document.body.removeChild(js),V({title:"Boleta descargada",description:"La boleta se ha descargado correctamente",status:"success",duration:3e3,isClosable:!0})}catch(ie){console.error("Error al descargar boleta:",ie),V({title:"Error",description:"No se pudo descargar la boleta",status:"error",duration:3e3,isClosable:!0})}},W=x=>e.jsx(F,{variant:"outline",size:"sm",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",fontSize:"sm",children:x.orderNumber}),e.jsx(n,{fontSize:"xs",color:"gray.500",children:x.type==="regular"?"Cliente Frecuente":"Cliente Visitante"}),e.jsx(n,{fontSize:"2xs",color:"gray.400",children:x.createdAt?new Date(x.createdAt).toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha"})]}),e.jsx(ye,{colorScheme:Ne(x.status),children:w(x.status)})]}),e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{spacing:2,children:[e.jsx(qs,{size:12,color:"#718096"}),e.jsx(n,{fontSize:"sm",fontWeight:"medium",children:x.clientName||"Sin nombre"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(Ks,{size:12,color:"#718096"}),e.jsx(n,{fontSize:"sm",children:x.clientPhone||"Sin teléfono"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(vt,{size:12,color:"#718096"}),e.jsxs(u,{align:"start",spacing:0,children:[e.jsx(n,{fontSize:"sm",noOfLines:2,children:x.clientAddress||x.deliveryAddress||"Sin dirección"}),x.clientDistrict&&e.jsxs(n,{fontSize:"xs",color:"gray.500",children:["📍 ",x.clientDistrict]}),x.deliveryReference&&e.jsxs(n,{fontSize:"xs",color:"gray.500",children:["🔗 ",x.deliveryReference]})]})]})]}),e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsx(n,{fontSize:"sm",fontWeight:"medium",color:"gray.700",children:"🛒 Productos:"}),ne(x)]}),e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsxs(h,{spacing:2,children:[e.jsx(ge,{as:Q(x.paymentType,x.paymentMethod),size:14}),e.jsx(n,{fontSize:"sm",children:x.paymentMethod==="vale"?"A Crédito (Vale)":x.paymentMethod==="suscripcion"?"Suscripción":x.paymentMethod==="contraentrega"?x.paymentType==="plin"?"Contraentrega - PLIN":x.paymentType==="yape"?"Contraentrega - Yape":x.paymentType==="cash"?"Contraentrega - Efectivo":"Contraentrega":x.paymentType==="plin"?"PLIN":x.paymentType==="yape"?"Yape":(x.paymentType==="cash","Efectivo")})]}),e.jsxs(n,{fontWeight:"bold",fontSize:"sm",color:"green.600",children:["S/ ",parseFloat(x.total||x.totalAmount||0).toFixed(2)]})]}),x.paymentMethod==="suscripcion"&&x.subscriptionId&&e.jsx(h,{spacing:2,bg:"purple.50",p:2,borderRadius:"md",children:e.jsxs(n,{fontSize:"xs",color:"purple.600",fontWeight:"medium",children:["📅 Suscripción ID: ",x.subscriptionId]})}),x.paymentMethod==="vale"&&e.jsx(h,{spacing:2,bg:"orange.50",p:2,borderRadius:"md",children:e.jsx(n,{fontSize:"xs",color:"orange.600",fontWeight:"medium",children:"🎫 Pago a crédito - Se cobrará al final del mes"})})]}),x.deliveryPersonId&&e.jsxs(h,{spacing:2,children:[e.jsx(ws,{size:12,color:"#3182CE"}),e.jsx(n,{fontSize:"sm",children:(()=>{const ue=i.find(ie=>ie.id===x.deliveryPersonId);return console.log(`🔍 Buscando repartidor para pedido ${x.id}:`,{deliveryPersonId:x.deliveryPersonId,type:typeof x.deliveryPersonId,foundDeliveryPerson:ue,allDeliveryPersons:i.map(ie=>({id:ie.id,type:typeof ie.id}))}),(ue==null?void 0:ue.name)||"Repartidor asignado"})()})]}),e.jsxs(h,{spacing:2,justify:"center",children:[e.jsx(Oe,{label:"Ver detalles",children:e.jsx(_e,{size:"sm",icon:e.jsx(Nr,{}),onClick:()=>se(x),"aria-label":"Ver detalles"})}),e.jsx(Oe,{label:"Descargar boleta",children:e.jsx(_e,{size:"sm",icon:e.jsx(Fr,{}),colorScheme:"green",onClick:()=>fe(x),"aria-label":"Descargar boleta"})}),(!x.deliveryPersonId||x.status==="pending")&&x.status!=="cancelled"&&e.jsx(Oe,{label:"Asignar repartidor",children:e.jsx(_e,{size:"sm",icon:e.jsx(Vt,{}),colorScheme:"blue",onClick:()=>Y(x),"aria-label":"Asignar repartidor"})}),x.status==="confirmed"&&e.jsx(O,{size:"sm",colorScheme:"purple",onClick:()=>M(x,"preparing"),children:"Enviar"}),(x.status==="preparing"||x.status==="ready")&&e.jsx(O,{size:"sm",colorScheme:"green",onClick:()=>M(x,"delivered"),children:"Entregado"}),(x.status==="pending"||x.status==="confirmed"||x.status==="preparing"||x.status==="ready")&&e.jsx(O,{size:"sm",colorScheme:"red",variant:"outline",onClick:()=>A(x),children:"Anular"})]})]})})},`${x.type}-${x.id}`),Re=()=>{var x;return e.jsxs(Ve,{isOpen:N,onClose:R,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Asignar Repartidor"}),e.jsx(He,{}),e.jsx($e,{children:e.jsxs(u,{spacing:4,children:[m&&e.jsxs(De,{status:"info",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsxs(n,{fontWeight:"bold",children:["Pedido: ",m.orderNumber]}),e.jsxs(n,{fontSize:"sm",children:["Cliente: ",m.clientName||((x=m.client)==null?void 0:x.name)]}),e.jsxs(n,{fontSize:"sm",children:["Total: S/ ",parseFloat(m.total||m.totalAmount||0).toFixed(2)]})]})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Repartidor"}),e.jsx(Je,{value:C,onChange:ue=>D(ue.target.value),placeholder:"Selecciona un repartidor",children:i.map(ue=>e.jsxs("option",{value:ue.id,children:[ue.name," - ",ue.phone]},ue.id))})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas adicionales"}),e.jsx(ks,{value:z,onChange:ue=>E(ue.target.value),placeholder:"Instrucciones especiales para el repartidor...",rows:3})]})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"outline",mr:3,onClick:R,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",onClick:de,children:"Asignar Repartidor"})]})]})]})},K=()=>{var x,ue,ie,ls,fs,js;return e.jsxs(Ve,{isOpen:p,onClose:b,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Detalles del Pedido"}),e.jsx(He,{}),e.jsx($e,{children:m&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsx(F,{variant:"outline",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Pedido:"}),e.jsx(n,{children:m.orderNumber})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Estado:"}),e.jsx(ye,{colorScheme:Ne(m.status),children:w(m.status)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Tipo:"}),e.jsx(n,{children:m.type==="regular"?"Cliente Frecuente":"Cliente Visitante"})]})]})})}),e.jsxs(F,{variant:"outline",children:[e.jsx(Pe,{children:e.jsx(Z,{size:"sm",children:"Cliente"})}),e.jsx(L,{children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Nombre:"}),e.jsx(n,{children:m.clientName||((x=m.client)==null?void 0:x.name)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Teléfono:"}),e.jsx(n,{children:m.clientPhone||((ue=m.client)==null?void 0:ue.phone)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Dirección:"}),e.jsx(n,{children:m.clientAddress||((ie=m.client)==null?void 0:ie.address)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Distrito:"}),e.jsx(n,{children:m.clientDistrict||((ls=m.client)==null?void 0:ls.district)})]})]})})]}),e.jsxs(F,{variant:"outline",children:[e.jsx(Pe,{children:e.jsx(Z,{size:"sm",children:"Pago"})}),e.jsx(L,{children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Método:"}),e.jsxs(h,{children:[e.jsx(ge,{as:Q(m.paymentType,m.paymentMethod),size:16}),e.jsx(n,{children:m.paymentMethod==="vale"?"A Crédito (Vale)":m.paymentMethod==="suscripcion"?"Suscripción":m.paymentMethod==="contraentrega"?m.paymentType==="plin"?"Contraentrega - PLIN":m.paymentType==="yape"?"Contraentrega - Yape":m.paymentType==="cash"?"Contraentrega - Efectivo":"Contraentrega":m.paymentType==="plin"?"PLIN":m.paymentType==="yape"?"Yape":(m.paymentType==="cash","Efectivo")})]})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Total:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["S/ ",parseFloat(m.total||m.totalAmount||0).toFixed(2)]})]})]})})]}),m.deliveryPersonId&&e.jsxs(F,{variant:"outline",children:[e.jsx(Pe,{children:e.jsx(Z,{size:"sm",children:"Repartidor"})}),e.jsx(L,{children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Nombre:"}),e.jsx(n,{children:(fs=i.find(Se=>Se.id===m.deliveryPersonId))==null?void 0:fs.name})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Teléfono:"}),e.jsx(n,{children:(js=i.find(Se=>Se.id===m.deliveryPersonId))==null?void 0:js.phone})]})]})})]}),m.notes&&e.jsxs(F,{variant:"outline",children:[e.jsx(Pe,{children:e.jsx(Z,{size:"sm",children:"Notas"})}),e.jsx(L,{children:e.jsx(n,{children:m.notes})})]})]})}),e.jsx(As,{children:e.jsx(O,{onClick:b,children:"Cerrar"})})]})]})},Ee=()=>e.jsxs(Ve,{isOpen:ae,onClose:B,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Confirmar Anulación"}),e.jsx(He,{}),e.jsx($e,{children:m&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(De,{status:"warning",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"¿Estás seguro de que deseas anular este pedido?"}),e.jsx(n,{fontSize:"sm",children:"Esta acción no se puede deshacer."})]})]}),e.jsx(F,{variant:"outline",p:3,children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Pedido:"}),e.jsxs(n,{children:["#",m.id]})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Cliente:"}),e.jsx(n,{children:m.clientName||"Sin nombre"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Estado actual:"}),e.jsx(ye,{colorScheme:Ne(m.status),children:w(m.status)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Total:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["S/ ",parseFloat(m.total||m.totalAmount||0).toFixed(2)]})]})]})})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"outline",mr:3,onClick:B,children:"Cancelar"}),e.jsx(O,{colorScheme:"red",onClick:me,children:"Sí, Anular Pedido"})]})]})]});return t?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsxs(k,{p:6,children:[e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(vs,{justify:"space-between",align:"center",children:[e.jsxs(k,{children:[e.jsx(Z,{size:"lg",mb:2,children:"Gestión de Pedidos"}),e.jsx(n,{color:"gray.600",children:"Administra y asigna repartidores a los pedidos"}),e.jsxs(n,{color:"gray.400",fontSize:"xs",children:["Última actualización: ",_.toLocaleTimeString()]})]}),e.jsx(O,{size:"sm",colorScheme:"blue",variant:"outline",onClick:()=>{r(),y(new Date)},isLoading:t,children:"Actualizar"})]}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(os,{columns:{base:1,md:4},spacing:4,children:[e.jsxs(U,{children:[e.jsx(G,{children:"Buscar"}),e.jsxs(Ct,{children:[e.jsx(kr,{children:e.jsx(Ua,{})}),e.jsx(re,{placeholder:"Buscar por pedido o cliente...",value:o,onChange:x=>c(x.target.value)})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Estado"}),e.jsxs(Je,{value:d,onChange:x=>f(x.target.value),children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"pending",children:"Pendiente"}),e.jsx("option",{value:"confirmed",children:"Asignado"}),e.jsx("option",{value:"preparing",children:"Preparando"}),e.jsx("option",{value:"ready",children:"Listo"}),e.jsx("option",{value:"delivered",children:"Entregado"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Pago"}),e.jsxs(Je,{value:P,onChange:x=>I(x.target.value),children:[e.jsx("option",{value:"all",children:"Todos los pagos"}),e.jsx("option",{value:"contraentrega",children:"Contraentrega"}),e.jsx("option",{value:"vale",children:"A Crédito (Vale)"}),e.jsx("option",{value:"suscripcion",children:"Suscripción"}),e.jsx("option",{value:"efectivo",children:"Efectivo"}),e.jsx("option",{value:"plin",children:"PLIN"})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Estadísticas"}),e.jsxs(u,{spacing:1,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",children:"Total:"}),e.jsx(ye,{colorScheme:"blue",children:xe.length})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",children:"Pendientes:"}),e.jsx(ye,{colorScheme:"orange",children:Ae.pending.length})]})]})]})]})})}),e.jsx(os,{columns:{base:1,md:2,lg:3},spacing:4,children:xe.map(W)}),xe.length===0&&e.jsx(is,{h:"200px",children:e.jsxs(u,{spacing:4,children:[e.jsx(n,{color:"gray.500",fontSize:"lg",children:"No hay pedidos que coincidan con los filtros"}),e.jsx(O,{variant:"outline",onClick:()=>{c(""),f("all"),I("all")},children:"Limpiar filtros"})]})})]}),Re(),K(),Ee()]})},Tl=({isOpen:s,onClose:t,onAccept:r,onReject:a,title:i="Términos y Condiciones",showAcceptance:l=!0})=>{const[o,c]=S.useState(null),[d,f]=S.useState(!1),[P,I]=S.useState(!1),[m,T]=S.useState(null),C=Ze("white","gray.800"),D=Ze("gray.700","gray.200"),_=Ze("gray.50","gray.700"),y=Ze("gray.200","gray.600"),z=async()=>{var R,p,H;try{f(!0),T(null),console.log("🔄 Cargando términos y condiciones activos...");const b=await as.get("/api/terms-and-conditions/active");console.log("📦 Respuesta términos activos:",b.data),c(b.data.data),console.log("✅ Términos cargados:",b.data.data?"Sí":"No")}catch(b){console.error("❌ Error fetching terms:",b),console.error("❌ Status:",(R=b.response)==null?void 0:R.status),console.error("❌ Message:",(H=(p=b.response)==null?void 0:p.data)==null?void 0:H.message),T("No se pudieron cargar los términos y condiciones")}finally{f(!1)}};S.useEffect(()=>{s&&z()},[s]);const E=()=>{P&&r&&r(o)},N=()=>{a?a():t()},$=R=>new Date(R).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(Ve,{isOpen:s,onClose:t,size:"xl",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{maxW:"800px",maxH:"90vh",bg:C,children:[e.jsx(Me,{children:e.jsxs(u,{align:"stretch",spacing:2,children:[e.jsx(n,{fontSize:"xl",fontWeight:"bold",color:"blue.600",children:i}),o&&e.jsxs(h,{justify:"space-between",children:[e.jsxs(ye,{colorScheme:"blue",variant:"subtle",children:["Versión ",o.version]}),e.jsxs(n,{fontSize:"sm",color:"gray.500",children:["Vigente desde: ",$(o.effectiveDate)]})]})]})}),e.jsxs($e,{overflowY:"auto",pb:4,children:[d&&e.jsx(is,{py:8,children:e.jsx(Ss,{size:"xl"})}),m&&e.jsxs(De,{status:"error",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsx(n,{children:m})]}),o&&!d&&e.jsxs(k,{children:[e.jsx(n,{fontSize:"lg",fontWeight:"semibold",mb:4,color:D,children:o.title}),e.jsx(hs,{mb:4}),e.jsx(k,{whiteSpace:"pre-wrap",fontSize:"sm",lineHeight:"1.6",color:D,maxH:"400px",overflowY:"auto",p:4,bg:_,borderRadius:"md",border:"1px solid",borderColor:y,children:o.content})]})]}),l&&o&&!d&&e.jsx(As,{children:e.jsxs(u,{w:"full",spacing:4,children:[e.jsx(Dn,{isChecked:P,onChange:R=>I(R.target.checked),colorScheme:"blue",size:"lg",children:e.jsx(n,{fontSize:"sm",children:"He leído y acepto los términos y condiciones"})}),e.jsxs(h,{w:"full",justify:"space-between",children:[e.jsx(O,{variant:"outline",onClick:N,colorScheme:"red",children:"Rechazar"}),e.jsx(O,{colorScheme:"blue",onClick:E,isDisabled:!P,children:"Aceptar"})]})]})}),!l&&e.jsx(As,{children:e.jsx(O,{onClick:t,colorScheme:"blue",children:"Cerrar"})})]})]})},Ur=pt((s,t)=>({districts:[],loading:!1,error:null,fetchDistricts:async()=>{var r,a,i,l;s({loading:!0,error:null});try{const o=await X.get("/api/districts"),c=o.data.success?o.data.data:o.data;return s({districts:c,loading:!1}),{success:!0,data:c}}catch(o){return console.error("Error al cargar distritos:",o),s({error:((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Error al cargar distritos",loading:!1}),{success:!1,error:((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al cargar distritos"}}},getDistrictById:r=>{const{districts:a}=t();return Array.isArray(a)?a.find(i=>i.id===r):null},getDistrictsByFee:r=>{const{districts:a}=t();return Array.isArray(a)?a.filter(i=>i.deliveryFee<=r):[]},updateDistrict:async(r,a)=>{var i,l,o,c;try{const d=await X.put(`/api/districts/${r}`,a),f=d.data.data||d.data;return s(P=>({districts:Array.isArray(P.districts)?P.districts.map(I=>I.id===r?f:I):[]})),{success:!0,data:f}}catch(d){return console.error("Error al actualizar distrito:",d),s({error:((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.message)||"Error al actualizar distrito"}),{success:!1,error:((c=(o=d.response)==null?void 0:o.data)==null?void 0:c.message)||"Error al actualizar distrito"}}},createDistrict:async r=>{var a,i,l,o;try{console.log("🔄 Creando distrito con datos:",r);const c=await X.post("/api/districts",r);console.log("📦 Respuesta del backend:",c.data);const d=c.data.data||c.data;return console.log("📦 Distrito procesado:",d),s(f=>{const P=[...Array.isArray(f.districts)?f.districts:[],d];return console.log("📦 Distritos actualizados en store:",P),{districts:P}}),{success:!0,data:d}}catch(c){return console.error("❌ Error al crear distrito:",c),s({error:((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.message)||"Error al crear distrito"}),{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Error al crear distrito"}}},clearError:()=>s({error:null})})),Pn="/assets/img_buyon-CC-6ZbJa.jpeg",Dl="/assets/img_paquete_botellas-nUXaTVFq.jpeg",Il="/assets/plin_qr-Mn7UEP9b.jpeg",_l=()=>{const s=tt(),t=ps();Hs({base:!0,md:!1});const{isOpen:r,onOpen:a,onClose:i}=Le(),l=()=>{i(),Ke(!1),ss(!1)},{products:o,fetchProducts:c,calculatePrice:d}=Sa(),{deliveryFees:f,fetchDeliveryFees:P}=er(),{districts:I,fetchDistricts:m}=Ur(),[T,C]=S.useState(1),[D,_]=S.useState(!1),[y,z]=S.useState(!1),[E,N]=S.useState([]),[$,R]=S.useState(!1),[p,H]=S.useState(null),[b,ae]=S.useState(null),[g,B]=S.useState(!1),[V,te]=S.useState(!1),[Ce,xe]=S.useState(!1),[Ae,Ne]=S.useState([]),[w,Q]=S.useState(!1),[ne,de]=S.useState(""),[A,me]=S.useState(null),[M,Y]=S.useState({name:"",phone:"",email:"",address:"",district:"",reference:"",notes:""}),[se,fe]=S.useState([]),[W,Re]=S.useState(new Set),[K,Ee]=S.useState("contraentrega"),[je,v]=S.useState("efectivo"),[we,Ke]=S.useState(!1),[gs,ss]=S.useState(!1),[Ue,x]=S.useState(!1),[ue,ie]=S.useState(!1),ls=j=>{const q=j.toLowerCase();return q.includes("bidón")||q.includes("bidon")||q.includes("garrafa")?Pn:q.includes("paquete")||q.includes("pack")||q.includes("botellas")?Dl:Pn};S.useEffect(()=>{c(),P(),m(),fs()},[c,P,m]);const fs=async()=>{try{Q(!0),console.log("🔄 Cargando planes de suscripción...");const j=await X.get("/api/subscription-plans");if(console.log("📦 Respuesta planes:",j.data),j.data.success){const q=j.data.data.map(J=>({id:J.id,name:J.name,bottles:J.totalBottles,price:parseFloat(J.monthlyPrice),bonus:J.bonusBottles,description:J.description,color:["blue","green","purple","orange","pink","teal","red"][J.sortOrder%7],popular:J.sortOrder===2,pricePerBottle:parseFloat(J.pricePerBottle),maxDailyDelivery:J.maxDailyDelivery}));console.log("✅ Planes transformados:",q),Ne(q)}}catch(j){console.error("❌ Error al cargar planes de suscripción:",j),t({title:"Error",description:"No se pudieron cargar los planes de suscripción",status:"error",duration:3e3,isClosable:!0})}finally{Q(!1)}},js=async j=>{try{console.log("🔄 Buscando suscripciones para DNI:",j);const q=await X.get(`/api/subscriptions/client/${j}`);return console.log("📦 Respuesta suscripciones:",q.data),q.data.success?(N(q.data.data),q.data.data):[]}catch(q){return console.error("❌ Error al buscar suscripciones:",q),[]}},Se=async j=>{var q;z(!0);try{const J=await X.get(`/api/clients/document/${j}`);if(J.data.success){const ee=J.data.data;me(ee.id),Y({...M,name:ee.name,phone:ee.phone,email:ee.email||"",address:ee.address,district:ee.district,reference:"",notes:""});const be=await js(j);try{const Be=await X.get(`/api/client-preferences/dni/${j}`);if(Be.data.success&&Be.data.data){const ve=Be.data.data;Ee(ve.preferredPaymentMethod),x(!0);const cs=new Date,ds=new Date(ve.validUntil);if(ds>cs)if(ie(!1),ve.preferredPaymentMethod==="suscripcion"){const rs=be.filter(Ls=>Ls.status==="active"&&Ls.remainingBottles>0);rs.length>0?(R(!0),H(rs[0]),t({title:"Suscripción activa encontrada",description:`Tienes ${rs[0].remainingBottles} bidones disponibles de tu suscripción`,status:"success",duration:5e3,isClosable:!0})):t({title:"Preferencia de suscripción activa",description:"Puedes comprar una nueva suscripción",status:"info",duration:5e3,isClosable:!0})}else t({title:"Modalidad activa encontrada",description:`Tu modalidad de ${ve.preferredPaymentMethod==="vale"?"vale":"suscripción"} está activa hasta ${ds.toLocaleDateString()}`,status:"info",duration:5e3,isClosable:!0});else x(!1),ie(!1),t({title:"Modalidad expirada",description:"Tu modalidad anterior expiró. Elige una nueva modalidad de pago.",status:"warning",duration:5e3,isClosable:!0})}}catch{console.log("No se encontraron preferencias para este cliente")}t({title:"Cliente encontrado",description:`Datos de ${ee.name} cargados automáticamente`,status:"success",duration:3e3,isClosable:!0}),C(3)}else t({title:"Cliente no encontrado",description:"Completa tus datos para registrarte automáticamente",status:"info",duration:5e3,isClosable:!0}),C(2)}catch(J){console.error("Error al buscar cliente:",J),((q=J.response)==null?void 0:q.status)===404?(t({title:"Cliente no encontrado",description:"Completa tus datos para registrarte automáticamente",status:"info",duration:5e3,isClosable:!0}),C(2)):(t({title:"Error al buscar cliente",description:"Intenta nuevamente o regístrate como nuevo cliente",status:"error",duration:5e3,isClosable:!0}),C(2))}finally{z(!1)}},Ts=j=>{j.preventDefault(),ne.length===8||ne.length===11?Se(ne):t({title:"Documento inválido",description:"El DNI debe tener 8 dígitos o el RUC debe tener 11 dígitos",status:"warning",duration:3e3,isClosable:!0})},Ca=async()=>{var j,q;try{if(_(!0),!ne||ne.trim()===""){t({title:"DNI requerido",description:"Debes ingresar tu DNI para registrarte",status:"warning",duration:3e3,isClosable:!0});return}const J={name:M.name,document:ne,phone:M.phone,email:M.email||"",address:M.address,district:M.district,reference:M.reference||"",notes:M.notes||"",status:"active"},ee=await X.post("/api/clients",J);if(ee.data.success){const be=ee.data.data.id;me(be),console.log("Cliente registrado con ID:",be),t({title:"¡Registro exitoso!",description:"Te has registrado automáticamente. Ahora puedes elegir productos y modalidades de pago",status:"success",duration:5e3,isClosable:!0}),C(3),setTimeout(()=>{console.log("ClientId después del registro:",be),console.log("ClientId en estado:",A)},100)}else throw new Error(ee.data.message||"Error al registrar")}catch(J){console.error("Error al registrar:",J),t({title:"Error al registrar",description:((q=(j=J.response)==null?void 0:j.data)==null?void 0:q.message)||"No se pudo completar el registro",status:"error",duration:5e3,isClosable:!0})}finally{_(!1)}},wa=async j=>{if(!W.has(j.id)){if($&&j.type!=="bidon"){t({title:"Solo bidones en suscripción",description:"Con tu suscripción solo puedes pedir bidones de agua",status:"warning",duration:3e3,isClosable:!0});return}Re(q=>new Set(q).add(j.id));try{let q;if($&&p){const ee=Ae.find(Be=>Be.name===p.subscriptionType),be=ee?parseFloat(ee.pricePerBottle):5;q={unitPrice:be,totalPrice:be,originalPrice:be,discountApplied:0,priceLevel:"subscription"}}else{const ee=await d(j.id,1);if(ee.success)q=ee.data;else throw new Error("Error al calcular precio")}const J=se.findIndex(ee=>ee.productId===j.id);if(J!==-1){const ee=[...se],be=ee[J].quantity+1;if($&&p){const Be=Ae.find(cs=>cs.name===p.subscriptionType),ve=Be?parseFloat(Be.pricePerBottle):5;ee[J].quantity=be,ee[J].unitPrice=ve,ee[J].subtotal=ve*be,ee[J].pricing={unitPrice:ve,totalPrice:ve*be,originalPrice:ve,discountApplied:0,priceLevel:"subscription"},fe(ee)}else{const Be=await d(j.id,be);if(Be.success){const ve=Be.data;ee[J].quantity=be,ee[J].unitPrice=parseFloat(ve.unitPrice),ee[J].subtotal=parseFloat(ve.unitPrice)*be,ee[J].pricing=ve,fe(ee)}}}else{const ee={id:`${j.id}-${Date.now()}`,productId:j.id,name:j.name,type:j.type,unitPrice:parseFloat(q.unitPrice),quantity:1,subtotal:parseFloat(q.unitPrice),pricing:q};fe([...se,ee])}t({title:"Producto agregado",description:`${j.name} agregado al carrito`,status:"success",duration:2e3,isClosable:!0})}catch(q){console.error("Error al calcular precio:",q)}finally{Re(q=>{const J=new Set(q);return J.delete(j.id),J})}}},At=async(j,q)=>{if(q<=0){fe(se.filter(J=>J.id!==j));return}try{const J=se.find(be=>be.id===j);if(!J)return;let ee;if($&&p){const be=Ae.find(ve=>ve.name===p.subscriptionType),Be=be?parseFloat(be.pricePerBottle):5;ee={unitPrice:Be,totalPrice:Be*q,originalPrice:Be,discountApplied:0,priceLevel:"subscription"}}else{const be=await d(J.productId,q);if(be.success)ee=be.data;else throw new Error("Error al calcular precio")}fe(se.map(be=>be.id===j?{...be,quantity:q,unitPrice:parseFloat(ee.unitPrice),subtotal:parseFloat(ee.unitPrice)*q,pricing:ee}:be))}catch(J){console.error("Error al actualizar cantidad:",J)}},za=(j,q)=>{const J=parseInt(q)||0;J>0?At(j,J):(q===""||q==="0")&&fe(se.map(ee=>ee.id===j?{...ee,quantity:0}:ee))},Pa=(j,q)=>{const J=parseInt(q)||0;J<=0?fe(se.filter(ee=>ee.id!==j)):At(j,J)},gt=()=>{if(!M.district)return 0;const j=I.find(q=>q.name===M.district);return j?parseFloat(j.deliveryFee):0},Et=()=>se.reduce((j,q)=>j+q.subtotal,0),Fs=()=>Et()+gt(),sr=async()=>{if(console.log("Estado antes de crear pedido:",{clientId:A,dni:ne,paymentMethod:K,selectedSubscriptionPlan:b,cart:se}),!A){t({title:"Cliente no registrado",description:"Debes registrarte como cliente para continuar",status:"error",duration:5e3,isClosable:!0}),C(2);return}if(K!=="suscripcion"&&se.length===0){t({title:"Carrito vacío",description:"Agrega al menos un producto al carrito",status:"warning",duration:3e3,isClosable:!0});return}if(K==="suscripcion"&&!b){t({title:"Plan no seleccionado",description:"Selecciona un plan de suscripción",status:"warning",duration:3e3,isClosable:!0});return}if(!M.name||!M.phone||!M.address||!M.district){t({title:"Datos incompletos",description:"Completa todos los campos obligatorios",status:"warning",duration:3e3,isClosable:!0});return}await tr()},Aa=async j=>{te(!0),xe(!1);try{await Yr(),t({title:"Términos aceptados",description:"Has aceptado los términos y condiciones",status:"success",duration:2e3,isClosable:!0})}catch(q){console.error("Error al crear pedido después de aceptar términos:",q),t({title:"Error",description:"Hubo un problema al crear el pedido",status:"error",duration:5e3,isClosable:!0})}},Ea=()=>{te(!1),xe(!1),t({title:"Términos rechazados",description:"Debes aceptar los términos y condiciones para continuar",status:"error",duration:3e3,isClosable:!0})},tr=async()=>{var j,q,J,ee,be,Be;if(!V&&K!=="suscripcion"){t({title:"Términos y Condiciones",description:"Debes aceptar los términos y condiciones para continuar",status:"warning",duration:3e3,isClosable:!0}),xe(!0);return}_(!0);try{if($&&p){const ve=se.reduce((ts,rs)=>{const Ls=o.find(nr=>nr.id===rs.productId);return Ls&&Ls.type==="bidon"?ts+rs.quantity:ts},0);if(p.remainingBottles<ve){t({title:"Bidones insuficientes",description:`Solo tienes ${p.remainingBottles} bidones disponibles. Necesitas ${ve} bidones.`,status:"error",duration:5e3,isClosable:!0});return}const cs={customerName:M.name,customerPhone:M.phone,customerEmail:M.email||"",deliveryAddress:M.address,deliveryDistrict:M.district,deliveryReference:M.reference||"",deliveryNotes:M.notes||"",products:se.map(ts=>({productId:ts.productId,quantity:ts.quantity,price:ts.unitPrice})),subtotal:Et(),deliveryFee:gt(),totalAmount:Fs(),paymentMethod:"suscripcion",paymentType:"cash",clientId:A,subscriptionId:p.id};console.log("Enviando pedido con suscripción:",cs);const ds=await X.post("/api/guest-orders",cs);if(ds.data.success){console.log("Datos para use-bottles:",{subscriptionId:p.id,bottlesToUse:ve,selectedSubscription:p}),console.log("🔍 Respuesta completa del pedido:",ds.data);const ts=((j=ds.data.data)==null?void 0:j.id)||ds.data.id||"Sin ID";t({title:"¡Pedido creado exitosamente!",description:`Pedido #${ts} registrado. Se usaron ${ve} bidones de tu suscripción.`,status:"success",duration:5e3,isClosable:!0});const rs=((q=ds.data.data)==null?void 0:q.accessToken)||ds.data.accessToken;rs?s(`/receipt/${rs}`):console.error("❌ No se encontró accessToken en la respuesta")}else throw new Error(ds.data.message||"Error al crear el pedido")}else if(K==="suscripcion"&&b)try{if(console.log("Datos para crear suscripción:",{clientId:A,dni:ne,selectedSubscriptionPlan:b}),!A)throw new Error("ClientId es requerido para crear suscripción");const ve={clientId:A,clientDni:ne,subscriptionType:b.id,totalBottles:b.bottles+b.bonus,totalAmount:b.price,paidAmount:b.price,expiryDate:null,notes:`Suscripción ${b.name} comprada`},cs=await X.post("/api/subscriptions",ve);if(console.log("Suscripción creada:",cs.data),cs.data.success){const ds=cs.data.data;try{const ts=new Date;ts.setMonth(ts.getMonth()+1);const rs={dni:ne,clientId:A,preferredPaymentMethod:"suscripcion",subscriptionPlanId:b.id,subscriptionAmount:b.price,subscriptionQuantity:b.bottles+b.bonus,validUntil:ts.toISOString()};await X.post("/api/client-preferences",rs),console.log("Preferencias de suscripción guardadas:",rs),t({title:"Modalidad guardada",description:`Tu modalidad de suscripción estará activa hasta ${ts.toLocaleDateString()}`,status:"success",duration:4e3,isClosable:!0})}catch(ts){console.log("Error al guardar preferencias de suscripción:",ts)}t({title:"🎉 ¡Suscripción activada!",description:`Tu suscripción ${b.name} está lista. Ahora puedes hacer pedidos usando tus ${b.bottles+b.bonus} bidones disponibles (sin costo adicional).`,status:"success",duration:8e3,isClosable:!0}),R(!0),H({id:ds.id,subscriptionType:b.name,totalBottles:b.bottles+b.bonus,remainingBottles:b.bottles+b.bonus,totalAmount:b.price,status:"active"}),je==="plin"?(C(5),Ke(!0),ss(!1),a()):(fe([]),C(3),t({title:"¡Ahora puedes hacer pedidos!",description:`Tienes ${b.bottles+b.bonus} bidones disponibles. Agrega productos al carrito.`,status:"info",duration:6e3,isClosable:!0}))}}catch(ve){throw console.log("Error al crear suscripción:",ve),ve}else{const ve={customerName:M.name,customerPhone:M.phone,customerEmail:M.email||"",deliveryAddress:M.address,deliveryDistrict:M.district,deliveryReference:M.reference||"",deliveryNotes:M.notes||"",products:se.map(ds=>({productId:ds.productId,quantity:ds.quantity,price:ds.unitPrice})),subtotal:Et(),deliveryFee:gt(),totalAmount:Fs(),paymentMethod:K,paymentType:je==="efectivo"?"cash":je,clientId:A};console.log("Enviando pedido:",ve),console.log("ClientId actual:",A);const cs=await X.post("/api/guest-orders",ve);if(cs.data.success){if(K==="vale"||K==="suscripcion")try{if(A){const rs=new Date;rs.setMonth(rs.getMonth()+1);const Ls={dni:ne,clientId:A,preferredPaymentMethod:K,subscriptionPlanId:K==="suscripcion"?b==null?void 0:b.id:null,subscriptionAmount:K==="suscripcion"?Fs():null,subscriptionQuantity:K==="suscripcion"?se.reduce((nr,Fa)=>nr+Fa.quantity,0):null,validUntil:rs.toISOString()};await X.post("/api/client-preferences",Ls),console.log("Preferencias guardadas:",Ls),t({title:"Modalidad guardada",description:`Tu modalidad de ${K==="vale"?"vale":"suscripción"} estará activa hasta ${rs.toLocaleDateString()}`,status:"success",duration:4e3,isClosable:!0})}}catch(rs){console.log("Error al guardar preferencias:",rs)}console.log("🔍 Respuesta completa del pedido normal:",cs.data);const ds=((J=cs.data.data)==null?void 0:J.id)||cs.data.id||"Sin ID";t({title:"¡Pedido creado exitosamente!",description:`Pedido #${ds} registrado correctamente`,status:"success",duration:5e3,isClosable:!0});const ts=((ee=cs.data.data)==null?void 0:ee.accessToken)||cs.data.accessToken;ts?s(`/receipt/${ts}`):console.error("❌ No se encontró accessToken en la respuesta")}else throw new Error(cs.data.message||"Error al crear el pedido")}}catch(ve){console.error("Error al crear pedido:",ve),t({title:"Error al crear pedido",description:((Be=(be=ve.response)==null?void 0:be.data)==null?void 0:Be.message)||"Error interno del servidor",status:"error",duration:5e3,isClosable:!0})}finally{_(!1)}},Gr=()=>{Ke(!0),ss(!1),a()},rr=async j=>{var q,J;try{if(!b||!A||!ne)throw new Error("Plan de suscripción, cliente o DNI no seleccionado");console.log("🔄 Creando suscripción con datos:",{clientDni:ne,subscriptionType:b.name,totalBottles:b.bottles+b.bonus,totalAmount:b.price});const ee={clientDni:ne,subscriptionType:b.name,totalBottles:b.bottles+b.bonus,totalAmount:b.price,paidAmount:b.price,notes:`Plan ${b.name} - ${b.bottles+b.bonus} bidones`},be=await X.post("/api/subscriptions",ee);if(be.data.success){const Be=be.data.data;console.log("✅ Suscripción creada:",Be),H({id:Be.id,subscriptionType:b.name,totalBottles:b.bottles+b.bonus,remainingBottles:b.bottles+b.bonus,totalAmount:b.price,status:"active"}),R(!0),Ee("suscripcion"),te(!1),fe([]),C(3),i(),Ke(!1),ss(!1),t({title:"¡Suscripción creada exitosamente!",description:`Tienes ${b.bottles+b.bonus} bidones disponibles. Agrega productos al carrito.`,status:"success",duration:6e3,isClosable:!0})}}catch(ee){throw console.error("❌ Error al crear suscripción:",ee),t({title:"Error al crear suscripción",description:((J=(q=ee.response)==null?void 0:q.data)==null?void 0:J.message)||"No se pudo crear la suscripción. Inténtalo de nuevo.",status:"error",duration:5e3,isClosable:!0}),ee}},Yr=async()=>{try{K==="suscripcion"&&b?(fe([]),C(3),i(),Ke(!1),ss(!1),t({title:"¡Pago confirmado!",description:`Tu suscripción ${b.name} está activa. Ahora puedes hacer pedidos usando tus ${b.bottles+b.bonus} bidones disponibles.`,status:"success",duration:8e3,isClosable:!0})):(await tr(),i(),Ke(!1),ss(!1))}catch(j){console.error("Error al confirmar pago PLIN:",j),t({title:"Error",description:"Hubo un problema al confirmar el pago",status:"error",duration:5e3,isClosable:!0})}},Ta=()=>{let j=`🧾 *COMPROBANTE DE PAGO PLIN*
    
👤 Cliente: ${M.name}
📱 Teléfono: ${M.phone}
🏠 Dirección: ${M.address}
📍 Distrito: ${M.district}

`;K==="suscripcion"&&b?j+=`🎯 *SUSCRIPCIÓN:*
📦 Plan: ${b.name}
💰 Precio: S/ ${b.price}
🔢 Bidones: ${b.bottles} + ${b.bonus} extra
📊 Total bidones: ${b.bottles+b.bonus}

✅ *PAGO REALIZADO VÍA PLIN*`:j+=`🛒 *PEDIDO:*
${se.map(J=>`• ${J.name} x${J.quantity} = S/ ${J.subtotal.toFixed(2)}`).join(`
`)}

💰 *TOTAL: S/ ${Fs().toFixed(2)}*
📦 Flete: S/ ${gt().toFixed(2)}

✅ *PAGO REALIZADO VÍA PLIN*`;const q=`https://wa.me/51961606183?text=${encodeURIComponent(j)}`;window.open(q,"_blank"),ss(!0),t({title:"WhatsApp abierto",description:"Envía el comprobante y luego confirma el pago",status:"info",duration:3e3,isClosable:!0})},Xr=j=>{switch(j){case"bidon":return"blue";case"botella":return"green";default:return"gray"}},Qr=j=>{switch(j){case"bidon":return"Bidón";case"botella":return"Botella";default:return j}},Da=()=>e.jsxs(F,{maxW:{base:"100%",sm:"md"},mx:"auto",w:"100%",children:[e.jsx(Pe,{textAlign:"center",p:{base:4,md:6},children:e.jsxs(u,{spacing:{base:3,md:4},children:[e.jsx(ge,{as:Yn,boxSize:{base:8,md:12},color:"blue.500"}),e.jsx(Z,{size:{base:"md",md:"lg"},children:"Ingresa tu DNI"}),e.jsx(n,{color:"gray.600",fontSize:{base:"sm",md:"md"},textAlign:"center",children:"Buscaremos tus datos automáticamente para agilizar tu pedido"})]})}),e.jsx(L,{p:{base:4,md:6},children:e.jsx("form",{onSubmit:Ts,children:e.jsxs(u,{spacing:{base:3,md:4},children:[e.jsxs(U,{children:[e.jsx(G,{fontSize:{base:"sm",md:"md"},children:"Número de Documento (DNI o RUC)"}),e.jsx(re,{value:ne,onChange:j=>de(j.target.value),placeholder:"12345678 (DNI) o 12345678901 (RUC)",size:{base:"md",md:"lg"},textAlign:"center",fontSize:{base:"md",md:"xl"},fontWeight:"bold",maxLength:11})]}),e.jsx(O,{type:"submit",colorScheme:"blue",size:{base:"md",md:"lg"},w:"full",isLoading:y,loadingText:"Buscando...",leftIcon:e.jsx(qs,{}),children:"Buscar Cliente"}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>C(2),children:"Completar datos manualmente"})]})})})]}),Ia=()=>e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{children:e.jsxs(Z,{size:"md",children:[e.jsx(qs,{style:{display:"inline",marginRight:"8px"}}),"Datos del Cliente"]})}),e.jsx(L,{children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Documento"}),e.jsx(re,{value:ne,isDisabled:!0,placeholder:"Tu documento",bg:"gray.100"}),e.jsx(Ga,{children:"Documento ingresado en el paso anterior"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre Completo"}),e.jsx(re,{value:M.name,onChange:j=>Y({...M,name:j.target.value}),placeholder:"Tu nombre completo"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Teléfono"}),e.jsx(re,{value:M.phone,onChange:j=>Y({...M,phone:j.target.value}),placeholder:"Tu número de teléfono"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Email (opcional)"}),e.jsx(re,{type:"email",value:M.email,onChange:j=>Y({...M,email:j.target.value}),placeholder:"Tu correo electrónico"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Dirección"}),e.jsx(ks,{value:M.address,onChange:j=>Y({...M,address:j.target.value}),placeholder:"Dirección completa de entrega",rows:3})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Distrito"}),e.jsx(Je,{value:M.district,onChange:j=>Y({...M,district:j.target.value}),placeholder:"Selecciona tu distrito",children:Array.isArray(I)?I.map(j=>e.jsxs("option",{value:j.name,children:[j.name," - S/ ",parseFloat(j.deliveryFee).toFixed(2)]},j.id)):null})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Referencia"}),e.jsx(re,{value:M.reference,onChange:j=>Y({...M,reference:j.target.value}),placeholder:"Referencia del lugar (opcional)"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas Adicionales"}),e.jsx(ks,{value:M.notes,onChange:j=>Y({...M,notes:j.target.value}),placeholder:"Información adicional, preferencias especiales, etc. (opcional)",rows:3})]}),e.jsxs(u,{spacing:3,w:"full",children:[e.jsx(O,{colorScheme:"blue",size:"lg",w:"full",onClick:Ca,isDisabled:!M.name||!M.phone||!M.address||!M.district,children:"Registrarme y Continuar"}),e.jsxs(De,{status:"info",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontSize:"sm",fontWeight:"bold",children:"Registro Automático"}),e.jsx(n,{fontSize:"xs",children:"Al continuar, te registrarás automáticamente como cliente para acceder a beneficios especiales como vales y suscripciones."})]})]})]})]})})]}),_a=()=>e.jsxs(u,{spacing:6,w:"full",children:[e.jsxs(F,{w:"full",children:[e.jsxs(Pe,{children:[e.jsxs(Z,{size:"md",children:[e.jsx(cr,{style:{display:"inline",marginRight:"8px"}}),$?"Bidones Disponibles (Suscripción)":"Productos Disponibles"]}),$&&e.jsxs(De,{status:"info",size:"sm",borderRadius:"md",mt:2,children:[e.jsx(Ie,{}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Modo Suscripción:"})," Solo puedes pedir bidones de agua. Los bidones se descontarán de tu suscripción sin costo adicional."]})]})]}),e.jsx(L,{children:e.jsx(os,{columns:{base:1,md:2},spacing:4,children:o.filter(j=>!$||j.type==="bidon").map(j=>e.jsx(F,{variant:"outline",children:e.jsx(L,{children:e.jsxs(u,{align:"start",spacing:3,children:[e.jsxs(h,{spacing:4,align:"start",w:"full",children:[e.jsx(k,{flexShrink:0,children:e.jsx(It,{src:ls(j.name),alt:j.name,boxSize:"80px",objectFit:"cover",borderRadius:"md",border:"2px solid #e2e8f0"})}),e.jsx(u,{align:"start",spacing:1,flex:1,children:e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:j.name}),e.jsx(n,{color:"gray.600",fontSize:"sm",children:j.description}),j.name==="Paquete de Botellas de Agua"&&e.jsx(ye,{colorScheme:"green",size:"sm",children:"¡50+ unidades = S/ 9.00 c/u!"})]}),e.jsx(ye,{colorScheme:Xr(j.type),children:Qr(j.type)})]})})]}),e.jsxs(h,{spacing:4,children:[e.jsxs(n,{fontWeight:"bold",color:"blue.600",fontSize:"lg",children:["S/ ",parseFloat(j.unitPrice).toFixed(2)]}),e.jsxs(n,{color:"gray.500",fontSize:"sm",children:["Stock: ",j.stock]})]}),e.jsx(O,{colorScheme:"blue",size:"sm",leftIcon:e.jsx(cr,{}),onClick:()=>wa(j),isLoading:W.has(j.id),loadingText:"Agregando...",w:"full",children:"Agregar al Carrito"})]})})},j.id))})})]}),se.length>0&&e.jsxs(F,{w:"full",children:[e.jsx(Pe,{children:e.jsxs(Z,{size:"md",children:[e.jsx(cr,{style:{display:"inline",marginRight:"8px"}}),"Tu Carrito (",se.length," ",se.length===1?"producto":"productos",")"]})}),e.jsx(L,{children:e.jsxs(u,{spacing:4,children:[se.map(j=>{var q;return e.jsx(k,{w:"full",p:3,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs(h,{spacing:3,align:"start",children:[e.jsx(It,{src:ls(j.name),alt:j.name,boxSize:"50px",objectFit:"cover",borderRadius:"md",border:"1px solid #e2e8f0"}),e.jsxs(u,{spacing:2,flex:1,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:j.name}),e.jsx(ye,{colorScheme:Xr(j.type),children:Qr(j.type)})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(u,{align:"start",spacing:0,children:[e.jsxs(n,{color:"gray.600",fontSize:"sm",children:["S/ ",parseFloat(j.unitPrice).toFixed(2)," c/u"]}),((q=j.pricing)==null?void 0:q.priceLevel)==="especial50"&&e.jsx(ye,{colorScheme:"green",size:"sm",children:"¡Descuento 50+ unidades!"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(O,{size:"sm",onClick:()=>At(j.id,j.quantity-1),children:"-"}),e.jsx(re,{value:j.quantity,onChange:J=>za(j.id,J.target.value),onBlur:J=>Pa(j.id,J.target.value),size:"sm",w:"60px",textAlign:"center",type:"number",min:"0",placeholder:"0"}),e.jsx(O,{size:"sm",onClick:()=>At(j.id,j.quantity+1),children:"+"})]})]}),e.jsx(h,{justify:"space-between",w:"full",children:e.jsxs(n,{fontWeight:"bold",color:"blue.600",children:["Subtotal: S/ ",parseFloat(j.subtotal).toFixed(2)]})})]})]})},j.id)}),e.jsx(hs,{}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Subtotal:"}),e.jsxs(n,{fontWeight:"bold",children:["S/ ",parseFloat(Et()).toFixed(2)]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Flete:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["S/ ",parseFloat(gt()).toFixed(2)]})]}),e.jsx(hs,{}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Total:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"blue.600",children:["S/ ",parseFloat(Fs()).toFixed(2)]})]})]}),e.jsx(O,{colorScheme:"green",size:"lg",w:"full",onClick:()=>{C($&&p?5:4)},leftIcon:e.jsx(ws,{}),children:$&&p?"Continuar con Confirmación":"Continuar con Modalidad"})]})})]})]}),ka=()=>$&&p?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:_s,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Usar Suscripción"}),e.jsxs(n,{color:"gray.600",textAlign:"center",children:["Tienes ",p.remainingBottles," bidones disponibles de tu suscripción"]}),e.jsxs(De,{status:"success",size:"sm",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Suscripción activa:"})," ",p.remainingBottles," bidones disponibles"]})]})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsx(F,{variant:"filled",borderColor:"purple.500",bg:"purple.50",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:"Tipo de Suscripción:"}),e.jsx(n,{children:p.subscriptionType||"N/A"})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:"Bidones Totales:"}),e.jsx(n,{children:p.totalBottles||0})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:"Bidones Restantes:"}),e.jsx(n,{color:"green.600",fontWeight:"bold",children:p.remainingBottles||0})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:"Total Pagado:"}),e.jsxs(n,{children:["S/ ",p.totalAmount?parseFloat(p.totalAmount).toFixed(2):"0.00"]})]})]})})}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Resumen del Pedido"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(u,{spacing:1,w:"full",align:"stretch",children:[e.jsx(n,{children:"Productos:"}),se.map((j,q)=>e.jsxs(h,{justify:"space-between",w:"full",pl:2,children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["• ",j.name," x",j.quantity]}),e.jsxs(n,{fontSize:"sm",fontWeight:"bold",children:["S/ ",parseFloat(j.subtotal).toFixed(2)]})]},q))]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total Bidones:"}),e.jsxs(n,{fontWeight:"bold",color:"purple.600",children:[se.reduce((j,q)=>j+q.quantity,0)," bidones"]})]})]})]})})}),e.jsx(O,{colorScheme:"purple",size:"lg",w:"full",onClick:()=>C(5),leftIcon:e.jsx(Ps,{}),children:"Usar Suscripción (Sin Pago)"})]})})]}):Ue&&!ue?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:ys,boxSize:12,color:"green.500"}),e.jsx(Z,{size:"lg",children:"Modalidad de Pago"}),e.jsx(n,{color:"gray.600",textAlign:"center",children:"Tu modalidad de pago está activa este mes"}),e.jsxs(De,{status:"success",size:"sm",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Modalidad activa:"})," ",K==="vale"?"A Crédito (Vale)":K==="suscripcion"?"Suscripción Mensual":"Contraentrega"]})]})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsx(F,{variant:"filled",borderColor:"blue.500",bg:"blue.50",children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(Ws,{value:K,isChecked:!0}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:K==="vale"?"A Crédito (Vale)":K==="suscripcion"?"Suscripción con Beneficios":"Contraentrega"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:K==="vale"?"Paga al final del mes - Se anota en tu vale":K==="suscripcion"?"Pedido recurrente mensual con bidones extra":"Pagas en efectivo o PLIN cuando recibes tu pedido"})]})]})})}),e.jsx(O,{colorScheme:"blue",size:"lg",w:"full",onClick:()=>{K==="suscripcion"?(R(!0),C(3)):C(5)},leftIcon:e.jsx(Bs,{}),children:K==="vale"?"Continuar (Sin Pago Inmediato)":"Continuar con Forma de Pago"})]})})]}):K==="suscripcion"&&!b?(console.log("Mostrando planes de suscripción. Estado actual:",{clientId:A,dni:ne,paymentMethod:K,selectedSubscriptionPlan:b,isSubscriptionMode:$}),$||R(!0),A?e.jsxs(F,{maxW:"4xl",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:_s,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Elige tu Plan de Suscripción"}),e.jsx(n,{color:"gray.600",textAlign:"center",children:"Selecciona el plan que mejor se adapte a tus necesidades"}),e.jsxs(De,{status:"info",size:"sm",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(n,{fontSize:"sm",children:[e.jsx("strong",{children:"Beneficios de la suscripción:"})," Paga una vez al mes y recibe bidones extra gratis. Después solo pides la cantidad que necesites sin pagar nada más."]})]})]})}),e.jsxs(L,{children:[w?e.jsx(is,{py:8,children:e.jsxs(u,{spacing:4,children:[e.jsx(Ss,{size:"xl",color:"blue.500"}),e.jsx(n,{color:"gray.500",children:"Cargando planes de suscripción..."})]})}):e.jsx(os,{columns:{base:1,md:3},spacing:6,children:Ae.map(j=>e.jsxs(F,{variant:(b==null?void 0:b.id)===j.id?"filled":"outline",borderColor:(b==null?void 0:b.id)===j.id?`${j.color}.500`:"gray.200",cursor:"pointer",onClick:()=>ae(j),position:"relative",_hover:{transform:"translateY(-2px)",shadow:"lg"},transition:"all 0.2s",children:[j.popular&&e.jsx(ye,{position:"absolute",top:-2,right:4,colorScheme:j.color,variant:"solid",borderRadius:"full",px:3,py:1,children:"Más Popular"}),e.jsx(L,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:2,children:[e.jsx(n,{fontWeight:"bold",fontSize:"xl",color:`${j.color}.600`,children:j.name}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:j.description})]}),e.jsxs(u,{spacing:1,children:[e.jsxs(n,{fontSize:"3xl",fontWeight:"bold",color:`${j.color}.500`,children:["S/ ",j.price]}),e.jsx(n,{fontSize:"sm",color:"gray.500",children:"por mes"})]}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",children:"Bidones incluidos:"}),e.jsx(n,{fontWeight:"bold",children:j.bottles})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",children:"Bidones extra:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["+",j.bonus]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",children:"Total bidones:"}),e.jsx(n,{fontWeight:"bold",color:`${j.color}.600`,children:j.bottles+j.bonus})]})]}),e.jsx(O,{colorScheme:j.color,variant:(b==null?void 0:b.id)===j.id?"solid":"outline",w:"full",size:"sm",children:(b==null?void 0:b.id)===j.id?"Seleccionado":"Seleccionar"})]})})]},j.id))}),e.jsxs(u,{spacing:4,mt:6,children:[e.jsx(O,{colorScheme:"purple",size:"lg",w:"full",onClick:async()=>{if(b)try{await rr("efectivo")}catch(j){console.error("Error al crear suscripción:",j),t({title:"Error",description:"No se pudo crear la suscripción. Inténtalo de nuevo.",status:"error",duration:5e3,isClosable:!0})}else C(5)},leftIcon:e.jsx(Bs,{}),isDisabled:!b,children:"Continuar con Forma de Pago"}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>{Ee("contraentrega"),R(!1)},children:"Cambiar a Contraentrega"})]})]})]}):e.jsx(F,{maxW:"lg",mx:"auto",children:e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:to,boxSize:12,color:"red.500"}),e.jsx(Z,{size:"lg",color:"red.500",children:"Error de Cliente"}),e.jsx(n,{color:"gray.600",textAlign:"center",children:"No se pudo identificar al cliente. Por favor, regístrate nuevamente."}),e.jsx(O,{colorScheme:"blue",onClick:()=>C(2),children:"Volver al Registro"})]})})})):e.jsxs(F,{maxW:{base:"100%",sm:"lg"},mx:"auto",w:"100%",children:[e.jsx(Pe,{textAlign:"center",p:{base:4,md:6},children:e.jsxs(u,{spacing:{base:3,md:4},children:[e.jsx(ge,{as:ys,boxSize:{base:10,md:12},color:"green.500"}),e.jsx(Z,{size:{base:"md",md:"lg"},children:"Modalidad de Pago"}),e.jsx(n,{color:"gray.600",textAlign:"center",fontSize:{base:"sm",md:"md"},children:Ue?"Tu modalidad anterior expiró. Elige una nueva modalidad:":"Selecciona cómo deseas pagar tu pedido"}),e.jsxs(De,{status:Ue?"warning":"info",size:"sm",borderRadius:"md",w:"100%",children:[e.jsx(Ie,{}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},children:Ue?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Modalidad expirada:"})," Tu modalidad anterior ya no está activa. Elige una nueva modalidad de pago para este mes."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Contraentrega:"})," Pagas cuando recibes el pedido",e.jsx("br",{}),e.jsx("strong",{children:"A Crédito:"})," Se anota en tu vale y pagas al final del mes",e.jsx("br",{}),e.jsx("strong",{children:"Suscripción:"})," Pedido recurrente mensual"]})})]})]})}),e.jsx(L,{p:{base:4,md:6},children:e.jsxs(u,{spacing:{base:4,md:6},w:"100%",children:[e.jsx(ar,{value:K,onChange:j=>{Ee(j),j==="suscripcion"?p?R(!0):(R(!1),C(4)):R(!1)},w:"100%",children:e.jsxs(ir,{spacing:{base:3,md:4},w:"100%",children:[e.jsx(F,{variant:K==="contraentrega"?"filled":"outline",borderColor:K==="contraentrega"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>{Ee("contraentrega"),R(!1)},w:"100%",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(h,{spacing:{base:3,md:4},w:"100%",children:[e.jsx(Ws,{value:"contraentrega",flexShrink:0}),e.jsxs(u,{align:"start",spacing:1,flex:1,minW:0,children:[e.jsx(n,{fontWeight:"bold",fontSize:{base:"sm",md:"md"},children:"Contraentrega"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},color:"gray.600",noOfLines:2,children:"Pagas en efectivo o PLIN cuando recibes tu pedido"})]})]})})}),e.jsx(F,{variant:K==="vale"?"filled":"outline",borderColor:K==="vale"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>{Ee("vale"),R(!1)},w:"100%",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(h,{spacing:{base:3,md:4},w:"100%",children:[e.jsx(Ws,{value:"vale",flexShrink:0}),e.jsxs(u,{align:"start",spacing:1,flex:1,minW:0,children:[e.jsx(n,{fontWeight:"bold",fontSize:{base:"sm",md:"md"},children:"A Crédito (Vale)"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},color:"gray.600",noOfLines:2,children:"Paga al final del mes - Se anota en tu vale"})]})]})})}),e.jsx(F,{variant:K==="suscripcion"?"filled":"outline",borderColor:K==="suscripcion"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>{Ee("suscripcion"),p?R(!0):(R(!1),C(4))},w:"100%",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(h,{spacing:{base:3,md:4},w:"100%",align:"start",children:[e.jsx(Ws,{value:"suscripcion",flexShrink:0,mt:1}),e.jsx(u,{align:"start",spacing:1,flex:1,minW:0,children:e.jsx(n,{fontWeight:"bold",fontSize:{base:"sm",md:"md"},children:"Suscripción con Beneficios"})})]})})})]})}),e.jsx(O,{colorScheme:"blue",size:"lg",w:"full",onClick:()=>C(5),leftIcon:e.jsx(Bs,{}),children:K==="vale"?"Continuar (Sin Pago Inmediato)":"Continuar con Forma de Pago"})]})})]}),Na=()=>K==="suscripcion"&&b&&!p?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:Wr,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Confirmar Suscripción"}),e.jsx(n,{color:"gray.600",children:"Revisa los detalles de tu plan de suscripción"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsx(F,{variant:"outline",w:"full",borderColor:"purple.200",children:e.jsx(L,{children:e.jsxs(u,{spacing:4,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:b.name}),e.jsx(n,{fontSize:"sm",color:"gray.600",textAlign:"center",children:b.description}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Bidones incluidos:"}),e.jsx(n,{fontWeight:"bold",children:b.bottles})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Bidones extra:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["+",b.bonus]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total bidones:"}),e.jsx(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:b.bottles+b.bonus})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Precio por bidón:"}),e.jsxs(n,{fontWeight:"bold",children:["S/ ",parseFloat(b.pricePerBottle).toFixed(2)]})]}),e.jsx(hs,{}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"lg",fontWeight:"bold",children:"Total a pagar:"}),e.jsxs(n,{fontSize:"xl",fontWeight:"bold",color:"purple.600",children:["S/ ",parseFloat(b.price).toFixed(2)]})]})]})]})})}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Datos del Cliente"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Nombre:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"DNI:"}),e.jsx(n,{fontWeight:"bold",children:ne})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Teléfono:"}),e.jsx(n,{fontWeight:"bold",children:M.phone})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Email:"}),e.jsx(n,{fontWeight:"bold",children:M.email})]})]})]})})}),e.jsxs(De,{status:"info",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"Cómo funciona la suscripción:"}),e.jsxs(n,{fontSize:"sm",children:["• Pagas una vez al mes por adelantado",e.jsx("br",{}),"• Recibes ",b.bottles+b.bonus," bidones inmediatamente",e.jsx("br",{}),"• Después solo pides la cantidad que necesites sin pagar",e.jsx("br",{}),"• Los bidones se descuentan de tu suscripción"]})]})]}),e.jsx(O,{colorScheme:"purple",size:"lg",w:"full",onClick:()=>C(6),leftIcon:e.jsx(Bs,{}),children:"Proceder al Pago"})]})})]}):$&&p?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:_s,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Confirmar Pedido con Suscripción"}),e.jsx(n,{color:"gray.600",children:"Usarás bidones de tu suscripción existente"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(De,{status:"info",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"Cómo funciona con suscripción:"}),e.jsxs(n,{fontSize:"sm",children:["• Se descontarán ",se.reduce((j,q)=>{const J=o.find(ee=>ee.id===q.productId);return J&&J.type==="bidon"?j+q.quantity:j},0)," bidones de tu suscripción",e.jsx("br",{}),"• El repartidor NO cobrará nada en la entrega",e.jsx("br",{}),"• Los bidones se descontarán automáticamente",e.jsx("br",{}),"• Quedarán ",p.remainingBottles-se.reduce((j,q)=>{const J=o.find(ee=>ee.id===q.productId);return J&&J.type==="bidon"?j+q.quantity:j},0)," bidones disponibles"]})]})]}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Resumen del Pedido"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Modalidad:"}),e.jsx(ye,{colorScheme:"purple",children:"Suscripción (Sin Pago)"})]}),e.jsxs(u,{spacing:1,w:"full",align:"stretch",children:[e.jsx(n,{children:"Productos:"}),se.map((j,q)=>e.jsxs(h,{justify:"space-between",w:"full",pl:2,children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["• ",j.name," x",j.quantity]}),e.jsxs(n,{fontSize:"sm",fontWeight:"bold",children:["S/ ",parseFloat(j.subtotal).toFixed(2)]})]},q))]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Bidones a usar:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:[se.reduce((j,q)=>j+q.quantity,0)," bidones"]})]})]})]})})}),e.jsx(O,{colorScheme:"purple",size:"lg",w:"full",onClick:tr,leftIcon:e.jsx(Ps,{}),isLoading:D,loadingText:"Creando pedido...",children:"Confirmar Pedido con Suscripción"})]})})]}):K==="vale"?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:ys,boxSize:12,color:"orange.500"}),e.jsx(Z,{size:"lg",children:"Pago a Crédito"}),e.jsx(n,{color:"gray.600",children:"Tu pedido se anotará en tu vale de crédito"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(De,{status:"info",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"Cómo funciona el pago a crédito:"}),e.jsxs(n,{fontSize:"sm",children:["• Tu pedido se anotará automáticamente en tu vale",e.jsx("br",{}),"• El reya tiene su cpartidor NO cobrará nada en la entrega",e.jsx("br",{}),"• Debes pagar todos tus vales al final del mes",e.jsx("br",{}),"• Puedes pagar en efectivo o PLIN cuando sea el momento"]})]})]}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Resumen del Pedido"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Modalidad:"}),e.jsx(ye,{colorScheme:"orange",children:"A Crédito (Vale)"})]}),e.jsxs(u,{spacing:1,w:"full",align:"stretch",children:[e.jsx(n,{children:"Productos:"}),se.map((j,q)=>e.jsxs(h,{justify:"space-between",w:"full",pl:2,children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["• ",j.name," x",j.quantity]}),e.jsxs(n,{fontSize:"sm",fontWeight:"bold",children:["S/ ",parseFloat(j.subtotal).toFixed(2)]})]},q))]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"orange.600",children:["S/ ",parseFloat(Fs()).toFixed(2)," (A Crédito)"]})]})]})]})})}),e.jsx(O,{colorScheme:"orange",size:"lg",w:"full",onClick:sr,leftIcon:e.jsx(Ps,{}),isLoading:D,loadingText:"Creando pedido...",children:"Confirmar Pedido a Crédito"})]})})]}):K==="suscripcion"&&b?e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:_s,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Confirmar Suscripción"}),e.jsxs(n,{color:"gray.600",children:["Plan ",b.name," seleccionado"]})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(De,{status:"info",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"Cómo funciona la suscripción:"}),e.jsxs(n,{fontSize:"sm",children:["• Pagas una vez al mes por adelantado",e.jsx("br",{}),"• Recibes ",b.bottles+b.bonus," bidones inmediatamente",e.jsx("br",{}),"• Después solo pides la cantidad que necesites sin pagar",e.jsx("br",{}),"• Los bidones se descuentan de tu suscripción"]})]})]}),e.jsx(F,{variant:"outline",w:"full",borderColor:"purple.200",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:b.name}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Precio del plan:"}),e.jsxs(n,{fontWeight:"bold",color:"purple.600",children:["S/ ",b.price]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Bidones incluidos:"}),e.jsx(n,{fontWeight:"bold",children:b.bottles})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Bidones extra:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["+",b.bonus]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total bidones:"}),e.jsx(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:b.bottles+b.bonus})]})]})]})})}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Resumen del Pedido"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Modalidad:"}),e.jsxs(ye,{colorScheme:"purple",children:["Suscripción ",b.name]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total a pagar:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:["S/ ",b.monthlyPrice]})]})]})]})})}),e.jsxs(u,{spacing:4,w:"full",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"¿Cómo deseas pagar?"}),e.jsx(ar,{value:je,onChange:v,children:e.jsxs(ir,{spacing:4,w:"full",children:[e.jsx(F,{variant:je==="efectivo"?"filled":"outline",borderColor:je==="efectivo"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>v("efectivo"),children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(Ws,{value:"efectivo"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"Efectivo"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Paga en efectivo al repartidor"})]})]})})}),e.jsx(F,{variant:je==="plin"?"filled":"outline",borderColor:je==="plin"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>v("plin"),children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(Ws,{value:"plin"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"PLIN"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Paga con PLIN"})]})]})})})]})}),e.jsx(O,{colorScheme:"purple",size:"lg",w:"full",onClick:je==="efectivo"?sr:Gr,leftIcon:e.jsx(Ps,{}),isLoading:D,loadingText:"Creando suscripción...",children:je==="efectivo"?"Confirmar Suscripción":"Pagar con PLIN"})]})]})})]}):e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:Bs,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Forma de Pago"}),e.jsx(n,{color:"gray.600",children:"¿Cómo deseas pagar?"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsx(ar,{value:je,onChange:v,children:e.jsxs(ir,{spacing:4,children:[e.jsx(F,{variant:je==="efectivo"?"filled":"outline",borderColor:je==="efectivo"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>v("efectivo"),children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(Ws,{value:"efectivo"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"Efectivo"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Paga en efectivo al repartidor"})]})]})})}),e.jsx(F,{variant:je==="plin"?"filled":"outline",borderColor:je==="plin"?"blue.500":"gray.200",cursor:"pointer",onClick:()=>v("plin"),children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(Ws,{value:"plin"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"PLIN"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Pago digital con QR"})]})]})})})]})}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Resumen del Pedido"}),e.jsxs(u,{spacing:2,w:"full",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:M.name})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Modalidad:"}),e.jsx(ye,{colorScheme:"blue",children:K==="contraentrega"?"Contraentrega":K==="vale"?"A Crédito (Vale)":"Suscripción"})]}),e.jsxs(u,{spacing:1,w:"full",align:"stretch",children:[e.jsx(n,{children:"Productos:"}),se.map((j,q)=>e.jsxs(h,{justify:"space-between",w:"full",pl:2,children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["• ",j.name," x",j.quantity]}),e.jsxs(n,{fontSize:"sm",fontWeight:"bold",children:["S/ ",parseFloat(j.subtotal).toFixed(2)]})]},q))]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"blue.600",children:["S/ ",parseFloat(Fs()).toFixed(2)]})]})]})]})})}),e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{spacing:4,children:[e.jsxs(h,{w:"full",justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Términos y Condiciones"}),e.jsx(O,{size:"sm",variant:"outline",colorScheme:"blue",onClick:()=>xe(!0),children:"Ver Términos"})]}),e.jsxs(h,{w:"full",spacing:3,children:[e.jsx(Dn,{isChecked:V,onChange:j=>te(j.target.checked),colorScheme:"blue",size:"lg"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"He leído y acepto los términos y condiciones del servicio"})]})]})})}),e.jsx(O,{colorScheme:"green",size:"lg",w:"full",onClick:je==="efectivo"?sr:Gr,leftIcon:e.jsx(Ps,{}),isLoading:D,loadingText:"Creando pedido...",isDisabled:!V,children:je==="efectivo"?"Confirmar Pedido":"Pagar con PLIN"})]})})]}),Ra=()=>e.jsxs(F,{maxW:"lg",mx:"auto",children:[e.jsx(Pe,{textAlign:"center",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:Bs,boxSize:12,color:"purple.500"}),e.jsx(Z,{size:"lg",children:"Pago de Suscripción"}),e.jsx(n,{color:"gray.600",children:"Selecciona tu método de pago para la suscripción"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsx(F,{variant:"outline",w:"full",borderColor:"purple.200",children:e.jsx(L,{children:e.jsxs(u,{spacing:3,children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:b.name}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Total bidones:"}),e.jsx(n,{fontWeight:"bold",children:b.bottles+b.bonus})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Precio por bidón:"}),e.jsxs(n,{fontWeight:"bold",children:["S/ ",parseFloat(b.pricePerBottle).toFixed(2)]})]}),e.jsx(hs,{}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"lg",fontWeight:"bold",children:"Total a pagar:"}),e.jsxs(n,{fontSize:"xl",fontWeight:"bold",color:"purple.600",children:["S/ ",parseFloat(b.price).toFixed(2)]})]})]})})}),e.jsxs(u,{spacing:4,w:"full",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Método de Pago"}),e.jsx(F,{variant:je==="efectivo"?"filled":"outline",borderColor:je==="efectivo"?"green.500":"gray.200",cursor:"pointer",onClick:()=>v("efectivo"),_hover:{transform:"translateY(-2px)",shadow:"lg"},transition:"all 0.2s",children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(ge,{as:ys,boxSize:8,color:"green.500"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"Pago en Efectivo"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Paga cuando recibas tu suscripción"})]})]})})}),e.jsx(F,{variant:je==="plin"?"filled":"outline",borderColor:je==="plin"?"purple.500":"gray.200",cursor:"pointer",onClick:()=>v("plin"),_hover:{transform:"translateY(-2px)",shadow:"lg"},transition:"all 0.2s",children:e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsx(ge,{as:Ys,boxSize:8,color:"purple.500"}),e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:"Pago con Plin"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Paga con QR de Plin"})]})]})})})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsx(O,{variant:"outline",flex:1,onClick:()=>C(5),children:"← Anterior"}),e.jsx(O,{colorScheme:"purple",flex:1,onClick:()=>{je==="efectivo"?rr():je==="plin"&&a()},leftIcon:je==="efectivo"?e.jsx(Ps,{}):e.jsx(Ys,{}),isLoading:D,loadingText:je==="efectivo"?"Creando suscripción...":"Preparando pago...",children:je==="efectivo"?"Confirmar Suscripción":"Pagar con Plin"})]})]})})]}),Oa=()=>e.jsxs(Ve,{isOpen:r,onClose:l,size:{base:"full",sm:"md"},isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{mx:{base:0,sm:4},my:{base:0,sm:4},maxH:{base:"100vh",sm:"90vh"},maxW:{base:"100vw",sm:"500px"},w:{base:"100%",sm:"auto"},children:[e.jsx(Me,{textAlign:"center",p:{base:3,md:4},children:e.jsxs(u,{spacing:2,children:[e.jsx(ge,{as:Ys,boxSize:{base:6,md:8},color:"purple.500"}),e.jsx(n,{fontSize:{base:"md",md:"lg"},children:"Pago con PLIN"})]})}),e.jsx(He,{}),e.jsx($e,{pb:{base:3,md:4},px:{base:3,md:4},overflowY:"auto",children:e.jsxs(u,{spacing:{base:3,md:4},w:"100%",children:[e.jsxs(De,{status:"info",fontSize:{base:"xs",md:"sm"},w:"100%",children:[e.jsx(Ie,{}),e.jsx(n,{children:"Escanea el código QR con tu app PLIN"})]}),e.jsx(k,{textAlign:"center",w:"100%",maxW:"250px",mx:"auto",children:e.jsx(It,{src:Il,alt:"QR PLIN",w:"100%",h:"auto",borderRadius:"md"})}),e.jsxs(u,{spacing:2,w:"100%",children:[e.jsxs(n,{fontWeight:"bold",fontSize:{base:"md",md:"lg"},textAlign:"center",children:["Total a pagar: S/ ",K==="suscripcion"&&b?parseFloat(b.price).toFixed(2):parseFloat(Fs()).toFixed(2)]}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},color:"gray.600",textAlign:"center",children:K==="suscripcion"&&b?`Plan ${b.name} - ${b.bottles+b.bonus} bidones`:"Incluye productos + flete de envío"})]}),e.jsxs(De,{status:gs?"success":"warning",fontSize:{base:"xs",md:"sm"},children:[e.jsx(Ie,{}),e.jsx(n,{children:gs?"✅ Comprobante enviado por WhatsApp. Ahora puedes confirmar el pago.":"Después de pagar, envía el comprobante por WhatsApp"})]}),K==="suscripcion"&&b&&e.jsxs(De,{status:"info",fontSize:{base:"xs",md:"sm"},children:[e.jsx(Ie,{}),e.jsxs(n,{children:[e.jsx("strong",{children:"Importante:"})," Una vez pagada la suscripción, podrás hacer pedidos usando tus bidones sin costo adicional."]})]}),e.jsxs(u,{spacing:{base:2,md:3},w:"full",children:[e.jsx(O,{colorScheme:"green",size:{base:"md",md:"lg"},w:"full",leftIcon:e.jsx(it,{}),onClick:Ta,fontSize:{base:"sm",md:"md"},children:"Enviar Comprobante por WhatsApp"}),e.jsx(O,{colorScheme:"purple",size:{base:"md",md:"lg"},w:"full",leftIcon:e.jsx(Ps,{}),onClick:async()=>{if(K==="suscripcion"&&b)try{_(!0),await rr("plin")}catch(j){console.error("Error en suscripción:",j)}finally{_(!1)}else await Yr()},isLoading:D,loadingText:K==="suscripcion"?"Creando suscripción...":"Creando pedido...",isDisabled:!gs||D,opacity:gs?1:.5,fontSize:{base:"sm",md:"md"},children:gs?"Confirmar Pago y Crear Pedido":"Primero envía el comprobante por WhatsApp"})]})]})})]})]});return e.jsxs(k,{minH:"100vh",bg:"gray.50",py:{base:4,md:8},children:[e.jsx(k,{maxW:"1200px",mx:"auto",px:{base:2,sm:4},children:e.jsxs(u,{spacing:{base:4,md:8},children:[e.jsxs(k,{textAlign:"center",w:"100%",children:[e.jsx(Z,{size:{base:"lg",md:"xl"},color:"blue.600",mb:2,children:"Pedido Rápido de Agua"}),e.jsx(n,{color:"gray.600",fontSize:{base:"md",md:"lg"},children:"Proceso simplificado en 5 pasos"})]}),e.jsx(k,{w:"100%",overflowX:"auto",pb:2,children:e.jsx(h,{spacing:{base:1,sm:2,md:4},justify:"center",minW:"max-content",px:{base:2,md:0},children:[1,2,3,4,5,6].map(j=>e.jsxs(u,{spacing:1,minW:{base:"60px",sm:"70px"},children:[e.jsx(k,{w:{base:8,sm:10,md:12},h:{base:8,sm:10,md:12},borderRadius:"full",bg:j<=T?"blue.500":"gray.200",color:j<=T?"white":"gray.500",display:"flex",alignItems:"center",justifyContent:"center",fontSize:{base:"xs",sm:"sm",md:"md"},fontWeight:"bold",flexShrink:0,children:j}),e.jsx(n,{fontSize:{base:"2xs",sm:"xs",md:"sm"},color:j<=T?"blue.600":"gray.500",textAlign:"center",whiteSpace:"nowrap",children:j===1?"DNI":j===2?"Datos":j===3?"Productos":j===4?"Modalidad":j===5?"Confirmar":j===6?"Pago":j})]},j))})}),T===1&&Da(),T===2&&Ia(),T===3&&_a(),T===4&&ka(),T===5&&Na(),T===6&&Ra(),T>1&&e.jsxs(h,{spacing:4,children:[e.jsx(O,{variant:"outline",onClick:()=>C(T-1),children:"← Anterior"}),T<6&&e.jsx(O,{colorScheme:"blue",onClick:()=>{C($&&p&&T===3?5:T+1)},children:"Siguiente →"})]})]})}),Oa(),e.jsx(Tl,{isOpen:Ce,onClose:()=>xe(!1),onAccept:Aa,onReject:Ea,title:"Términos y Condiciones - Planta de Agua Aquayara",showAcceptance:!0})]})},kl=()=>{const[s,t]=S.useState(null),{isOpen:r,onOpen:a,onClose:i}=Le(),l=ps();Hs({base:!0,md:!1});const o=(V,te=2)=>{if(V==null||V==="")return"0.00";const Ce=parseFloat(V);return isNaN(Ce)?"0.00":Ce.toFixed(te)},{deliveryFees:c,loading:d,error:f,fetchDeliveryFees:P,createDeliveryFee:I,updateDeliveryFee:m,deleteDeliveryFee:T,clearError:C}=er(),{districts:D,loading:_,error:y,fetchDistricts:z,updateDistrict:E,createDistrict:N,clearError:$}=Ur(),[R,p]=S.useState({name:"",price:0});S.useEffect(()=>{console.log("🔄 Cargando tarifas de envío y distritos..."),P().then(V=>{console.log("📦 Resultado de fetchDeliveryFees:",V),console.log("📦 deliveryFees en estado:",c)}),z().then(V=>{console.log("📦 Resultado de fetchDistricts:",V),console.log("📦 districts en estado:",D)})},[P,z]),S.useEffect(()=>{f&&(l({title:"Error",description:f,status:"error",duration:3e3,isClosable:!0}),C())},[f,l,C]);const H=async V=>{V.preventDefault(),console.log("🔄 Enviando formulario con datos:",R),console.log("🔄 Editando distrito:",s);const te=s?await E(s.id,{name:R.name,deliveryFee:R.price}):await N({name:R.name,deliveryFee:R.price});console.log("📦 Resultado de la operación:",te),te.success&&(l({title:s?"Distrito actualizado":"Distrito creado",description:`El distrito ha sido ${s?"actualizado":"creado"}`,status:"success",duration:2e3,isClosable:!0}),g(),i())},b=V=>{t(V),p({name:V.name,price:V.deliveryFee||0}),a()},ae=async V=>{window.confirm("¿Estás seguro de que quieres eliminar este distrito?")&&l({title:"Función no disponible",description:"La eliminación de distritos no está disponible por el momento",status:"warning",duration:2e3,isClosable:!0})},g=()=>{p({name:"",price:0}),t(null)},B=()=>{g(),a()};return d?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsxs(k,{p:6,children:[e.jsxs(vs,{justify:"space-between",align:"center",mb:6,children:[e.jsx(Z,{size:"lg",color:"gray.700",children:"Gestión de Distritos y Fletes"}),e.jsx(O,{colorScheme:"blue",leftIcon:e.jsx(Rr,{}),onClick:B,children:"Nuevo Distrito"})]}),D.length===0?e.jsxs(De,{status:"info",children:[e.jsx(Ie,{}),"No hay distritos configurados."]}):e.jsx(os,{columns:{base:1,md:2,lg:3},spacing:6,children:Array.isArray(D)?D.map((V,te)=>e.jsxs(F,{variant:"outline",children:[e.jsx(Pe,{children:e.jsxs(vs,{justify:"space-between",align:"center",children:[e.jsx(Z,{size:"md",children:V.name||"Sin nombre"}),e.jsx(ye,{colorScheme:"green",children:"Activo"})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:3,align:"start",children:[e.jsxs(h,{children:[e.jsx(ys,{color:"gray.500"}),e.jsxs(n,{fontSize:"lg",fontWeight:"bold",color:"blue.600",children:["S/ ",o(V.deliveryFee||0)]})]}),e.jsxs(h,{spacing:2,w:"full",justify:"end",children:[e.jsx(_e,{size:"sm",icon:e.jsx(Vt,{}),onClick:()=>b(V),colorScheme:"blue",variant:"outline"}),e.jsx(_e,{size:"sm",icon:e.jsx(Or,{}),onClick:()=>ae(V.id),colorScheme:"red",variant:"outline"})]})]})})]},V.id||`district-${te}`)):null}),e.jsxs(Ve,{isOpen:r,onClose:i,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsx(qe,{children:e.jsxs("form",{onSubmit:H,children:[e.jsx(Me,{children:s?"Editar Distrito":"Nuevo Distrito"}),e.jsx(He,{}),e.jsx($e,{children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre del Distrito/Ciudad"}),e.jsx(re,{value:R.name,onChange:V=>p({...R,name:V.target.value}),placeholder:"Ej: San Isidro, Miraflores, Lima Centro"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Precio de Flete por Distrito (S/)"}),e.jsx(In,{value:R.price,onChange:V=>p({...R,price:parseFloat(V)||0}),min:0,precision:2,children:e.jsx(_n,{})})]})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"ghost",mr:3,onClick:i,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",type:"submit",children:s?"Actualizar":"Crear"})]})]})})]})]})},Nl=()=>{const s=tt(),{id:t}=Rn(),r=ps(),a=Hs({base:!0,md:!1}),[i,l]=S.useState(null),[o,c]=S.useState(!0),[d,f]=S.useState("boleta");S.useEffect(()=>{(async()=>{var y;try{if(t){try{const E=await X.get(`/api/guest-orders/token/${t}`);if(E.data.success){const N=E.data.data;console.log("🔍 OrderData recibido del servidor:",N),console.log("🔍 Products en orderData:",N.products),l({id:N.id,client:{name:N.customerName,phone:N.customerPhone,email:N.customerEmail,address:N.deliveryAddress,district:N.deliveryDistrict,reference:N.deliveryNotes,notes:N.deliveryNotes},items:((y=N.products)==null?void 0:y.map($=>{var R;return{name:((R=$.product)==null?void 0:R.name)||"Producto",quantity:$.quantity,unitPrice:$.price,subtotal:$.subtotal}}))||[],paymentMethod:N.paymentMethod,paymentType:N.paymentType,subtotal:N.totalAmount-N.deliveryFee,deliveryFee:N.deliveryFee,total:N.totalAmount,status:N.status==="pending"?"pendiente":N.status,createdAt:N.createdAt});return}}catch{console.log("No se pudo cargar desde el servidor, intentando localStorage")}const z=localStorage.getItem("guestOrderData");if(z){const E=JSON.parse(z);l({id:t,...E,status:"pendiente",createdAt:new Date().toISOString()})}}else{const z=localStorage.getItem("guestOrderData");if(z){const E=JSON.parse(z);l({id:"temp",...E,status:"pendiente",createdAt:new Date().toISOString()})}}}catch(z){console.error("Error al cargar pedido:",z),r({title:"Error",description:"No se pudo cargar el pedido",status:"error",duration:3e3,isClosable:!0})}finally{c(!1)}})()},[t,r]);const P=async()=>{if(i)try{r({title:"Generando PDF",description:"Preparando el documento...",status:"info",duration:2e3,isClosable:!0}),console.log("Datos del order original:",i),console.log("Items del order:",i.items),console.log("Payment method del order:",i.paymentMethod);const _={};i.items.forEach((p,H)=>{const b=`${p.name}-${p.unitPrice}`;_[b]=(_[b]||0)+1,console.log(`🔍 Item ${H}:`,{name:p.name,quantity:p.quantity,unitPrice:p.unitPrice,subtotal:p.subtotal,key:b})}),console.log("Conteo de productos:",_);const y=Object.entries(_).filter(([p,H])=>H>1);y.length>0&&console.warn("⚠️ Productos duplicados detectados:",y);const z={id:i.id,customerName:i.client.name,customerPhone:i.client.phone,customerEmail:i.client.email||null,deliveryAddress:i.client.address,deliveryDistrict:i.client.district,deliveryNotes:i.client.reference||null,paymentMethod:i.paymentMethod||"contraentrega",paymentType:i.paymentType||"cash",orderDetails:i.items.map(p=>(console.log("Mapeando item para orderDetails:",p),{product:{name:p.name},productName:p.name,quantity:parseInt(p.quantity),unitPrice:parseFloat(p.unitPrice),subtotal:parseFloat(p.subtotal)})),items:[],subtotal:parseFloat(i.subtotal),deliveryFee:parseFloat(i.deliveryFee),total:parseFloat(i.total),status:i.status,createdAt:i.createdAt};console.log("Datos finales enviados al backend:",z),console.log("Datos del pedido que se envían al backend:",{order:i,orderData:z,items:i.items,subtotal:i.subtotal,deliveryFee:i.deliveryFee,total:i.total}),console.log("Llamando al endpoint del backend para generar PDF..."),console.log("URL:","/api/guest-payments/generate-pdf"),console.log("Datos enviados:",{orderData:z,documentType:"boleta"});const E=await X.post("/api/guest-payments/generate-pdf",{orderData:z,documentType:d},{responseType:"blob"});console.log("Respuesta del backend:",{status:E.status,headers:E.headers,dataType:typeof E.data,dataLength:E.data.length});const N=new Blob([E.data],{type:"application/pdf"}),$=window.URL.createObjectURL(N),R=document.createElement("a");R.href=$,R.download=`${d}_${i.id}.pdf`,document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL($),r({title:"PDF Generado",description:"El documento se ha descargado exitosamente",status:"success",duration:3e3,isClosable:!0})}catch(_){console.error("Error al generar PDF:",_),r({title:"Error",description:"Error al generar el PDF",status:"error",duration:3e3,isClosable:!0})}},I=()=>{window.print()},m=()=>{const _=`Hola, tengo una consulta sobre mi pedido #${i==null?void 0:i.id}`,y=`https://wa.me/51961606183?text=${encodeURIComponent(_)}`;window.open(y,"_blank")},T=()=>{localStorage.removeItem("guestOrderData"),s("/guest-order")},C=_=>{switch(_){case"pendiente":return"yellow";case"confirmado":return"blue";case"en_preparacion":return"orange";case"en_camino":return"purple";case"entregado":return"green";case"cancelado":return"red";default:return"gray"}},D=_=>{switch(_){case"pendiente":return"Pendiente";case"confirmado":return"Confirmado";case"en_preparacion":return"En Preparación";case"en_camino":return"En Camino";case"entregado":return"Entregado";case"cancelado":return"Cancelado";default:return _}};return o?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):i?e.jsx(k,{minH:"100vh",bg:"gray.50",py:8,children:e.jsx(k,{maxW:"800px",mx:"auto",px:4,children:e.jsxs(u,{spacing:8,children:[e.jsxs(k,{textAlign:"center",children:[e.jsx(Z,{size:"xl",color:"blue.600",mb:2,children:"Recibo de Pedido"}),e.jsx(n,{color:"gray.600",fontSize:"lg",children:"Comprobante de tu pedido de agua"})]}),e.jsxs(F,{w:"full",children:[e.jsx(Pe,{children:e.jsxs(vs,{justify:"space-between",align:"center",wrap:"wrap",gap:4,children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsxs(Z,{size:"md",color:"gray.700",children:["Pedido #",i.id]}),e.jsx(n,{fontSize:"sm",color:"gray.500",children:new Date(i.createdAt).toLocaleString()})]}),e.jsx(ye,{colorScheme:C(i.status),size:"lg",children:D(i.status)})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(k,{w:"full",p:4,bg:"gray.50",borderRadius:"md",children:[e.jsxs(n,{fontWeight:"bold",mb:3,color:"gray.700",children:[e.jsx(zr,{style:{display:"inline",marginRight:"8px"}}),"Información del Cliente"]}),e.jsxs(os,{columns:{base:1,md:2},spacing:3,children:[e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Nombre:"}),e.jsx(n,{fontWeight:"bold",children:i.client.name})]}),e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Teléfono:"}),e.jsx(n,{fontWeight:"bold",children:i.client.phone})]}),i.client.email&&e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Email:"}),e.jsx(n,{fontWeight:"bold",children:i.client.email})]}),e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Distrito:"}),e.jsx(n,{fontWeight:"bold",children:i.client.district})]})]}),e.jsxs(k,{mt:3,children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Dirección:"}),e.jsx(n,{fontWeight:"bold",children:i.client.address})]}),i.client.reference&&e.jsxs(k,{mt:2,children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Referencia:"}),e.jsx(n,{fontWeight:"bold",children:i.client.reference})]})]}),e.jsxs(k,{w:"full",children:[e.jsxs(n,{fontWeight:"bold",mb:3,color:"gray.700",children:[e.jsx(ws,{style:{display:"inline",marginRight:"8px"}}),"Productos Solicitados"]}),a?e.jsx(u,{spacing:3,children:i.items.map((_,y)=>e.jsx(F,{variant:"outline",w:"full",children:e.jsx(L,{children:e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:_.name}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["Cantidad: ",_.quantity]}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["S/ ",parseFloat(_.unitPrice).toFixed(2)," c/u"]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:"Subtotal:"}),e.jsxs(n,{fontWeight:"bold",color:"blue.600",children:["S/ ",parseFloat(_.subtotal).toFixed(2)]})]})]})})},y))}):e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Producto"}),e.jsx(oe,{isNumeric:!0,children:"Cantidad"}),e.jsx(oe,{isNumeric:!0,children:"Precio Unit."}),e.jsx(oe,{isNumeric:!0,children:"Subtotal"})]})}),e.jsx(st,{children:i.items.map((_,y)=>e.jsxs(ms,{children:[e.jsx(le,{children:e.jsx(u,{align:"start",spacing:1,children:e.jsx(n,{fontWeight:"bold",children:_.name})})}),e.jsx(le,{isNumeric:!0,children:_.quantity}),e.jsxs(le,{isNumeric:!0,children:["S/ ",parseFloat(_.unitPrice).toFixed(2)]}),e.jsxs(le,{isNumeric:!0,fontWeight:"bold",color:"blue.600",children:["S/ ",parseFloat(_.subtotal).toFixed(2)]})]},y))})]})]}),e.jsx(k,{w:"full",p:4,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs(u,{spacing:2,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Subtotal:"}),e.jsxs(n,{fontWeight:"bold",children:["S/ ",parseFloat(i.subtotal).toFixed(2)]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{children:"Flete:"}),e.jsxs(n,{fontWeight:"bold",children:["S/ ",parseFloat(i.deliveryFee).toFixed(2)]})]}),e.jsx(hs,{}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Total:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"blue.600",children:["S/ ",parseFloat(i.total).toFixed(2)]})]})]})}),i.client.notes&&e.jsxs(k,{w:"full",p:4,bg:"yellow.50",borderRadius:"md",children:[e.jsx(n,{fontWeight:"bold",mb:2,color:"gray.700",children:"Notas Adicionales:"}),e.jsx(n,{fontSize:"sm",children:i.client.notes})]}),e.jsx(k,{w:"full",maxW:"300px",children:e.jsxs(U,{children:[e.jsx(G,{children:"Tipo de Documento"}),e.jsxs(Je,{value:d,onChange:_=>f(_.target.value),children:[e.jsx("option",{value:"boleta",children:"Boleta"}),e.jsx("option",{value:"factura",children:"Factura"})]})]})}),e.jsxs(os,{columns:{base:1,md:2,lg:4},spacing:4,w:"full",children:[e.jsx(O,{leftIcon:e.jsx(Fr,{}),colorScheme:"blue",variant:"outline",onClick:P,children:"Descargar PDF"}),e.jsx(O,{leftIcon:e.jsx(oo,{}),colorScheme:"gray",variant:"outline",onClick:I,children:"Imprimir"}),e.jsx(O,{leftIcon:e.jsx(it,{}),colorScheme:"green",variant:"outline",onClick:m,children:"WhatsApp"}),e.jsx(O,{leftIcon:e.jsx(zr,{}),colorScheme:"purple",onClick:T,children:"Nuevo Pedido"})]})]})})]})]})})}):e.jsx(is,{h:"400px",children:e.jsxs(De,{status:"error",children:[e.jsx(Ie,{}),"No se encontró el pedido"]})})},Rl=()=>{var _;const s=tt(),{id:t}=Rn(),r=ps();Hs({base:!0,md:!1});const[a,i]=S.useState(null),[l,o]=S.useState(!1),[c,d]=S.useState(t||""),[f,P]=S.useState(!1);S.useEffect(()=>{t&&I(t)},[t]);const I=async y=>{o(!0),P(!1);try{const z=await axios.get(`/api/guest-orders/${y}`),E=z.data.success?z.data.data:z.data;E?i(E):P(!0)}catch(z){console.error("Error al cargar pedido:",z),P(!0)}finally{o(!1)}},m=()=>{if(!c.trim()){r({title:"ID requerido",description:"Ingresa un número de pedido",status:"warning",duration:3e3,isClosable:!0});return}I(c.trim())},T=y=>{switch(y){case"pendiente":return{color:"yellow",text:"Pendiente",icon:on,description:"Tu pedido está siendo procesado"};case"confirmado":return{color:"blue",text:"Confirmado",icon:lr,description:"Tu pedido ha sido confirmado"};case"en_preparacion":return{color:"orange",text:"En Preparación",icon:ws,description:"Tu pedido está siendo preparado"};case"en_camino":return{color:"purple",text:"En Camino",icon:ws,description:"Tu pedido está en camino"};case"entregado":return{color:"green",text:"Entregado",icon:lr,description:"Tu pedido ha sido entregado"};case"cancelado":return{color:"red",text:"Cancelado",icon:uo,description:"Tu pedido ha sido cancelado"};default:return{color:"gray",text:y,icon:on,description:"Estado desconocido"}}},C=y=>{switch(y){case"pendiente":return 20;case"confirmado":return 40;case"en_preparacion":return 60;case"en_camino":return 80;case"entregado":return 100;case"cancelado":return 0;default:return 0}},D=()=>[{key:"pendiente",label:"Pendiente",description:"Pedido recibido"},{key:"confirmado",label:"Confirmado",description:"Pedido confirmado"},{key:"en_preparacion",label:"En Preparación",description:"Preparando pedido"},{key:"en_camino",label:"En Camino",description:"Enviando pedido"},{key:"entregado",label:"Entregado",description:"Pedido entregado"}];return l?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsx(k,{minH:"100vh",bg:"gray.50",py:8,children:e.jsx(k,{maxW:"800px",mx:"auto",px:4,children:e.jsxs(u,{spacing:8,children:[e.jsxs(k,{textAlign:"center",children:[e.jsx(Z,{size:"xl",color:"blue.600",mb:2,children:"Seguimiento de Pedido"}),e.jsx(n,{color:"gray.600",fontSize:"lg",children:"Consulta el estado de tu pedido"})]}),e.jsxs(F,{w:"full",children:[e.jsx(Pe,{children:e.jsx(Z,{size:"md",color:"gray.700",children:"Buscar Pedido"})}),e.jsx(L,{children:e.jsxs(h,{spacing:4,children:[e.jsxs(Ct,{flex:1,children:[e.jsx(kr,{pointerEvents:"none",children:e.jsx(Xn,{color:"gray.300"})}),e.jsx(re,{placeholder:"Ingresa el número de pedido",value:c,onChange:y=>d(y.target.value),onKeyPress:y=>y.key==="Enter"&&m()})]}),e.jsx(O,{colorScheme:"blue",onClick:m,isLoading:l,loadingText:"Buscando...",children:"Buscar"})]})})]}),f&&e.jsxs(De,{status:"error",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",children:"Pedido no encontrado"}),e.jsx(n,{fontSize:"sm",children:"Verifica que el número de pedido sea correcto"})]})]}),a&&e.jsxs(F,{w:"full",children:[e.jsx(Pe,{children:e.jsxs(vs,{justify:"space-between",align:"center",wrap:"wrap",gap:4,children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsxs(Z,{size:"md",color:"gray.700",children:["Pedido #",a.id]}),e.jsx(n,{fontSize:"sm",color:"gray.500",children:new Date(a.createdAt).toLocaleString()})]}),e.jsx(ye,{colorScheme:T(a.status).color,size:"lg",children:T(a.status).text})]})}),e.jsx(L,{children:e.jsxs(u,{spacing:6,children:[e.jsxs(k,{w:"full",p:4,bg:`${T(a.status).color}.50`,borderRadius:"md",children:[e.jsxs(h,{spacing:3,mb:3,children:[pe.createElement(T(a.status).icon,{color:`${T(a.status).color}.500`,size:"24px"}),e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:T(a.status).text})]}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:T(a.status).description}),e.jsx(Ya,{value:C(a.status),colorScheme:T(a.status).color,size:"sm",mt:3})]}),e.jsxs(k,{w:"full",children:[e.jsx(n,{fontWeight:"bold",mb:4,color:"gray.700",children:"Progreso del Pedido"}),e.jsx(u,{spacing:3,children:D().map((y,z)=>{const E=C(a.status)>C(y.key),N=a.status===y.key;return e.jsxs(h,{w:"full",spacing:4,children:[e.jsx(k,{w:"8",h:"8",borderRadius:"full",bg:E?"green.500":N?`${T(a.status).color}.500`:"gray.300",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"sm",children:E?e.jsx(lr,{}):z+1}),e.jsxs(u,{align:"start",spacing:1,flex:1,children:[e.jsx(n,{fontWeight:N?"bold":"normal",children:y.label}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:y.description})]})]},y.key)})})]}),e.jsxs(k,{w:"full",p:4,bg:"gray.50",borderRadius:"md",children:[e.jsx(n,{fontWeight:"bold",mb:3,color:"gray.700",children:"Información de Entrega"}),e.jsxs(os,{columns:{base:1,md:2},spacing:3,children:[e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Cliente:"}),e.jsx(n,{fontWeight:"bold",children:a.clientName||"N/A"})]}),e.jsxs(k,{children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Teléfono:"}),e.jsx(n,{fontWeight:"bold",children:a.clientPhone||"N/A"})]}),e.jsxs(k,{colSpan:{base:1,md:2},children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Dirección:"}),e.jsx(n,{fontWeight:"bold",children:a.deliveryAddress||"N/A"})]})]})]}),e.jsxs(k,{w:"full",children:[e.jsx(n,{fontWeight:"bold",mb:3,color:"gray.700",children:"Productos Solicitados"}),e.jsx(u,{spacing:2,children:((_=a.items)==null?void 0:_.map((y,z)=>e.jsxs(h,{justify:"space-between",w:"full",p:2,bg:"gray.50",borderRadius:"md",children:[e.jsxs(n,{fontSize:"sm",children:[y.name," x ",y.quantity]}),e.jsxs(n,{fontSize:"sm",fontWeight:"bold",children:["S/ ",parseFloat(y.subtotal).toFixed(2)]})]},z)))||e.jsx(n,{fontSize:"sm",color:"gray.500",children:"No hay información de productos"})})]}),e.jsx(k,{w:"full",p:4,border:"1px",borderColor:"gray.200",borderRadius:"md",children:e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",fontSize:"lg",children:"Total:"}),e.jsxs(n,{fontWeight:"bold",fontSize:"lg",color:"blue.600",children:["S/ ",parseFloat(a.total||0).toFixed(2)]})]})}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsx(O,{leftIcon:e.jsx(zr,{}),colorScheme:"blue",onClick:()=>s("/guest-order"),flex:1,children:"Nuevo Pedido"}),e.jsx(O,{leftIcon:e.jsx(ws,{}),colorScheme:"green",variant:"outline",onClick:()=>s(`/receipt/${a.id}`),flex:1,children:"Ver Recibo"})]})]})})]})]})})})},Ol=()=>{const{user:s}=Rs(),{updateGuestOrder:t}=Hr(),r=ps(),[a,i]=S.useState(!0),[l,o]=S.useState([]),[c,d]=S.useState([]),[f,P]=S.useState([]),[I,m]=S.useState([]),[T,C]=S.useState("orders"),[D,_]=S.useState("all"),[y,z]=S.useState(null),[E,N]=S.useState(null),{isOpen:$,onOpen:R,onClose:p}=Le(),{isOpen:H,onOpen:b,onClose:ae}=Le(),{isOpen:g,onOpen:B,onClose:V}=Le(),[te,Ce]=S.useState({clientId:"",productId:"",quantity:1,notes:""});S.useEffect(()=>{xe(),Ae(),Ne(),w();const v=setInterval(xe,3e4);return()=>clearInterval(v)},[]);const xe=async()=>{try{console.log("🔍 DeliveryDashboard - Usuario actual:",s),console.log("🔍 DeliveryDashboard - ID del usuario:",s==null?void 0:s.id);const v=await X.get("/api/delivery/orders");if(console.log("🔍 DeliveryDashboard - Respuesta del servidor:",v.data),v.data.success){const we=v.data.data||[];console.log("🔍 DeliveryDashboard - Pedidos recibidos:",we.length),o(Array.isArray(we)?we:[])}else console.error("Error en la respuesta:",v.data.message),o([])}catch(v){console.error("Error al cargar pedidos:",v),o([]),r({title:"Error",description:"No se pudieron cargar los pedidos",status:"error",duration:3e3,isClosable:!0})}finally{i(!1)}},Ae=async()=>{try{const v=await X.get(`/api/vouchers/delivery-person/${s==null?void 0:s.id}`);if(console.log("🔍 DeliveryDashboard - Vales recibidos:",v.data),v.data.success){const we=v.data.data||[];d(Array.isArray(we)?we:[])}else d([])}catch(v){console.error("Error al cargar vales:",v),d([])}},Ne=async()=>{try{const v=await X.get("/api/clients");v.data.success&&Array.isArray(v.data.data)?P(v.data.data):P([])}catch(v){console.error("Error al cargar clientes:",v),P([])}},w=async()=>{try{const v=await X.get("/api/products");v.data.success&&Array.isArray(v.data.data)?m(v.data.data):m([])}catch(v){console.error("Error al cargar productos:",v),m([])}},Q=v=>{switch(v){case"confirmed":return"blue";case"preparing":return"yellow";case"ready":return"purple";case"delivered":return"green";case"cancelled":return"red";default:return"gray"}},ne=v=>{switch(v){case"confirmed":return"Confirmado";case"preparing":return"Preparando";case"ready":return"Listo";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return"Desconocido"}},de=(v,we)=>{if(we==="suscripcion")return _s;switch(v){case"cash":case"efectivo":return ys;case"plin":return Ys;case"yape":return Ys;case"transfer":return Bs;default:return ys}},A={total:l.length,confirmed:l.filter(v=>v.status==="confirmed").length,preparing:l.filter(v=>v.status==="preparing").length,ready:l.filter(v=>v.status==="ready").length,delivered:l.filter(v=>v.status==="delivered").length,cancelled:l.filter(v=>v.status==="cancelled").length},me=l.filter(v=>D==="all"?!0:D==="asignado"?v.status==="confirmed":D==="en_camino"?v.status==="preparing"||v.status==="ready":D==="entregado"?v.status==="delivered":!0),M=(v,we)=>{const Ke=encodeURIComponent(we);window.open(`https://wa.me/51${v}?text=${Ke}`,"_blank")},Y=v=>{const we=encodeURIComponent(v);window.open(`https://www.google.com/maps/search/?api=1&query=${we}`,"_blank")},se=v=>{z(v),b()},fe=(v,we)=>{z({...v,newStatus:we}),R()},W=async()=>{if(y)try{const v={status:y.newStatus};await t(y.id,v),r({title:"Estado actualizado",description:`El pedido ahora está ${ne(y.newStatus).toLowerCase()}`,status:"success",duration:3e3,isClosable:!0}),p(),z(null),xe()}catch{r({title:"Error",description:"No se pudo actualizar el estado",status:"error",duration:3e3,isClosable:!0})}},Re=v=>{var we,Ke,gs,ss;return e.jsx(F,{variant:"outline",shadow:"sm",borderRadius:"lg",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(u,{spacing:{base:2,md:3},align:"stretch",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(u,{align:"start",spacing:.5,flex:1,minW:0,children:[e.jsx(n,{fontWeight:"bold",fontSize:{base:"sm",md:"md"},noOfLines:1,children:v.orderNumber||`#${v.id}`}),e.jsx(n,{fontSize:{base:"2xs",md:"xs"},color:"gray.500",noOfLines:1,children:v.type==="regular"?"Cliente Frecuente":"Cliente Visitante"})]}),e.jsx(ye,{colorScheme:Q(v.status),fontSize:{base:"2xs",md:"xs"},px:{base:1,md:2},py:.5,children:ne(v.status)})]}),e.jsxs(u,{spacing:{base:1.5,md:2},align:"stretch",children:[e.jsxs(h,{spacing:2,w:"full",children:[e.jsx(qs,{size:12,color:"#718096"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},fontWeight:"medium",noOfLines:1,flex:1,children:v.clientName||((we=v.client)==null?void 0:we.name)||"Sin nombre"})]}),e.jsxs(h,{spacing:2,w:"full",children:[e.jsx(Ks,{size:12,color:"#718096"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},noOfLines:1,flex:1,children:v.clientPhone||((Ke=v.client)==null?void 0:Ke.phone)||"Sin teléfono"}),e.jsx(Oe,{label:"Enviar WhatsApp",children:e.jsx(_e,{size:"sm",icon:e.jsx(it,{}),colorScheme:"green",variant:"ghost",onClick:()=>{var Ue;return M(v.clientPhone||((Ue=v.client)==null?void 0:Ue.phone),`Hola! Soy el repartidor de AquaYara. Estoy en camino con tu pedido ${v.orderNumber||`#${v.id}`}. ¿Te parece bien?`)}})})]}),e.jsxs(h,{spacing:2,w:"full",children:[e.jsx(vt,{size:12,color:"#718096"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},noOfLines:2,flex:1,children:v.clientAddress||((gs=v.client)==null?void 0:gs.address)||"Sin dirección"}),e.jsx(Oe,{label:"Abrir en Google Maps",children:e.jsx(_e,{size:"sm",icon:e.jsx(eo,{}),colorScheme:"blue",variant:"ghost",onClick:()=>{var Ue;return Y(v.clientAddress||((Ue=v.client)==null?void 0:Ue.address))}})})]}),e.jsxs(h,{spacing:2,w:"full",children:[e.jsx(vt,{size:12,color:"#718096"}),e.jsxs(n,{fontSize:{base:"xs",md:"sm"},noOfLines:1,flex:1,children:["Distrito: ",v.clientDistrict||((ss=v.client)==null?void 0:ss.district)||v.deliveryDistrict||"Sin distrito"]})]})]}),e.jsxs(u,{spacing:2,align:"stretch",w:"full",children:[!1,e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(h,{spacing:2,flex:1,minW:0,children:[e.jsx(ge,{as:de(v.paymentType,v.paymentMethod),size:14}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},noOfLines:1,children:v.paymentMethod==="vale"?"A Crédito (Vale)":v.paymentMethod==="suscripcion"?"Suscripción":v.paymentMethod==="contraentrega"?v.paymentType==="plin"?"Contraentrega - PLIN":v.paymentType==="yape"?"Contraentrega - Yape":v.paymentType==="cash"?"Contraentrega - Efectivo":"Contraentrega":v.paymentType==="plin"?"PLIN":v.paymentType==="yape"?"Yape":(v.paymentType==="cash","Efectivo")})]}),e.jsx(n,{fontWeight:"bold",fontSize:{base:"xs",md:"sm"},color:v.paymentMethod==="vale"?"orange.600":"green.600",children:v.paymentMethod==="vale"?"Sin cobro":`S/ ${parseFloat(v.total||v.totalAmount||0).toFixed(2)}`})]}),e.jsx(ye,{colorScheme:v.paymentMethod==="vale"?"orange":v.paymentMethod==="suscripcion"?"purple":v.paymentType==="plin"||v.paymentType==="yape"?"blue":"green",fontSize:{base:"2xs",md:"xs"},px:2,py:1,borderRadius:"md",children:v.paymentMethod==="vale"?"💳 NO COBRAR - A Crédito":v.paymentMethod==="suscripcion"?"📅 NO COBRAR - Suscripción":v.paymentType==="plin"||v.paymentType==="yape"?"📱 NO COBRAR - Pago Digital":"💰 COBRAR - Efectivo"})]}),v.products&&v.products.length>0&&e.jsxs(u,{spacing:{base:1,md:1.5},align:"stretch",children:[e.jsx(n,{fontSize:{base:"2xs",md:"xs"},fontWeight:"bold",color:"gray.600",children:"Productos:"}),Array.isArray(v.products)&&v.products.map((Ue,x)=>e.jsxs(h,{justify:"space-between",fontSize:{base:"2xs",md:"xs"},w:"full",children:[e.jsx(n,{noOfLines:1,flex:1,minW:0,children:Ue.name||Ue.productName}),e.jsxs(n,{fontWeight:"bold",color:"blue.600",flexShrink:0,px:1,children:["x",Ue.quantity]}),e.jsxs(n,{color:"green.600",minW:"fit-content",textAlign:"right",flexShrink:0,children:["S/ ",parseFloat(Ue.unitPrice||Ue.price||0).toFixed(2)]})]},x))]}),v.paymentMethod==="vale"&&e.jsxs(De,{status:"warning",size:"sm",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsx(n,{fontSize:{base:"2xs",md:"xs"},fontWeight:"bold",noOfLines:1,children:"⚠️ PEDIDO A CRÉDITO - NO COBRAR NADA"})]}),v.notes&&e.jsxs(De,{status:"info",size:"sm",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsx(n,{fontSize:{base:"2xs",md:"xs"},noOfLines:2,children:v.notes})]}),e.jsxs(u,{spacing:{base:2,md:3},align:"stretch",children:[e.jsx(h,{spacing:2,justify:"center",children:e.jsx(Oe,{label:"Ver detalles",children:e.jsx(_e,{size:{base:"sm",md:"md"},icon:e.jsx(Vs,{}),onClick:()=>se(v),"aria-label":"Ver detalles",colorScheme:"blue",variant:"outline"})})}),v.status==="confirmed"&&e.jsx(O,{size:{base:"sm",md:"md"},colorScheme:"purple",leftIcon:e.jsx(io,{}),onClick:()=>fe(v,"preparing"),w:"full",fontSize:{base:"xs",md:"sm"},children:"Iniciar Preparación"}),v.status==="preparing"&&e.jsx(O,{size:{base:"sm",md:"md"},colorScheme:"blue",leftIcon:e.jsx(ws,{}),onClick:()=>fe(v,"ready"),w:"full",fontSize:{base:"xs",md:"sm"},children:"Listo para Entrega"}),v.status==="ready"&&e.jsx(O,{size:{base:"sm",md:"md"},colorScheme:"green",leftIcon:e.jsx(Ps,{}),onClick:()=>fe(v,"delivered"),w:"full",fontSize:{base:"xs",md:"sm"},children:"Marcar Entregado"})]})]})})},`${v.type}-${v.id}`)},K=()=>e.jsxs(Ve,{isOpen:$,onClose:p,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Actualizar Estado del Pedido"}),e.jsx(He,{}),e.jsx($e,{children:e.jsx(u,{spacing:4,children:y&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{children:["¿Confirmar cambio de estado del pedido #",y.id,"?"]}),e.jsxs(n,{fontWeight:"bold",children:[y.newStatus==="preparing"&&"Iniciar Preparación",y.newStatus==="ready"&&"Marcar como Listo",y.newStatus==="delivered"&&"Marcar como Entregado"]})]})})}),e.jsxs(As,{children:[e.jsx(O,{variant:"ghost",mr:3,onClick:p,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",onClick:W,children:"Confirmar"})]})]})]}),Ee=()=>{var v,we,Ke,gs;return e.jsxs(Ve,{isOpen:H,onClose:ae,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Detalles del Pedido"}),e.jsx(He,{}),e.jsx($e,{children:y&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(n,{fontWeight:"bold",fontSize:"lg",children:["Pedido #",y.id]}),e.jsx(hs,{}),e.jsxs(u,{spacing:3,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Cliente:"}),e.jsx(n,{children:y.clientName||((v=y.client)==null?void 0:v.name)||"Sin nombre"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Teléfono:"}),e.jsx(n,{children:y.clientPhone||((we=y.client)==null?void 0:we.phone)||"Sin teléfono"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Dirección:"}),e.jsx(n,{children:y.clientAddress||((Ke=y.client)==null?void 0:Ke.address)||"Sin dirección"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Distrito:"}),e.jsx(n,{children:y.clientDistrict||((gs=y.client)==null?void 0:gs.district)||y.deliveryDistrict||"Sin distrito"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Estado:"}),e.jsx(ye,{colorScheme:Q(y.status),children:ne(y.status)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Método de pago:"}),e.jsxs(h,{children:[e.jsx(ge,{as:de(y.paymentType,y.paymentMethod),size:16}),e.jsx(n,{children:y.paymentMethod==="vale"?"A Crédito (Vale)":y.paymentMethod==="suscripcion"?"Suscripción":y.paymentMethod==="contraentrega"?y.paymentType==="plin"?"Contraentrega - PLIN":y.paymentType==="yape"?"Contraentrega - Yape":y.paymentType==="cash"?"Contraentrega - Efectivo":"Contraentrega":y.paymentType==="plin"?"PLIN":y.paymentType==="yape"?"Yape":(y.paymentType==="cash","Efectivo")})]})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Total:"}),e.jsx(n,{fontWeight:"bold",color:y.paymentMethod==="vale"?"orange.600":"green.600",children:y.paymentMethod==="vale"?"Sin cobro":`S/ ${parseFloat(y.total||y.totalAmount||0).toFixed(2)}`})]}),e.jsxs(De,{status:y.paymentMethod==="vale"?"warning":y.paymentMethod==="suscripcion"||y.paymentType==="plin"||y.paymentType==="yape"?"info":"success",borderRadius:"md",children:[e.jsx(Ie,{}),e.jsx(n,{fontSize:"sm",fontWeight:"bold",children:y.paymentMethod==="vale"?"💳 NO COBRAR - Este pedido es a crédito":y.paymentMethod==="suscripcion"?"📅 NO COBRAR - Este pedido es por suscripción":y.paymentType==="plin"?"📱 NO COBRAR - El cliente pagará por PLIN":y.paymentType==="yape"?"📱 NO COBRAR - El cliente pagará por Yape":"💰 COBRAR - El cliente pagará en efectivo"})]})]}),y.products&&y.products.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(hs,{}),e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsx(n,{fontWeight:"bold",children:"Productos:"}),Array.isArray(y.products)&&y.products.map((ss,Ue)=>{var x;return e.jsxs(h,{justify:"space-between",fontSize:"sm",children:[e.jsx(n,{flex:1,children:((x=ss.product)==null?void 0:x.name)||ss.name||"Producto desconocido"}),e.jsxs(n,{fontWeight:"bold",children:[ss.quantity," x S/ ",parseFloat(ss.price||ss.unitPrice||0).toFixed(2)]})]},Ue)})]})]})]})}),e.jsx(As,{children:e.jsx(O,{onClick:ae,children:"Cerrar"})})]})]})},je=()=>e.jsxs(Ve,{isOpen:g,onClose:V,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Crear Nuevo Vale"}),e.jsx(He,{}),e.jsx($e,{children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{children:[e.jsx(G,{children:"Cliente"}),e.jsx(Je,{placeholder:"Seleccionar cliente",children:f.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Producto"}),e.jsx(Je,{placeholder:"Seleccionar producto",children:I.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Cantidad"}),e.jsx(re,{type:"number",min:"1",defaultValue:"1"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas"}),e.jsx(ks,{placeholder:"Notas adicionales..."})]})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"ghost",mr:3,onClick:V,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",onClick:V,children:"Crear Vale"})]})]})]});return a?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsx(k,{p:{base:2,sm:3,md:6},minH:"100vh",bg:"gray.50",children:e.jsxs(u,{spacing:{base:3,md:6},align:"stretch",children:[e.jsx(k,{bg:"white",p:{base:3,md:4},borderRadius:"lg",shadow:"sm",children:e.jsxs(u,{spacing:2,align:"start",children:[e.jsx(Z,{size:{base:"sm",md:"lg"},color:"gray.800",children:"Panel de Repartidor"}),e.jsxs(n,{color:"gray.600",fontSize:{base:"xs",md:"md"},children:["Bienvenido, ",(console.log("🔍 Verificando nombre del usuario:",{firstName:s==null?void 0:s.firstName,lastName:s==null?void 0:s.lastName,username:s==null?void 0:s.username,hasFirstName:!!(s!=null&&s.firstName),hasLastName:!!(s!=null&&s.lastName),bothNames:!!(s!=null&&s.firstName&&(s!=null&&s.lastName))}),s!=null&&s.firstName&&(s!=null&&s.lastName)?`${s.firstName} ${s.lastName}`:(s==null?void 0:s.username)||"Repartidor"),". Gestiona tus entregas asignadas."]})]})}),e.jsxs(os,{columns:{base:2,sm:4},spacing:{base:2,md:4},children:[e.jsx(F,{shadow:"sm",borderRadius:"lg",children:e.jsxs(L,{textAlign:"center",p:{base:2,md:4},children:[e.jsx(n,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"blue.600",children:A.total}),e.jsx(n,{fontSize:{base:"2xs",md:"sm"},color:"gray.600",noOfLines:1,children:"Total Pedidos"})]})}),e.jsx(F,{shadow:"sm",borderRadius:"lg",children:e.jsxs(L,{textAlign:"center",p:{base:2,md:4},children:[e.jsx(n,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"orange.600",children:A.confirmed+A.preparing+A.ready}),e.jsx(n,{fontSize:{base:"2xs",md:"sm"},color:"gray.600",noOfLines:1,children:"En Proceso"})]})}),e.jsx(F,{shadow:"sm",borderRadius:"lg",children:e.jsxs(L,{textAlign:"center",p:{base:2,md:4},children:[e.jsx(n,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"green.600",children:A.delivered}),e.jsx(n,{fontSize:{base:"2xs",md:"sm"},color:"gray.600",noOfLines:1,children:"Entregados"})]})}),e.jsx(F,{shadow:"sm",borderRadius:"lg",children:e.jsxs(L,{textAlign:"center",p:{base:2,md:4},children:[e.jsx(n,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"red.600",children:A.cancelled}),e.jsx(n,{fontSize:{base:"2xs",md:"sm"},color:"gray.600",noOfLines:1,children:"Cancelados"})]})})]}),e.jsx(k,{bg:"white",borderRadius:"lg",shadow:"sm",overflow:"hidden",children:e.jsxs(Xa,{index:T==="orders"?0:1,onChange:v=>C(v===0?"orders":"vouchers"),children:[e.jsxs(Qa,{bg:"gray.50",p:1,children:[e.jsx(Zr,{fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},py:{base:2,md:3},_selected:{bg:"white",shadow:"sm"},flex:1,minW:0,children:e.jsxs(u,{spacing:1,children:[e.jsx(or,{size:12}),e.jsxs(n,{fontSize:{base:"2xs",md:"xs"},noOfLines:1,children:["Pedidos (",l.length,")"]})]})}),e.jsx(Zr,{fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},py:{base:2,md:3},_selected:{bg:"white",shadow:"sm"},flex:1,minW:0,children:e.jsxs(u,{spacing:1,children:[e.jsx(ys,{size:12}),e.jsxs(n,{fontSize:{base:"2xs",md:"xs"},noOfLines:1,children:["Vales (",c.length,")"]})]})})]}),e.jsxs(Ja,{children:[e.jsxs(en,{px:{base:2,md:4},py:{base:3,md:4},children:[e.jsx(F,{shadow:"sm",mb:4,children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(u,{spacing:{base:3,md:4},align:"stretch",children:[e.jsxs(U,{children:[e.jsx(G,{fontSize:{base:"sm",md:"md"},children:"Filtrar por Estado"}),e.jsxs(Je,{value:D,onChange:v=>_(v.target.value),size:{base:"sm",md:"md"},children:[e.jsx("option",{value:"all",children:"Todos los pedidos"}),e.jsx("option",{value:"asignado",children:"Asignados"}),e.jsx("option",{value:"en_camino",children:"En Camino"}),e.jsx("option",{value:"entregado",children:"Entregados"})]})]}),e.jsxs(n,{fontSize:{base:"xs",md:"sm"},color:"gray.600",textAlign:"center",children:["Mostrando ",me.length," de ",l.length," pedidos"]})]})})}),me.length>0?e.jsx(u,{spacing:{base:3,md:4},align:"stretch",children:me.map(Re)}):e.jsx(is,{h:"200px",bg:"white",borderRadius:"lg",shadow:"sm",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:or,boxSize:12,color:"gray.400"}),e.jsxs(n,{color:"gray.500",fontSize:{base:"sm",md:"lg"},textAlign:"center",children:["No hay pedidos ",D==="all"?"":`con estado ${ne(D).toLowerCase()}`]}),e.jsx(O,{variant:"outline",size:{base:"sm",md:"md"},onClick:()=>_("all"),children:"Ver todos los pedidos"})]})})]}),e.jsx(en,{px:{base:2,md:4},py:{base:3,md:4},children:e.jsxs(u,{spacing:{base:4,md:6},align:"stretch",children:[e.jsx(k,{bg:"white",p:{base:3,md:4},borderRadius:"lg",shadow:"sm",children:e.jsxs(u,{spacing:2,align:"start",children:[e.jsx(Z,{size:{base:"sm",md:"md"},color:"gray.800",children:"Mis Vales"}),e.jsx(n,{color:"gray.600",fontSize:{base:"xs",md:"sm"},children:"Gestiona los vales que has creado"})]})}),e.jsx(k,{children:e.jsx(O,{colorScheme:"blue",leftIcon:e.jsx(ot,{}),onClick:B,size:{base:"sm",md:"md"},w:"full",children:"Crear Nuevo Vale"})}),c.length>0?e.jsx(u,{spacing:{base:3,md:4},align:"stretch",children:c.map(v=>{var we,Ke;return e.jsx(F,{variant:"outline",shadow:"sm",borderRadius:"lg",children:e.jsx(L,{p:{base:3,md:4},children:e.jsxs(u,{spacing:{base:2,md:3},align:"stretch",children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsxs(n,{fontWeight:"bold",fontSize:{base:"sm",md:"md"},children:["Vale #",v.id]}),e.jsx(ye,{colorScheme:v.status==="pending"?"orange":v.status==="delivered"?"blue":"green",fontSize:{base:"2xs",md:"xs"},children:v.status==="pending"?"Pendiente":v.status==="delivered"?"Entregado":"Pagado"})]}),e.jsxs(u,{spacing:{base:1,md:2},align:"stretch",children:[e.jsxs(h,{spacing:2,children:[e.jsx(qs,{size:12,color:"#718096"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},noOfLines:1,children:((we=v.Client)==null?void 0:we.name)||"Cliente no encontrado"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(or,{size:12,color:"#718096"}),e.jsx(n,{fontSize:{base:"xs",md:"sm"},noOfLines:1,children:((Ke=v.product)==null?void 0:Ke.name)||"Producto no especificado"})]}),e.jsxs(h,{spacing:2,children:[e.jsx(n,{fontSize:{base:"xs",md:"sm"},children:"Cantidad:"}),e.jsx(n,{fontWeight:"bold",fontSize:{base:"xs",md:"sm"},children:v.quantity})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:{base:"xs",md:"sm"},children:"Total:"}),e.jsxs(n,{fontWeight:"bold",color:"green.600",fontSize:{base:"xs",md:"sm"},children:["S/ ",parseFloat(v.totalAmount||0).toFixed(2)]})]})]})]})})},v.id)})}):e.jsx(is,{h:"200px",children:e.jsxs(u,{spacing:4,children:[e.jsx(ge,{as:ys,boxSize:12,color:"gray.400"}),e.jsx(n,{color:"gray.500",fontSize:"lg",children:"No has creado ningún vale aún"}),e.jsx(O,{colorScheme:"blue",leftIcon:e.jsx(ot,{}),onClick:B,children:"Crear tu primer vale"})]})})]})})]})]})}),K(),Ee(),je()]})})},Fl=()=>{const[s,t]=S.useState({username:"",password:""}),[r,a]=S.useState(!1),[i,l]=S.useState(!1),{login:o,error:c}=Rs(),d=tt(),f=ps(),P=m=>{t({...s,[m.target.name]:m.target.value})},I=async m=>{m.preventDefault(),l(!0);try{if((await o(s.username,s.password)).success){const C=Rs.getState().user;C&&C.role==="repartidor"?(f({title:"Bienvenido",description:`Hola ${C.username}, bienvenido al panel de repartidor`,status:"success",duration:3e3,isClosable:!0}),d("/delivery-dashboard")):(f({title:"Acceso Denegado",description:"Esta cuenta no es de un repartidor",status:"error",duration:3e3,isClosable:!0}),Rs.getState().logout())}}catch(T){console.error("Error en login:",T)}finally{l(!1)}};return e.jsx(k,{minH:"100vh",bg:"gray.50",display:"flex",alignItems:"center",justifyContent:"center",p:4,children:e.jsxs(F,{maxW:"md",w:"full",boxShadow:"xl",children:[e.jsx(Pe,{textAlign:"center",pb:2,children:e.jsxs(u,{spacing:4,children:[e.jsx(k,{color:"purple.600",fontSize:"4xl",children:e.jsx(ws,{})}),e.jsx(Z,{size:"lg",color:"gray.700",children:"Panel de Repartidor"}),e.jsx(n,{color:"gray.600",fontSize:"sm",children:"Inicia sesión para gestionar tus pedidos asignados"})]})}),e.jsx(L,{pt:0,children:e.jsx("form",{onSubmit:I,children:e.jsxs(u,{spacing:4,children:[c&&e.jsxs(De,{status:"error",borderRadius:"md",children:[e.jsx(Ie,{}),c]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Usuario"}),e.jsx(re,{name:"username",value:s.username,onChange:P,placeholder:"Ingresa tu usuario",size:"lg",autoComplete:"username"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Contraseña"}),e.jsxs(Ct,{size:"lg",children:[e.jsx(re,{name:"password",type:r?"text":"password",value:s.password,onChange:P,placeholder:"Ingresa tu contraseña"}),e.jsx(kn,{children:e.jsx(_e,{"aria-label":r?"Ocultar contraseña":"Mostrar contraseña",icon:r?e.jsx(Un,{}):e.jsx(Vs,{}),variant:"ghost",onClick:()=>a(!r)})})]})]}),e.jsx(O,{type:"submit",colorScheme:"purple",size:"lg",w:"full",isLoading:i,loadingText:"Iniciando sesión...",leftIcon:e.jsx(ws,{}),children:"Iniciar Sesión"}),e.jsx(hs,{}),e.jsxs(u,{spacing:2,textAlign:"center",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"¿No eres repartidor?"}),e.jsxs(h,{spacing:4,children:[e.jsx(xr,{color:"blue.500",onClick:()=>d("/"),_hover:{textDecoration:"underline"},children:"Panel de Administración"}),e.jsx(n,{color:"gray.400",children:"|"}),e.jsx(xr,{color:"green.500",onClick:()=>d("/client-login"),_hover:{textDecoration:"underline"},children:"Área de Clientes"})]})]})]})})})]})})},Ll=()=>{const[s,t]=S.useState([]),[r,a]=S.useState(!0),i=ps(),l=Ze("white","gray.800"),o=Ze("gray.200","gray.600"),c=Ze("gray.700","gray.200"),d=Ze("blue.50","blue.900"),f=Ze("green.500","green.300"),P=Ze("blue.600","blue.300");S.useEffect(()=>{I()},[]);const I=async()=>{var C;try{a(!0),console.log("🔄 SubscriptionPlansCard: Cargando planes...");const D=await X.get("/api/subscription-plans");console.log("📦 SubscriptionPlansCard: Respuesta:",D.data),t(D.data.data||[]),console.log("✅ SubscriptionPlansCard: Planes cargados:",((C=D.data.data)==null?void 0:C.length)||0)}catch(D){console.error("❌ SubscriptionPlansCard: Error al cargar planes:",D),i({title:"Error",description:"No se pudieron cargar los planes de suscripción",status:"error",duration:3e3,isClosable:!0})}finally{a(!1)}},m=C=>C===0?"Sin bonificación":C===1?"1 recarga mensual gratis":`${C} recargas mensual gratis`,T=C=>{const D=["blue","green","purple","orange","pink","teal","red"];return D[C%D.length]};return r?e.jsx(is,{py:10,children:e.jsxs(u,{spacing:4,children:[e.jsx(Ss,{size:"xl",color:"blue.500"}),e.jsx(n,{color:"gray.500",children:"Cargando planes de suscripción..."})]})}):e.jsxs(k,{children:[e.jsx(F,{bg:d,borderColor:o,mb:6,children:e.jsx(L,{children:e.jsxs(u,{spacing:4,textAlign:"center",children:[e.jsx(Z,{size:"lg",color:c,children:"🚰 Cartilla de Suscripciones AquaYara"}),e.jsx(n,{color:c,fontSize:"lg",children:"Por el pago mensual de cierta cantidad de bidones, recibe bonificaciones por ser un buen cliente"}),e.jsxs(h,{spacing:4,wrap:"wrap",justify:"center",children:[e.jsxs(h,{children:[e.jsx(ge,{as:Ps,color:"green.500"}),e.jsx(n,{fontSize:"sm",children:"Válido solo para clientes que pagan adelantado una mensualidad"})]}),e.jsxs(h,{children:[e.jsx(ge,{as:ws,color:"blue.500"}),e.jsx(n,{fontSize:"sm",children:"Control con sistema y cuaderno con firma"})]}),e.jsxs(h,{children:[e.jsx(ge,{as:no,color:"purple.500"}),e.jsx(n,{fontSize:"sm",children:"Contrato y factura mensual"})]})]})]})})}),e.jsx(os,{columns:{base:1,md:2,lg:3},spacing:6,children:s.map(C=>e.jsxs(F,{bg:l,borderColor:o,borderWidth:"2px",_hover:{transform:"translateY(-4px)",shadow:"lg",borderColor:T(C.sortOrder)+".300"},transition:"all 0.3s ease",position:"relative",children:[C.bonusBottles>0&&e.jsx(k,{position:"absolute",top:-2,right:4,children:e.jsxs(ye,{colorScheme:"green",fontSize:"xs",px:3,py:1,borderRadius:"full",transform:"rotate(15deg)",children:[e.jsx(ge,{as:Wr,mr:1}),parseFloat(C.bonusPercentage).toFixed(1),"% BONUS"]})}),e.jsx(Pe,{pb:2,children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsx(Z,{size:"md",color:c,textAlign:"center",children:C.name}),e.jsx(n,{fontSize:"sm",color:"gray.500",textAlign:"center",children:C.description})]})}),e.jsx(L,{pt:0,children:e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(k,{textAlign:"center",children:[e.jsxs(n,{fontSize:"2xl",fontWeight:"bold",color:P,children:[C.totalBottles," Bidones"]}),C.bonusBottles>0&&e.jsxs(n,{fontSize:"sm",color:f,fontWeight:"semibold",children:["+ ",C.bonusBottles," bonus"]})]}),e.jsx(hs,{}),e.jsxs(u,{spacing:2,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Pago mensual:"}),e.jsxs(n,{fontSize:"lg",fontWeight:"bold",color:P,children:["S/ ",parseFloat(C.monthlyPrice).toFixed(2)]})]}),e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Precio por bidón:"}),e.jsxs(n,{fontSize:"md",fontWeight:"semibold",color:c,children:["S/ ",parseFloat(C.pricePerBottle).toFixed(2)]})]})]}),e.jsx(hs,{}),e.jsxs(k,{textAlign:"center",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",mb:1,children:"Bonificación:"}),e.jsx(n,{fontSize:"md",fontWeight:"semibold",color:f,children:m(C.bonusBottles)})]}),e.jsx(k,{textAlign:"center",children:e.jsxs(h,{justify:"center",spacing:2,children:[e.jsx(ge,{as:ws,color:"blue.500"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["Máx. ",C.maxDailyDelivery," entregas diarias"]})]})}),e.jsx(O,{colorScheme:T(C.sortOrder),size:"md",w:"full",mt:2,_hover:{transform:"scale(1.02)",shadow:"md"},transition:"all 0.2s ease",children:"Seleccionar Plan"})]})})]},C.id))}),e.jsx(F,{bg:l,borderColor:o,mt:6,children:e.jsx(L,{children:e.jsxs(u,{spacing:4,textAlign:"center",children:[e.jsx(Z,{size:"md",color:c,children:"Información Importante"}),e.jsxs(os,{columns:{base:1,md:2},spacing:4,w:"full",children:[e.jsxs(k,{children:[e.jsx(n,{fontWeight:"semibold",color:c,mb:2,children:"Condiciones del Servicio:"}),e.jsxs(u,{spacing:1,align:"start",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Servicio para clientes domésticos y empresariales"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Válido solo para clientes que pagan adelantado una mensualidad"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Control con sistema y cuaderno con firma, fecha, hora y nombre de recepción"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Contrato y factura mensual"})]})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"semibold",color:c,mb:2,children:"Beneficios:"}),e.jsxs(u,{spacing:1,align:"start",children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Descuentos progresivos según cantidad"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Bonificaciones en bidones adicionales"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Entregas programadas y controladas"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:"• Atención prioritaria al cliente"})]})]})]})]})})})]})},Wl=()=>{var se,fe;const[s,t]=S.useState([]),[r,a]=S.useState([]),[i,l]=S.useState([]),[o,c]=S.useState(!0),[d,f]=S.useState(""),[P,I]=S.useState("all"),[m,T]=S.useState(null),[C,D]=S.useState("management"),{isOpen:_,onOpen:y,onClose:z}=Le(),{isOpen:E,onOpen:N,onClose:$}=Le(),{isOpen:R,onOpen:p,onClose:H}=Le(),[b,ae]=S.useState({clientId:"",planId:"",startDate:"",notes:""}),[g,B]=S.useState({id:"",status:"",remainingBottles:"",notes:""}),V=ps();Hs({base:!0,md:!1});const te=Ze("white","gray.800"),Ce=Ze("gray.200","gray.600");S.useEffect(()=>{xe()},[]);const xe=async()=>{c(!0);try{const[W,Re]=await Promise.all([X.get("/api/clients"),X.get("/api/subscriptions")]);t(Re.data.data||[]),a(W.data.data||[]),l([{id:1,name:"Plan Básico",bottles:20,bonus:2,price:100,description:"20 bidones + 2 extra"},{id:2,name:"Plan Intermedio",bottles:30,bonus:5,price:150,description:"30 bidones + 5 extra"},{id:3,name:"Plan Premium",bottles:50,bonus:10,price:250,description:"50 bidones + 10 extra"}])}catch(W){console.error("Error al cargar datos:",W),V({title:"Error",description:"No se pudieron cargar los datos",status:"error",duration:3e3,isClosable:!0})}finally{c(!1)}},Ae=(Array.isArray(s)?s:[]).filter(W=>{var Ee,je,v,we;const Re=((je=(Ee=W.client)==null?void 0:Ee.name)==null?void 0:je.toLowerCase().includes(d.toLowerCase()))||((we=(v=W.client)==null?void 0:v.email)==null?void 0:we.toLowerCase().includes(d.toLowerCase())),K=P==="all"||W.status===P;return Re&&K}),Ne=W=>{switch(W){case"active":return"green";case"paused":return"yellow";case"cancelled":return"red";case"expired":return"gray";default:return"gray"}},w=W=>{switch(W){case"active":return"Activa";case"paused":return"Pausada";case"cancelled":return"Cancelada";case"expired":return"Expirada";default:return"Desconocido"}},Q=W=>new Date(W).toLocaleDateString("es-ES"),ne=async()=>{try{const W=r.find(Ee=>Ee.id===parseInt(b.clientId)),Re=i.find(Ee=>Ee.id===parseInt(b.planId));if(!W||!Re){V({title:"Error",description:"Cliente o plan no encontrado",status:"error",duration:3e3,isClosable:!0});return}const K={clientId:W.id,clientDni:W.documentNumber,subscriptionType:Re.name,totalBottles:Re.bottles+Re.bonus,totalAmount:Re.price,paidAmount:Re.price,expiryDate:null,notes:b.notes};await X.post("/api/subscriptions",K),V({title:"Suscripción creada",description:"La suscripción se ha creado correctamente",status:"success",duration:3e3,isClosable:!0}),z(),ae({clientId:"",planId:"",startDate:"",notes:""}),xe()}catch(W){console.error("Error al crear suscripción:",W),V({title:"Error",description:"No se pudo crear la suscripción",status:"error",duration:3e3,isClosable:!0})}},de=async()=>{try{await X.put(`/api/subscriptions/${g.id}`,g),V({title:"Suscripción actualizada",description:"La suscripción se ha actualizado correctamente",status:"success",duration:3e3,isClosable:!0}),$(),B({id:"",status:"",remainingBottles:"",notes:""}),xe()}catch(W){console.error("Error al actualizar suscripción:",W),V({title:"Error",description:"No se pudo actualizar la suscripción",status:"error",duration:3e3,isClosable:!0})}},A=W=>{T(W),p()},me=W=>{B({id:W.id,status:W.status,remainingBottles:W.remainingBottles,notes:W.notes||""}),N()},M=s.filter(W=>W.status==="active").length,Y=s.filter(W=>W.status==="active").reduce((W,Re)=>{var K;return W+(((K=Re.plan)==null?void 0:K.price)||0)},0);return o?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsx(k,{p:6,children:e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(vs,{justify:"space-between",align:"center",wrap:"wrap",gap:4,children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsxs(Z,{size:"lg",children:[e.jsx(ge,{as:_s,mr:2}),"Gestión de Suscripciones"]}),e.jsx(n,{color:"gray.600",children:"Administra las suscripciones de clientes frecuentes"})]}),e.jsxs(h,{spacing:4,children:[e.jsx(O,{leftIcon:e.jsx(ao,{}),colorScheme:C==="management"?"blue":"gray",variant:C==="management"?"solid":"outline",onClick:()=>D("management"),children:"Gestión"}),e.jsx(O,{leftIcon:e.jsx(Wr,{}),colorScheme:C==="plans"?"blue":"gray",variant:C==="plans"?"solid":"outline",onClick:()=>D("plans"),children:"Cartilla de Planes"}),C==="management"&&e.jsx(O,{leftIcon:e.jsx(ot,{}),colorScheme:"blue",onClick:y,size:"lg",children:"Nueva Suscripción"})]})]}),C==="plans"?e.jsx(Ll,{}):e.jsxs(e.Fragment,{children:[e.jsxs(os,{columns:{base:1,md:3},spacing:4,children:[e.jsx(F,{bg:te,borderColor:Ce,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Total Suscripciones"}),e.jsx(Xe,{children:s.length}),e.jsxs(Qe,{children:[e.jsx(Ka,{type:"increase"}),M," activas"]})]})})}),e.jsx(F,{bg:te,borderColor:Ce,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Ingresos Mensuales"}),e.jsxs(Xe,{children:["S/ ",Y.toFixed(2)]}),e.jsx(Qe,{children:"De suscripciones activas"})]})})}),e.jsx(F,{bg:te,borderColor:Ce,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Planes Disponibles"}),e.jsx(Xe,{children:i.length}),e.jsx(Qe,{children:"Planes de suscripción"})]})})})]}),e.jsx(F,{bg:te,borderColor:Ce,children:e.jsx(L,{children:e.jsxs(h,{spacing:4,wrap:"wrap",children:[e.jsxs(Ct,{maxW:"300px",children:[e.jsx(kr,{pointerEvents:"none",children:e.jsx(ge,{as:Xn,color:"gray.300"})}),e.jsx(re,{placeholder:"Buscar por cliente...",value:d,onChange:W=>f(W.target.value)})]}),e.jsxs(Je,{value:P,onChange:W=>I(W.target.value),maxW:"200px",children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"active",children:"Activas"}),e.jsx("option",{value:"paused",children:"Pausadas"}),e.jsx("option",{value:"cancelled",children:"Canceladas"}),e.jsx("option",{value:"expired",children:"Expiradas"})]})]})})}),e.jsxs(F,{bg:te,borderColor:Ce,children:[e.jsx(Pe,{children:e.jsx(Z,{size:"md",children:"Suscripciones"})}),e.jsx(L,{children:Ae.length===0?e.jsx(is,{py:10,children:e.jsx(n,{color:"gray.500",fontSize:"lg",children:"No hay suscripciones registradas"})}):e.jsx(Za,{children:e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Cliente"}),e.jsx(oe,{children:"Plan"}),e.jsx(oe,{children:"Estado"}),e.jsx(oe,{children:"Bidones Restantes"}),e.jsx(oe,{children:"Fecha Inicio"}),e.jsx(oe,{children:"Duración"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:(Array.isArray(Ae)?Ae:[]).map(W=>{var Re,K;return e.jsxs(ms,{children:[e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:((Re=W.client)==null?void 0:Re.name)||"N/A"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:((K=W.client)==null?void 0:K.email)||"N/A"})]})}),e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:W.subscriptionType||"N/A"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["S/ ",W.totalAmount||0]})]})}),e.jsx(le,{children:e.jsx(ye,{colorScheme:Ne(W.status),children:w(W.status)})}),e.jsx(le,{children:e.jsx(n,{fontWeight:"bold",color:"blue.600",children:W.remainingBottles||0})}),e.jsx(le,{children:Q(W.purchaseDate)}),e.jsx(le,{children:e.jsx(n,{color:"green.600",fontWeight:"bold",children:"Hasta agotar bidones"})}),e.jsx(le,{children:e.jsxs(An,{children:[e.jsx(En,{as:O,size:"sm",variant:"ghost",children:e.jsx(ge,{as:so})}),e.jsxs(Tn,{children:[e.jsx(gr,{icon:e.jsx(Vs,{}),onClick:()=>A(W),children:"Ver Detalles"}),e.jsx(gr,{icon:e.jsx(wr,{}),onClick:()=>me(W),children:"Editar"})]})]})})]},W.id)})})]})})})]}),e.jsxs(Ve,{isOpen:_,onClose:z,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Nueva Suscripción"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Cliente"}),e.jsx(Je,{placeholder:"Seleccionar cliente",value:b.clientId,onChange:W=>ae({...b,clientId:W.target.value}),children:(Array.isArray(r)?r:[]).map(W=>e.jsxs("option",{value:W.id,children:[W.name," - ",W.email]},W.id))})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Plan de Suscripción"}),e.jsx(Je,{placeholder:"Seleccionar plan",value:b.planId,onChange:W=>ae({...b,planId:W.target.value}),children:(Array.isArray(i)?i:[]).map(W=>e.jsxs("option",{value:W.id,children:[W.name," - S/ ",W.price," (",W.bottles+W.bonus," bidones)"]},W.id))})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Fecha de Inicio"}),e.jsx(re,{type:"date",value:b.startDate,onChange:W=>ae({...b,startDate:W.target.value})})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas"}),e.jsx(ks,{placeholder:"Notas adicionales...",value:b.notes,onChange:W=>ae({...b,notes:W.target.value})})]})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"ghost",mr:3,onClick:z,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",onClick:ne,children:"Crear Suscripción"})]})]})]}),e.jsxs(Ve,{isOpen:E,onClose:$,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Editar Suscripción"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Estado"}),e.jsxs(Je,{value:g.status,onChange:W=>B({...g,status:W.target.value}),children:[e.jsx("option",{value:"active",children:"Activa"}),e.jsx("option",{value:"paused",children:"Pausada"}),e.jsx("option",{value:"cancelled",children:"Cancelada"}),e.jsx("option",{value:"expired",children:"Expirada"})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Bidones Restantes"}),e.jsxs(In,{value:g.remainingBottles,onChange:W=>B({...g,remainingBottles:W}),min:0,children:[e.jsx(_n,{}),e.jsxs(ei,{children:[e.jsx(si,{}),e.jsx(ti,{})]})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas"}),e.jsx(ks,{placeholder:"Notas adicionales...",value:g.notes,onChange:W=>B({...g,notes:W.target.value})})]})]})}),e.jsxs(As,{children:[e.jsx(O,{variant:"ghost",mr:3,onClick:$,children:"Cancelar"}),e.jsx(O,{colorScheme:"blue",onClick:de,children:"Actualizar Suscripción"})]})]})]}),e.jsxs(Ve,{isOpen:R,onClose:H,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Detalles de la Suscripción"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:m&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(os,{columns:2,spacing:4,children:[e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Cliente:"}),e.jsx(n,{children:((se=m.client)==null?void 0:se.name)||"N/A"})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Email:"}),e.jsx(n,{children:((fe=m.client)==null?void 0:fe.email)||"N/A"})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Tipo de Suscripción:"}),e.jsx(n,{children:m.subscriptionType||"N/A"})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Total Pagado:"}),e.jsxs(n,{children:["S/ ",m.totalAmount||0]})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Estado:"}),e.jsx(ye,{colorScheme:Ne(m.status),children:w(m.status)})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Bidones Restantes:"}),e.jsx(n,{fontWeight:"bold",color:"blue.600",children:m.remainingBottles||0})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Fecha de Compra:"}),e.jsx(n,{children:Q(m.purchaseDate)})]}),e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Duración:"}),e.jsx(n,{color:"green.600",fontWeight:"bold",children:"Hasta agotar bidones"})]})]}),m.notes&&e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",color:"gray.600",children:"Notas:"}),e.jsx(n,{children:m.notes})]})]})})]})]})]}),e.jsx(va,{})]})})},Ml=()=>{var ae;const[s,t]=S.useState([]),[r,a]=S.useState(!1),[i,l]=S.useState(null),[o,c]=S.useState(new Date),{isOpen:d,onOpen:f,onClose:P}=Le(),{isOpen:I,onOpen:m,onClose:T}=Le();Le();const C=ps(),[D,_]=S.useState({clientId:"",amount:"",description:"",dueDate:"",status:"active"}),[y,z]=S.useState([]);S.useEffect(()=>{N(),E();const g=setInterval(()=>{N(),c(new Date)},3e4);return()=>clearInterval(g)},[]);const E=async()=>{try{const g=await X.get("/api/clients");g.data.success&&z(g.data.data||[])}catch(g){console.error("Error al cargar clientes:",g)}},N=async()=>{var g;try{a(!0),console.log("🔍 Cargando vales agrupados por pedido desde /api/vouchers/by-order...");const B=await X.get("/api/vouchers/by-order");console.log("📦 Respuesta de vales agrupados:",B.data),B.data.success&&(t(B.data.data||[]),console.log(`✅ Vales agrupados cargados: ${((g=B.data.data)==null?void 0:g.length)||0} pedidos`))}catch(B){console.error("Error al cargar vales:",B),C({title:"Error",description:"No se pudieron cargar los vales",status:"error",duration:3e3,isClosable:!0})}finally{a(!1)}},$=async()=>{try{(await X.post("/api/vouchers",D)).data.success&&(C({title:"Vale creado",description:"El vale se ha creado exitosamente",status:"success",duration:3e3,isClosable:!0}),N(),P(),_({clientId:"",amount:"",description:"",dueDate:"",status:"active"}))}catch(g){console.error("Error al crear vale:",g),C({title:"Error",description:"No se pudo crear el vale",status:"error",duration:3e3,isClosable:!0})}},R=g=>{switch(g){case"pending":return"yellow";case"delivered":return"green";case"paid":return"blue";case"cancelled":return"red";default:return"gray"}},p=g=>{switch(g){case"pending":return"Pendiente";case"delivered":return"Entregado";case"paid":return"Pagado";case"cancelled":return"Cancelado";default:return g}},H=g=>{switch(g){case"pending":return _s;case"delivered":return Ps;case"paid":return ys;case"cancelled":return co;default:return Ps}},b={total:s.length,pending:s.filter(g=>g.status==="pending").length,delivered:s.filter(g=>g.status==="delivered").length,paid:s.filter(g=>g.status==="paid").length,totalAmount:s.reduce((g,B)=>g+parseFloat(B.totalAmount||0),0),pendingAmount:s.filter(g=>g.status==="pending").reduce((g,B)=>g+parseFloat(B.totalAmount||0),0),deliveredAmount:s.filter(g=>g.status==="delivered").reduce((g,B)=>g+parseFloat(B.totalAmount||0),0)};return e.jsxs(k,{p:6,children:[e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(vs,{justify:"space-between",align:"center",children:[e.jsxs(k,{children:[e.jsx(Z,{size:"lg",mb:2,children:"Gestión de Vales"}),e.jsx(n,{color:"gray.600",children:"Administra los vales de crédito de los clientes"}),e.jsxs(n,{color:"gray.400",fontSize:"xs",children:["Última actualización: ",o.toLocaleTimeString()]})]}),e.jsx(O,{size:"sm",colorScheme:"blue",variant:"outline",onClick:()=>{N(),c(new Date)},isLoading:r,children:"Actualizar"})]}),e.jsxs(os,{columns:{base:1,sm:2,lg:4},spacing:4,children:[e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Total Vales"}),e.jsx(Xe,{color:"blue.500",children:b.total}),e.jsx(Qe,{children:"Vales creados"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Pendientes"}),e.jsx(Xe,{color:"yellow.500",children:b.pending}),e.jsx(Qe,{children:"Por entregar"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Entregados"}),e.jsx(Xe,{color:"green.500",children:b.delivered}),e.jsx(Qe,{children:"Completados"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Pagados"}),e.jsx(Xe,{color:"blue.500",children:b.paid}),e.jsx(Qe,{children:"Cobrados"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Monto Total"}),e.jsxs(Xe,{color:"purple.500",children:["S/ ",b.totalAmount.toFixed(2)]}),e.jsx(Qe,{children:"En vales"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Pendiente"}),e.jsxs(Xe,{color:"yellow.500",children:["S/ ",b.pendingAmount.toFixed(2)]}),e.jsx(Qe,{children:"Por entregar"})]})})})]}),e.jsxs(F,{children:[e.jsx(Pe,{children:e.jsxs(vs,{justify:"space-between",align:"center",children:[e.jsx(Z,{size:"md",children:"Lista de Vales"}),e.jsx(O,{leftIcon:e.jsx(ot,{}),colorScheme:"green",onClick:f,children:"Nuevo Vale"})]})}),e.jsx(L,{children:s.length===0?e.jsxs(De,{status:"info",children:[e.jsx(Ie,{}),e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(n,{fontWeight:"bold",children:"No hay vales registrados"}),e.jsxs(n,{fontSize:"sm",children:['Los vales se crean automáticamente cuando los clientes eligen la modalidad "vale" en sus pedidos.',e.jsx("br",{}),'Puedes crear vales manualmente usando el botón "Crear Vale" arriba.']})]})]}):e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Cliente"}),e.jsx(oe,{children:"Productos del Pedido"}),e.jsx(oe,{children:"Total del Pedido"}),e.jsx(oe,{children:"Estado"}),e.jsx(oe,{children:"Fecha Creación"}),e.jsx(oe,{children:"Fecha Vencimiento"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:s.map(g=>{var B,V;return e.jsxs(ms,{children:[e.jsx(le,{children:e.jsxs(u,{spacing:1,align:"start",children:[e.jsxs(h,{children:[e.jsx(qs,{size:14,color:"#718096"}),e.jsx(n,{fontWeight:"medium",children:((B=g.client)==null?void 0:B.name)||"Cliente no encontrado"})]}),e.jsxs(n,{fontSize:"xs",color:"gray.500",children:["DNI: ",((V=g.client)==null?void 0:V.documentNumber)||"N/A"]})]})}),e.jsx(le,{children:e.jsxs(u,{spacing:1,align:"start",children:[(g.products||[]).map((te,Ce)=>e.jsxs(n,{fontSize:"sm",children:[te.name," x",te.quantity]},Ce)),(!g.products||g.products.length===0)&&e.jsx(n,{fontSize:"sm",color:"gray.500",children:"Sin productos"})]})}),e.jsxs(le,{children:[e.jsxs(n,{fontWeight:"bold",color:"green.600",children:["S/ ",parseFloat(g.totalAmount||0).toFixed(2)]}),e.jsxs(n,{fontSize:"xs",color:"gray.500",children:["Pedido #",g.guestOrderId||"Individual"]})]}),e.jsx(le,{children:e.jsxs(mr,{colorScheme:R(g.status),children:[e.jsx(sn,{as:H(g.status)}),e.jsx(fr,{children:p(g.status)})]})}),e.jsxs(le,{children:[e.jsx(n,{fontSize:"sm",children:g.createdAt?new Date(g.createdAt).toLocaleDateString():"Sin fecha"}),e.jsx(n,{fontSize:"xs",color:"gray.500",children:g.createdAt?new Date(g.createdAt).toLocaleTimeString():""})]}),e.jsxs(le,{children:[e.jsx(n,{fontSize:"sm",color:g.dueDate&&new Date(g.dueDate)<new Date?"red.500":"gray.700",children:g.dueDate?new Date(g.dueDate).toLocaleDateString():"Sin vencimiento"}),g.dueDate&&new Date(g.dueDate)<new Date&&e.jsx(n,{fontSize:"xs",color:"red.500",fontWeight:"bold",children:"VENCIDO"})]}),e.jsx(le,{children:e.jsx(h,{spacing:2,children:e.jsx(Oe,{label:"Ver detalles",children:e.jsx(_e,{size:"sm",icon:e.jsx(Vs,{}),onClick:()=>{l(g),m()}})})})})]},g.id)})})]})})]})]}),e.jsxs(Ve,{isOpen:d,onClose:P,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Crear Nuevo Vale"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Cliente"}),e.jsx(Je,{value:D.clientId,onChange:g=>_({...D,clientId:g.target.value}),placeholder:"Selecciona un cliente",children:y.map(g=>e.jsxs("option",{value:g.id,children:[g.name," - ",g.email]},g.id))})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Monto"}),e.jsx(re,{type:"number",value:D.amount,onChange:g=>_({...D,amount:g.target.value}),placeholder:"0.00"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Descripción"}),e.jsx(ks,{value:D.description,onChange:g=>_({...D,description:g.target.value}),placeholder:"Descripción del vale"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Fecha de Vencimiento"}),e.jsx(re,{type:"date",value:D.dueDate,onChange:g=>_({...D,dueDate:g.target.value})})]}),e.jsx(O,{colorScheme:"green",w:"full",onClick:$,leftIcon:e.jsx(ot,{}),children:"Crear Vale"})]})})]})]}),e.jsxs(Ve,{isOpen:I,onClose:T,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Detalles del Vale"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:i&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Cliente:"}),e.jsx(n,{children:((ae=i.client)==null?void 0:ae.name)||"Cliente no encontrado"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Monto:"}),e.jsxs(n,{color:"green.600",fontWeight:"bold",children:["S/ ",parseFloat(i.amount||0).toFixed(2)]})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Estado:"}),e.jsxs(mr,{colorScheme:R(i.status),children:[e.jsx(sn,{as:H(i.status)}),e.jsx(fr,{children:p(i.status)})]})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Fecha de Vencimiento:"}),e.jsx(n,{children:i.dueDate?new Date(i.dueDate).toLocaleDateString():"Sin fecha"})]}),i.description&&e.jsxs(k,{children:[e.jsx(n,{fontWeight:"bold",mb:2,children:"Descripción:"}),e.jsx(n,{children:i.description})]})]})})]})]})]})},$l=()=>{const[s,t]=S.useState(null),[r,a]=S.useState(!1),[i,l]=S.useState(new Date().getFullYear()),[o,c]=S.useState(new Date().getMonth()+1),[d,f]=S.useState(null),{isOpen:P,onOpen:I,onClose:m}=Le(),T=ps(),C=Ze("white","gray.800"),D=Ze("gray.200","gray.600");S.useEffect(()=>{_()},[i,o]);const _=async()=>{try{a(!0);const p=await X.get(`/api/reports/collection?year=${i}&month=${o}`);p.data.success&&(console.log("🔍 Datos del reporte de cobranza recibidos:",p.data.data),p.data.data.clients&&p.data.data.clients.length>0&&console.log("🔍 Primer cliente:",p.data.data.clients[0]),t(p.data.data))}catch(p){console.error("Error al cargar reporte:",p),T({title:"Error",description:"No se pudo cargar el reporte de cobranza",status:"error",duration:3e3,isClosable:!0})}finally{a(!1)}},y=p=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][p-1],z=p=>{const H=parseFloat(p)||0;return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(H)},E=p=>new Date(p).toLocaleDateString("es-ES"),N=p=>{f(p),I()},$=()=>{const p=new Date().getFullYear(),H=[];for(let b=p;b>=p-2;b--)H.push(b);return H},R=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];return r?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsx(k,{p:6,children:e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(vs,{justify:"space-between",align:"center",wrap:"wrap",gap:4,children:[e.jsxs(k,{children:[e.jsx(Z,{size:"lg",mb:2,children:e.jsxs(h,{children:[e.jsx(Gn,{}),e.jsx(n,{children:"Reporte de Cobranza Mensual"})]})}),e.jsx(n,{color:"gray.600",children:"Total de deudas por cliente en vales pendientes de pago"})]}),e.jsx(O,{leftIcon:e.jsx(Fr,{}),colorScheme:"blue",variant:"outline",onClick:_,isLoading:r,children:"Actualizar"})]}),e.jsx(F,{bg:C,borderColor:D,children:e.jsx(L,{children:e.jsxs(h,{spacing:4,wrap:"wrap",children:[e.jsx(Je,{value:i,onChange:p=>l(parseInt(p.target.value)),maxW:"150px",children:$().map(p=>e.jsx("option",{value:p,children:p},p))}),e.jsx(Je,{value:o,onChange:p=>c(parseInt(p.target.value)),maxW:"200px",children:R.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]})})}),s?e.jsxs(e.Fragment,{children:[e.jsxs(os,{columns:{base:1,md:3},spacing:4,children:[e.jsx(F,{bg:C,borderColor:D,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Período"}),e.jsxs(Xe,{fontSize:"lg",children:[y(s.period.month)," ",s.period.year]}),e.jsxs(Qe,{children:[e.jsx(_s,{style:{display:"inline",marginRight:"4px"}}),"Reporte mensual"]})]})})}),e.jsx(F,{bg:C,borderColor:D,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Clientes con Deuda"}),e.jsx(Xe,{color:"orange.500",children:s.summary.totalClients}),e.jsxs(Qe,{children:[e.jsx(Qn,{style:{display:"inline",marginRight:"4px"}}),"Clientes pendientes"]})]})})}),e.jsx(F,{bg:C,borderColor:D,children:e.jsx(L,{children:e.jsxs(Ge,{children:[e.jsx(Ye,{children:"Total a Cobrar"}),e.jsx(Xe,{color:"red.500",children:z(s.summary.totalDebt)}),e.jsxs(Qe,{children:[e.jsx(ys,{style:{display:"inline",marginRight:"4px"}}),"Monto total"]})]})})})]}),e.jsxs(F,{bg:C,borderColor:D,children:[e.jsx(Pe,{children:e.jsx(Z,{size:"md",children:"Clientes con Deuda Pendiente"})}),e.jsx(L,{children:s.clients.length===0?e.jsxs(De,{status:"success",children:[e.jsx(Ie,{}),e.jsx(n,{children:"¡Excelente! No hay deudas pendientes para este período."})]}):e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Cliente"}),e.jsx(oe,{children:"Contacto"}),e.jsx(oe,{children:"Total Deuda"}),e.jsx(oe,{children:"Vales"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:(s.clients||[]).map(p=>(console.log("🔍 Renderizando cliente:",{name:p.client.name,remainingAmount:p.remainingAmount,totalAmount:p.totalAmount,valesCount:p.valesCount}),e.jsxs(ms,{children:[e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:p.client.name}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["DNI: ",p.client.documentNumber]})]})}),e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsxs(h,{children:[e.jsx(Ks,{size:12,color:"#718096"}),e.jsx(n,{fontSize:"sm",children:p.client.phone})]}),e.jsxs(h,{children:[e.jsx(Lr,{size:12,color:"#718096"}),e.jsx(n,{fontSize:"sm",children:p.client.email})]})]})}),e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",color:"red.600",fontSize:"lg",children:z(p.remainingAmount||0)}),e.jsxs(n,{fontSize:"xs",color:"gray.500",children:["De ",z(p.totalAmount||0)," total"]})]})}),e.jsx(le,{children:e.jsx(mr,{colorScheme:"blue",children:e.jsxs(fr,{children:[p.valesCount||0," vales"]})})}),e.jsx(le,{children:e.jsx(Oe,{label:"Ver detalles de vales",children:e.jsx(_e,{size:"sm",icon:e.jsx(Vs,{}),onClick:()=>N(p)})})})]},p.client.id)))})]})})]})]}):e.jsxs(De,{status:"info",children:[e.jsx(Ie,{}),e.jsx(n,{children:"Selecciona un período para generar el reporte de cobranza."})]}),e.jsxs(Ve,{isOpen:P,onClose:m,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsxs(Me,{children:["Detalles de Vales - ",d==null?void 0:d.client.name]}),e.jsx(He,{}),e.jsx($e,{pb:6,children:d&&e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Cliente:"}),e.jsx(n,{children:d.client.name})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Total Deuda:"}),e.jsx(n,{color:"red.600",fontWeight:"bold",fontSize:"lg",children:z(d.remainingAmount)})]}),e.jsx(hs,{}),e.jsx(n,{fontWeight:"bold",children:"Detalle de Vales:"}),(d.vouchers||d.vales||[]).map((p,H)=>e.jsx(F,{variant:"outline",size:"sm",children:e.jsx(L,{children:e.jsxs(u,{spacing:2,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsxs(n,{fontWeight:"bold",children:["Vale #",p.id]}),e.jsx(n,{fontSize:"sm",color:"gray.500",children:E(p.createdAt)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontSize:"sm",children:"Monto Original:"}),e.jsx(n,{fontSize:"sm",children:z(p.amount)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontSize:"sm",children:"Usado:"}),e.jsx(n,{fontSize:"sm",color:"green.600",children:z(p.usedAmount)})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontSize:"sm",fontWeight:"bold",children:"Pendiente:"}),e.jsx(n,{fontSize:"sm",fontWeight:"bold",color:"red.600",children:z(p.remainingAmount)})]}),p.description&&e.jsx(n,{fontSize:"xs",color:"gray.500",children:p.description})]})})},p.id))]})})]})]})]})})},Bl=()=>{const s=ps(),t=Hs({base:!0,md:!1}),{isOpen:r,onOpen:a,onClose:i}=Le(),{isOpen:l,onOpen:o,onClose:c}=Le(),{isOpen:d,onOpen:f,onClose:P}=Le(),{districts:I,fetchDistricts:m}=Ur(),[T,C]=S.useState([]),[D,_]=S.useState(!0),[y,z]=S.useState(new Date),[E,N]=S.useState(null),[$,R]=S.useState(""),[p,H]=S.useState("all"),[b,ae]=S.useState("all"),[g,B]=S.useState({name:"",document:"",phone:"",email:"",address:"",district:"",reference:"",notes:""}),V=async()=>{try{_(!0);const A=await X.get("/api/clients");A.data.success&&(C(A.data.data),z(new Date))}catch(A){console.error("Error al cargar clientes:",A),s({title:"Error",description:"No se pudieron cargar los clientes",status:"error",duration:3e3,isClosable:!0})}finally{_(!1)}};S.useEffect(()=>{V(),m();const A=setInterval(V,3e4);return()=>clearInterval(A)},[]);const te=async()=>{var A,me;try{(await X.post("/api/clients",g)).data.success&&(s({title:"Cliente creado",description:"El cliente se ha registrado exitosamente",status:"success",duration:3e3,isClosable:!0}),V(),i(),w())}catch(M){console.error("Error al crear cliente:",M),s({title:"Error",description:((me=(A=M.response)==null?void 0:A.data)==null?void 0:me.message)||"No se pudo crear el cliente",status:"error",duration:3e3,isClosable:!0})}},Ce=async()=>{var A,me;try{(await X.put(`/api/clients/${E.id}`,g)).data.success&&(s({title:"Cliente actualizado",description:"Los datos del cliente se han actualizado",status:"success",duration:3e3,isClosable:!0}),V(),c(),w())}catch(M){console.error("Error al actualizar cliente:",M),s({title:"Error",description:((me=(A=M.response)==null?void 0:A.data)==null?void 0:me.message)||"No se pudo actualizar el cliente",status:"error",duration:3e3,isClosable:!0})}},xe=async A=>{if(window.confirm("¿Estás seguro de que quieres eliminar este cliente?"))try{(await X.delete(`/api/clients/${A}`)).data.success&&(s({title:"Cliente eliminado",description:"El cliente ha sido eliminado exitosamente",status:"success",duration:3e3,isClosable:!0}),V())}catch(me){console.error("Error al eliminar cliente:",me),s({title:"Error",description:"No se pudo eliminar el cliente",status:"error",duration:3e3,isClosable:!0})}},Ae=A=>{N(A),B({name:A.name||"",document:A.documentNumber||"",phone:A.phone||"",email:A.email||"",address:A.address||"",district:A.district||"",reference:A.reference||"",notes:A.notes||""}),o()},Ne=A=>{N(A),f()},w=()=>{B({name:"",document:"",phone:"",email:"",address:"",district:"",reference:"",notes:""}),N(null)},Q=T.filter(A=>{const me=A.name.toLowerCase().includes($.toLowerCase())||A.documentNumber.includes($)||A.phone.includes($),M=p==="all"||A.status===p,Y=b==="all"||A.district===b;return me&&M&&Y}),ne=T.length,de=T.filter(A=>A.status==="active").length;return D?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsxs(k,{p:6,children:[e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(vs,{justify:"space-between",align:"center",wrap:"wrap",gap:4,children:[e.jsxs(u,{align:"start",spacing:2,children:[e.jsx(Z,{size:"lg",color:"blue.600",children:"Gestión de Clientes"}),e.jsx(n,{color:"gray.600",children:"Administra la información de tus clientes"})]}),e.jsxs(h,{spacing:4,children:[e.jsx(O,{leftIcon:e.jsx(ln,{}),onClick:V,variant:"outline",children:"Actualizar"}),e.jsx(O,{leftIcon:e.jsx(ot,{}),onClick:a,colorScheme:"blue",children:"Nuevo Cliente"})]})]}),e.jsxs(os,{columns:{base:1,md:3},spacing:4,children:[e.jsx(F,{children:e.jsx(L,{children:e.jsxs(h,{justify:"space-between",children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Total Clientes"}),e.jsx(n,{fontSize:"2xl",fontWeight:"bold",color:"blue.600",children:ne})]}),e.jsx(qs,{size:24,color:"#3182CE"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(h,{justify:"space-between",children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Clientes Activos"}),e.jsx(n,{fontSize:"2xl",fontWeight:"bold",color:"green.600",children:de})]}),e.jsx(qs,{size:24,color:"#38A169"})]})})}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(h,{justify:"space-between",children:[e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontSize:"sm",color:"gray.600",children:"Última Actualización"}),e.jsx(n,{fontSize:"sm",fontWeight:"bold",color:"gray.600",children:y.toLocaleTimeString()})]}),e.jsx(ln,{size:20,color:"#718096"})]})})})]}),e.jsx(F,{children:e.jsx(L,{children:e.jsxs(h,{spacing:4,wrap:"wrap",children:[e.jsx(re,{placeholder:"Buscar por nombre, DNI o teléfono...",value:$,onChange:A=>R(A.target.value),maxW:"300px"}),e.jsxs(Je,{value:p,onChange:A=>H(A.target.value),maxW:"200px",children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"inactive",children:"Inactivos"})]}),e.jsxs(Je,{value:b,onChange:A=>ae(A.target.value),maxW:"200px",placeholder:"Seleccionar distrito",children:[e.jsx("option",{value:"all",children:"Todos los distritos"}),I.map(A=>e.jsx("option",{value:A.name,children:A.name},A.id))]}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>{R(""),H("all"),ae("all")},children:"Limpiar Filtros"})]})})}),e.jsxs(F,{children:[e.jsx(Pe,{children:e.jsxs(h,{justify:"space-between",children:[e.jsx(Z,{size:"md",children:"Lista de Clientes"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["Mostrando ",Q.length," de ",ne," clientes",b!=="all"&&` en ${b}`,p!=="all"&&` (${p==="active"?"Activos":"Inactivos"})`]})]})}),e.jsx(L,{children:t?e.jsx(u,{spacing:4,children:Q.map(A=>e.jsx(F,{w:"full",variant:"outline",children:e.jsx(L,{children:e.jsxs(u,{align:"start",spacing:3,children:[e.jsxs(h,{justify:"space-between",w:"full",children:[e.jsx(n,{fontWeight:"bold",children:A.name}),e.jsx(ye,{colorScheme:A.status==="active"?"green":"gray",children:A.status==="active"?"Activo":"Inactivo"})]}),e.jsxs(u,{align:"start",spacing:1,w:"full",children:[e.jsxs(h,{children:[e.jsx(Yn,{size:14,color:"#718096"}),e.jsxs(n,{fontSize:"sm",color:"gray.600",children:["DNI: ",A.documentNumber]})]}),e.jsxs(h,{children:[e.jsx(Ks,{size:14,color:"#718096"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:A.phone})]}),e.jsxs(h,{children:[e.jsx(vt,{size:14,color:"#718096"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:A.district})]})]}),e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Ver detalles",children:e.jsx(_e,{icon:e.jsx(Vs,{}),size:"sm",onClick:()=>Ne(A)})}),e.jsx(Oe,{label:"Editar",children:e.jsx(_e,{icon:e.jsx(wr,{}),size:"sm",colorScheme:"blue",onClick:()=>Ae(A)})}),e.jsx(Oe,{label:"Eliminar",children:e.jsx(_e,{icon:e.jsx(cn,{}),size:"sm",colorScheme:"red",onClick:()=>xe(A.id)})})]})]})})},A.id))}):e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Cliente"}),e.jsx(oe,{children:"DNI"}),e.jsx(oe,{children:"Teléfono"}),e.jsx(oe,{children:"Distrito"}),e.jsx(oe,{children:"Estado"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:Q.map(A=>e.jsxs(ms,{children:[e.jsx(le,{children:e.jsxs(u,{align:"start",spacing:1,children:[e.jsx(n,{fontWeight:"bold",children:A.name}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:A.email})]})}),e.jsx(le,{children:A.documentNumber}),e.jsx(le,{children:A.phone}),e.jsx(le,{children:A.district}),e.jsx(le,{children:e.jsx(ye,{colorScheme:A.status==="active"?"green":"gray",children:A.status==="active"?"Activo":"Inactivo"})}),e.jsx(le,{children:e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Ver detalles",children:e.jsx(_e,{icon:e.jsx(Vs,{}),size:"sm",onClick:()=>Ne(A)})}),e.jsx(Oe,{label:"Editar",children:e.jsx(_e,{icon:e.jsx(wr,{}),size:"sm",colorScheme:"blue",onClick:()=>Ae(A)})}),e.jsx(Oe,{label:"Eliminar",children:e.jsx(_e,{icon:e.jsx(cn,{}),size:"sm",colorScheme:"red",onClick:()=>xe(A.id)})})]})})]},A.id))})]})})]})]}),e.jsxs(Ve,{isOpen:r,onClose:i,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Nuevo Cliente"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre Completo"}),e.jsx(re,{value:g.name,onChange:A=>B({...g,name:A.target.value}),placeholder:"Ingresa el nombre completo"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"DNI"}),e.jsx(re,{value:g.document,onChange:A=>B({...g,document:A.target.value}),placeholder:"Ingresa el DNI"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Teléfono"}),e.jsx(re,{value:g.phone,onChange:A=>B({...g,phone:A.target.value}),placeholder:"Ingresa el teléfono"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Email"}),e.jsx(re,{type:"email",value:g.email,onChange:A=>B({...g,email:A.target.value}),placeholder:"Ingresa el email"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Dirección"}),e.jsx(re,{value:g.address,onChange:A=>B({...g,address:A.target.value}),placeholder:"Ingresa la dirección"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Distrito"}),e.jsx(re,{value:g.district,onChange:A=>B({...g,district:A.target.value}),placeholder:"Ingresa el distrito"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Referencia"}),e.jsx(re,{value:g.reference,onChange:A=>B({...g,reference:A.target.value}),placeholder:"Referencia de la dirección"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas"}),e.jsx(ks,{value:g.notes,onChange:A=>B({...g,notes:A.target.value}),placeholder:"Notas adicionales"})]}),e.jsx(O,{colorScheme:"blue",onClick:te,w:"full",children:"Crear Cliente"})]})})]})]}),e.jsxs(Ve,{isOpen:l,onClose:c,size:"lg",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Editar Cliente"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsxs(u,{spacing:4,children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre Completo"}),e.jsx(re,{value:g.name,onChange:A=>B({...g,name:A.target.value}),placeholder:"Ingresa el nombre completo"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"DNI"}),e.jsx(re,{value:g.document,onChange:A=>B({...g,document:A.target.value}),placeholder:"Ingresa el DNI"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Teléfono"}),e.jsx(re,{value:g.phone,onChange:A=>B({...g,phone:A.target.value}),placeholder:"Ingresa el teléfono"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Email"}),e.jsx(re,{type:"email",value:g.email,onChange:A=>B({...g,email:A.target.value}),placeholder:"Ingresa el email"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Dirección"}),e.jsx(re,{value:g.address,onChange:A=>B({...g,address:A.target.value}),placeholder:"Ingresa la dirección"})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Distrito"}),e.jsx(re,{value:g.district,onChange:A=>B({...g,district:A.target.value}),placeholder:"Ingresa el distrito"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Referencia"}),e.jsx(re,{value:g.reference,onChange:A=>B({...g,reference:A.target.value}),placeholder:"Referencia de la dirección"})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Notas"}),e.jsx(ks,{value:g.notes,onChange:A=>B({...g,notes:A.target.value}),placeholder:"Notas adicionales"})]}),e.jsx(O,{colorScheme:"blue",onClick:Ce,w:"full",children:"Actualizar Cliente"})]})})]})]}),e.jsxs(Ve,{isOpen:d,onClose:P,size:"md",isCentered:!0,children:[e.jsx(We,{}),e.jsxs(qe,{children:[e.jsx(Me,{children:"Detalles del Cliente"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:E&&e.jsx(u,{spacing:4,align:"stretch",children:e.jsx(F,{children:e.jsx(L,{children:e.jsxs(u,{spacing:3,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Nombre:"}),e.jsx(n,{children:E.name})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"DNI:"}),e.jsx(n,{children:E.documentNumber})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Teléfono:"}),e.jsx(n,{children:E.phone})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Email:"}),e.jsx(n,{children:E.email||"No especificado"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Dirección:"}),e.jsx(n,{children:E.address})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Distrito:"}),e.jsx(n,{children:E.district})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Referencia:"}),e.jsx(n,{children:E.reference||"No especificada"})]}),e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontWeight:"bold",children:"Estado:"}),e.jsx(ye,{colorScheme:E.status==="active"?"green":"gray",children:E.status==="active"?"Activo":"Inactivo"})]}),E.notes&&e.jsxs(u,{align:"stretch",children:[e.jsx(n,{fontWeight:"bold",children:"Notas:"}),e.jsx(n,{fontSize:"sm",color:"gray.600",children:E.notes})]})]})})})})})]})]})]})},Vl=()=>{const[s,t]=S.useState([]),[r,a]=S.useState(!0),[i,l]=S.useState(null),[o,c]=S.useState(!1),[d,f]=S.useState({version:"",title:"",content:"",effectiveDate:""}),[P,I]=S.useState({page:1,limit:10,total:0,pages:0}),[m,T]=S.useState("all"),{isOpen:C,onOpen:D,onClose:_}=Le(),y=ps(),z=Ze("white","gray.800");Ze("gray.200","gray.600"),S.useEffect(()=>{E()},[P.page,m]);const E=async()=>{try{a(!0);const g=localStorage.getItem("token"),B=new URLSearchParams({page:P.page,limit:P.limit});m!=="all"&&B.append("status",m),console.log("🔄 Llamando a /api/terms-and-conditions con params:",B.toString());const V=await as.get(`/api/terms-and-conditions?${B}`);console.log("📦 Respuesta términos:",V.data),t(V.data.data||[]),I(te=>{var Ce,xe;return{...te,total:((Ce=V.data.pagination)==null?void 0:Ce.total)||0,pages:((xe=V.data.pagination)==null?void 0:xe.pages)||1}})}catch(g){console.error("Error fetching terms:",g),y({title:"Error",description:"Error al cargar términos y condiciones",status:"error",duration:3e3,isClosable:!0})}finally{a(!1)}},N=()=>{l(null),c(!0),f({version:"",title:"",content:"",effectiveDate:new Date().toISOString().split("T")[0]}),D()},$=g=>{l(g),c(!0),f({version:g.version,title:g.title,content:g.content,effectiveDate:g.effectiveDate.split("T")[0]}),D()},R=g=>{l(g),c(!1),f({version:g.version,title:g.title,content:g.content,effectiveDate:g.effectiveDate.split("T")[0]}),D()},p=async g=>{var B,V;g.preventDefault();try{const te=localStorage.getItem("token");i?(await as.put(`/api/terms-and-conditions/${i.id}`,d),y({title:"Éxito",description:"Términos y condiciones actualizados",status:"success",duration:3e3,isClosable:!0})):(await as.post("/api/terms-and-conditions",d),y({title:"Éxito",description:"Términos y condiciones creados",status:"success",duration:3e3,isClosable:!0})),_(),E()}catch(te){console.error("Error saving terms:",te),y({title:"Error",description:((V=(B=te.response)==null?void 0:B.data)==null?void 0:V.message)||"Error al guardar términos",status:"error",duration:3e3,isClosable:!0})}},H=async g=>{try{const B=localStorage.getItem("token");await as.patch(`/api/terms-and-conditions/${g.id}/toggle`,{}),y({title:"Éxito",description:`Términos ${g.isActive?"desactivados":"activados"}`,status:"success",duration:3e3,isClosable:!0}),E()}catch(B){console.error("Error toggling status:",B),y({title:"Error",description:"Error al cambiar estado",status:"error",duration:3e3,isClosable:!0})}},b=async g=>{var B,V;if(window.confirm("¿Estás seguro de eliminar estos términos y condiciones?"))try{const te=localStorage.getItem("token");await as.delete(`/api/terms-and-conditions/${g.id}`),y({title:"Éxito",description:"Términos y condiciones eliminados",status:"success",duration:3e3,isClosable:!0}),E()}catch(te){console.error("Error deleting terms:",te),y({title:"Error",description:((V=(B=te.response)==null?void 0:B.data)==null?void 0:V.message)||"Error al eliminar términos",status:"error",duration:3e3,isClosable:!0})}},ae=g=>new Date(g).toLocaleDateString("es-PE");return r?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsxs(k,{p:6,bg:z,borderRadius:"lg",boxShadow:"sm",children:[e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontSize:"2xl",fontWeight:"bold",color:"blue.600",children:"Gestión de Términos y Condiciones"}),e.jsx(O,{leftIcon:e.jsx(Rr,{}),colorScheme:"blue",onClick:N,children:"Crear Nuevos Términos"})]}),e.jsx(h,{spacing:4,children:e.jsxs(U,{maxW:"200px",children:[e.jsx(G,{children:"Estado"}),e.jsxs(Je,{value:m,onChange:g=>T(g.target.value),children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"inactive",children:"Inactivos"})]})]})}),e.jsx(k,{overflowX:"auto",children:e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Versión"}),e.jsx(oe,{children:"Título"}),e.jsx(oe,{children:"Estado"}),e.jsx(oe,{children:"Fecha Vigencia"}),e.jsx(oe,{children:"Creado"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:s.map(g=>e.jsxs(ms,{children:[e.jsx(le,{fontWeight:"bold",children:g.version}),e.jsx(le,{maxW:"300px",isTruncated:!0,children:g.title}),e.jsx(le,{children:e.jsx(ye,{colorScheme:g.isActive?"green":"red",variant:"subtle",children:g.isActive?"Activo":"Inactivo"})}),e.jsx(le,{children:ae(g.effectiveDate)}),e.jsx(le,{children:ae(g.createdAt)}),e.jsx(le,{children:e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Ver",children:e.jsx(_e,{icon:e.jsx(Nr,{}),size:"sm",variant:"ghost",onClick:()=>R(g)})}),e.jsx(Oe,{label:"Editar",children:e.jsx(_e,{icon:e.jsx(Vt,{}),size:"sm",variant:"ghost",colorScheme:"blue",onClick:()=>$(g)})}),e.jsx(Oe,{label:g.isActive?"Desactivar":"Activar",children:e.jsx(jr,{isChecked:g.isActive,onChange:()=>H(g),colorScheme:"green"})}),!g.isActive&&e.jsx(Oe,{label:"Eliminar",children:e.jsx(_e,{icon:e.jsx(Or,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>b(g)})})]})})]},g.id))})]})}),P.pages>1&&e.jsxs(h,{justify:"center",spacing:4,children:[e.jsx(O,{isDisabled:P.page===1,onClick:()=>I(g=>({...g,page:g.page-1})),children:"Anterior"}),e.jsxs(n,{children:["Página ",P.page," de ",P.pages]}),e.jsx(O,{isDisabled:P.page===P.pages,onClick:()=>I(g=>({...g,page:g.page+1})),children:"Siguiente"})]})]}),e.jsxs(Ve,{isOpen:C,onClose:_,size:"xl",children:[e.jsx(We,{}),e.jsxs(qe,{maxW:"800px",children:[e.jsx(Me,{children:o?"Editar Términos y Condiciones":"Ver Términos y Condiciones"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsx("form",{onSubmit:p,children:e.jsxs(u,{spacing:4,align:"stretch",children:[e.jsxs(h,{children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Versión"}),e.jsx(re,{value:d.version,onChange:g=>f(B=>({...B,version:g.target.value})),placeholder:"ej: 1.0, 2.0",isDisabled:!o})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Fecha de Vigencia"}),e.jsx(re,{type:"date",value:d.effectiveDate,onChange:g=>f(B=>({...B,effectiveDate:g.target.value})),isDisabled:!o})]})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Título"}),e.jsx(re,{value:d.title,onChange:g=>f(B=>({...B,title:g.target.value})),placeholder:"Título de los términos y condiciones",isDisabled:!o})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Contenido"}),e.jsx(ks,{value:d.content,onChange:g=>f(B=>({...B,content:g.target.value})),placeholder:"Contenido completo de los términos y condiciones...",rows:15,isDisabled:!o})]}),o&&e.jsxs(h,{justify:"flex-end",children:[e.jsx(O,{variant:"ghost",onClick:_,children:"Cancelar"}),e.jsx(O,{type:"submit",colorScheme:"blue",children:i?"Actualizar":"Crear"})]}),!o&&e.jsx(h,{justify:"flex-end",children:e.jsx(O,{onClick:_,children:"Cerrar"})})]})})})]})]})]})},ql=()=>{const[s,t]=li(),[r,a]=S.useState([]),[i,l]=S.useState(!0),{user:o}=Rs(),[c,d]=S.useState(null),[f,P]=S.useState(!1),[I,m]=S.useState(!1),[T,C]=S.useState({username:"",email:"",password:"",role:"repartidor",isActive:!0,firstName:"",lastName:"",documentNumber:"",phone:"",address:"",district:"",reference:"",vehicleType:"",vehiclePlate:"",licenseNumber:"",insuranceNumber:"",emergencyContact:"",emergencyPhone:""}),[D,_]=S.useState(!1),[y,z]=S.useState({page:1,limit:10,total:0,pages:0}),[E,N]=S.useState("all"),{isOpen:$,onOpen:R,onClose:p}=Le(),H=ps(),b=Ze("white","gray.800");Ze("gray.200","gray.600"),S.useEffect(()=>{const w=s.get("role");w&&w!=="all"&&N(w)},[s]),S.useEffect(()=>{ae()},[y.page,E]);const ae=async()=>{var w,Q,ne;try{l(!0);const de=localStorage.getItem("token");console.log("🔑 Token para usuarios:",de?"Presente":"Ausente"),console.log("🔑 Token completo:",de),de&&!as.defaults.headers.common.Authorization&&(as.defaults.headers.common.Authorization=`Bearer ${de}`,console.log("🔑 Token configurado en axios")),console.log("🔑 Header Authorization actual:",as.defaults.headers.common.Authorization),console.log("🔄 Llamando a /api/users/role con role:",E);let A;if(E==="all"){console.log("🔄 Obteniendo usuarios de todos los roles...");const[me,M,Y]=await Promise.all([as.get("/api/users/role?role=admin"),as.get("/api/users/role?role=vendedor"),as.get("/api/users/role?role=repartidor")]);console.log("📦 Admin users:",me.data),console.log("📦 Vendedor users:",M.data),console.log("📦 Repartidor users:",Y.data),A={data:{success:!0,data:[...me.data.success?me.data.data:[],...M.data.success?M.data.data:[],...Y.data.success?Y.data.data:[]]}}}else console.log("🔄 Obteniendo usuarios del rol:",E),A=await as.get(`/api/users/role?role=${E}`);console.log("📦 Respuesta usuarios:",A.data),A.data.success?(a(A.data.data||[]),z(me=>{var M;return{...me,total:((M=A.data.data)==null?void 0:M.length)||0,pages:1}})):(a([]),z(me=>({...me,total:0,pages:1})))}catch(de){console.error("Error fetching users:",de),console.error("Error details:",(w=de.response)==null?void 0:w.data),console.error("Error status:",(Q=de.response)==null?void 0:Q.status),console.error("Error headers:",(ne=de.response)==null?void 0:ne.headers),H({title:"Error",description:"Error al cargar usuarios",status:"error",duration:3e3,isClosable:!0}),a([])}finally{l(!1)}},g=()=>{d(null),m(!0),P(!0),C({username:"",email:"",password:"",role:"repartidor",isActive:!0,firstName:"",lastName:"",documentNumber:"",phone:"",address:"",district:"",reference:"",vehicleType:"",vehiclePlate:"",licenseNumber:"",insuranceNumber:"",emergencyContact:"",emergencyPhone:""}),R()},B=w=>{d(w),m(!1),P(!0),C({username:w.username,email:w.email,password:"",role:w.role,isActive:w.isActive,firstName:w.firstName||"",lastName:w.lastName||"",documentNumber:w.documentNumber||"",phone:w.phone||"",address:w.address||"",district:w.district||"",reference:w.reference||"",vehicleType:w.vehicleType||"",vehiclePlate:w.vehiclePlate||"",licenseNumber:w.licenseNumber||"",insuranceNumber:w.insuranceNumber||"",emergencyContact:w.emergencyContact||"",emergencyPhone:w.emergencyPhone||""}),R()},V=w=>{d(w),m(!1),P(!1),C({username:w.username,email:w.email,password:"",role:w.role,isActive:w.isActive,firstName:w.firstName||"",lastName:w.lastName||"",documentNumber:w.documentNumber||"",phone:w.phone||"",address:w.address||"",district:w.district||"",reference:w.reference||"",vehicleType:w.vehicleType||"",vehiclePlate:w.vehiclePlate||"",licenseNumber:w.licenseNumber||"",insuranceNumber:w.insuranceNumber||"",emergencyContact:w.emergencyContact||"",emergencyPhone:w.emergencyPhone||""}),R()},te=async w=>{var Q,ne;w.preventDefault();try{const de=localStorage.getItem("token"),A={username:T.username,email:T.email,role:T.role,isActive:T.isActive};(I||T.password)&&(A.password=T.password),I?(await as.post("/api/users",A),H({title:"Éxito",description:"Usuario creado exitosamente",status:"success",duration:3e3,isClosable:!0})):(await as.put(`/api/users/${c.id}`,A),H({title:"Éxito",description:"Usuario actualizado exitosamente",status:"success",duration:3e3,isClosable:!0})),p(),ae()}catch(de){console.error("Error saving user:",de),H({title:"Error",description:((ne=(Q=de.response)==null?void 0:Q.data)==null?void 0:ne.message)||"Error al guardar usuario",status:"error",duration:3e3,isClosable:!0})}},Ce=async w=>{try{const Q=localStorage.getItem("token");await as.patch(`/api/users/${w.id}/toggle-status`,{}),H({title:"Éxito",description:`Usuario ${w.isActive?"desactivado":"activado"}`,status:"success",duration:3e3,isClosable:!0}),ae()}catch(Q){console.error("Error toggling status:",Q),H({title:"Error",description:"Error al cambiar estado del usuario",status:"error",duration:3e3,isClosable:!0})}},xe=async w=>{var Q,ne;if(o&&o.id===w.id){H({title:"Error",description:"No puedes eliminarte a ti mismo",status:"error",duration:3e3,isClosable:!0});return}if(window.confirm(`¿Estás seguro de eliminar al usuario "${w.username}"?`))try{const de=localStorage.getItem("token");await as.delete(`/api/users/${w.id}`),H({title:"Éxito",description:"Usuario eliminado exitosamente",status:"success",duration:3e3,isClosable:!0}),ae()}catch(de){console.error("Error deleting user:",de),H({title:"Error",description:((ne=(Q=de.response)==null?void 0:Q.data)==null?void 0:ne.message)||"Error al eliminar usuario",status:"error",duration:3e3,isClosable:!0})}},Ae=w=>{switch(w){case"admin":return"red";case"vendedor":return"blue";case"repartidor":return"green";default:return"gray"}},Ne=w=>{switch(w){case"admin":return"Administrador";case"vendedor":return"Vendedor";case"repartidor":return"Repartidor";default:return w}};return i?e.jsx(is,{h:"400px",children:e.jsx(Ss,{size:"xl"})}):e.jsxs(k,{p:6,bg:b,borderRadius:"lg",boxShadow:"sm",children:[e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(h,{justify:"space-between",children:[e.jsx(n,{fontSize:"2xl",fontWeight:"bold",color:"blue.600",children:"Gestión de Usuarios"}),e.jsx(O,{leftIcon:e.jsx(Rr,{}),colorScheme:"blue",onClick:g,children:"Crear Usuario"})]}),e.jsx(h,{spacing:4,children:e.jsxs(U,{maxW:"200px",children:[e.jsx(G,{children:"Rol"}),e.jsxs(Je,{value:E,onChange:w=>N(w.target.value),children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"vendedor",children:"Vendedor"}),e.jsx("option",{value:"repartidor",children:"Repartidor"})]})]})}),e.jsx(k,{overflowX:"auto",children:e.jsxs(Zs,{variant:"simple",children:[e.jsx(et,{children:e.jsxs(ms,{children:[e.jsx(oe,{children:"Usuario"}),e.jsx(oe,{children:"Nombre"}),e.jsx(oe,{children:"Email"}),e.jsx(oe,{children:"Rol"}),e.jsx(oe,{children:"Estado"}),e.jsx(oe,{children:"Creado"}),e.jsx(oe,{children:"Acciones"})]})}),e.jsx(st,{children:r.map(w=>e.jsxs(ms,{children:[e.jsx(le,{fontWeight:"bold",children:w.username}),e.jsx(le,{children:w.firstName&&w.lastName?`${w.firstName} ${w.lastName}`:w.firstName||w.lastName||"-"}),e.jsx(le,{children:w.email}),e.jsx(le,{children:e.jsx(ye,{colorScheme:Ae(w.role),variant:"subtle",children:Ne(w.role)})}),e.jsx(le,{children:e.jsx(ye,{colorScheme:w.isActive?"green":"red",variant:"subtle",children:w.isActive?"Activo":"Inactivo"})}),e.jsx(le,{children:new Date(w.createdAt).toLocaleDateString("es-PE")}),e.jsx(le,{children:e.jsxs(h,{spacing:2,children:[e.jsx(Oe,{label:"Ver",children:e.jsx(_e,{icon:e.jsx(Nr,{}),size:"sm",variant:"ghost",onClick:()=>V(w)})}),e.jsx(Oe,{label:"Editar",children:e.jsx(_e,{icon:e.jsx(Vt,{}),size:"sm",variant:"ghost",colorScheme:"blue",onClick:()=>B(w)})}),e.jsx(Oe,{label:w.isActive?"Desactivar":"Activar",children:e.jsx(jr,{isChecked:w.isActive,onChange:()=>Ce(w),colorScheme:"green"})}),e.jsx(Oe,{label:o&&o.id===w.id?"No puedes eliminarte a ti mismo":"Eliminar",children:e.jsx(_e,{icon:e.jsx(Or,{}),size:"sm",variant:"ghost",colorScheme:"red",isDisabled:o&&o.id===w.id,onClick:()=>xe(w)})})]})})]},w.id))})]})}),y.pages>1&&e.jsxs(h,{justify:"center",spacing:4,children:[e.jsx(O,{isDisabled:y.page===1,onClick:()=>z(w=>({...w,page:w.page-1})),children:"Anterior"}),e.jsxs(n,{children:["Página ",y.page," de ",y.pages]}),e.jsx(O,{isDisabled:y.page===y.pages,onClick:()=>z(w=>({...w,page:w.page+1})),children:"Siguiente"})]})]}),e.jsxs(Ve,{isOpen:$,onClose:p,size:"xl",children:[e.jsx(We,{}),e.jsxs(qe,{maxW:"800px",maxH:"90vh",overflowY:"auto",children:[e.jsx(Me,{children:I?"Crear Usuario":f?"Editar Usuario":"Ver Usuario"}),e.jsx(He,{}),e.jsx($e,{pb:6,children:e.jsx("form",{onSubmit:te,children:e.jsxs(u,{spacing:6,align:"stretch",children:[e.jsxs(k,{children:[e.jsx(n,{fontSize:"lg",fontWeight:"bold",mb:4,color:"blue.600",children:"Información Básica"}),e.jsxs(u,{spacing:4,children:[e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre de Usuario"}),e.jsx(re,{value:T.username,onChange:w=>C(Q=>({...Q,username:w.target.value})),placeholder:"Nombre de usuario",isDisabled:!f})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Email"}),e.jsx(re,{type:"email",value:T.email,onChange:w=>C(Q=>({...Q,email:w.target.value})),placeholder:"correo@ejemplo.com",isDisabled:!f})]})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Nombre"}),e.jsx(re,{value:T.firstName,onChange:w=>C(Q=>({...Q,firstName:w.target.value})),placeholder:"Nombre",isDisabled:!f})]}),e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Apellido"}),e.jsx(re,{value:T.lastName,onChange:w=>C(Q=>({...Q,lastName:w.target.value})),placeholder:"Apellido",isDisabled:!f})]})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{children:[e.jsx(G,{children:"DNI"}),e.jsx(re,{value:T.documentNumber,onChange:w=>C(Q=>({...Q,documentNumber:w.target.value})),placeholder:"12345678",isDisabled:!f})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Teléfono"}),e.jsx(re,{value:T.phone,onChange:w=>C(Q=>({...Q,phone:w.target.value})),placeholder:"987654321",isDisabled:!f})]})]}),e.jsxs(U,{isRequired:I,children:[e.jsxs(G,{children:["Contraseña ",!I&&"(dejar vacío para mantener la actual)"]}),e.jsxs(Ct,{children:[e.jsx(re,{type:D?"text":"password",value:T.password,onChange:w=>C(Q=>({...Q,password:w.target.value})),placeholder:I?"Contraseña":"Nueva contraseña (opcional)",isDisabled:!f}),e.jsx(kn,{children:e.jsx(_e,{"aria-label":D?"Ocultar contraseña":"Mostrar contraseña",icon:D?e.jsx(Un,{}):e.jsx(Vs,{}),variant:"ghost",size:"sm",onClick:()=>_(!D),isDisabled:!f})})]})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{isRequired:!0,children:[e.jsx(G,{children:"Rol"}),e.jsxs(Je,{value:T.role,onChange:w=>C(Q=>({...Q,role:w.target.value})),isDisabled:!f,children:[e.jsx("option",{value:"repartidor",children:"Repartidor"}),e.jsx("option",{value:"vendedor",children:"Vendedor"}),e.jsx("option",{value:"admin",children:"Administrador"})]})]}),e.jsx(U,{children:e.jsxs(h,{justify:"space-between",children:[e.jsx(G,{mb:0,children:"Usuario Activo"}),e.jsx(jr,{isChecked:T.isActive,onChange:w=>C(Q=>({...Q,isActive:w.target.checked})),isDisabled:!f,colorScheme:"green"})]})})]})]})]}),e.jsxs(k,{children:[e.jsx(n,{fontSize:"lg",fontWeight:"bold",mb:4,color:"blue.600",children:"Dirección"}),e.jsxs(u,{spacing:4,children:[e.jsxs(U,{children:[e.jsx(G,{children:"Dirección"}),e.jsx(re,{value:T.address,onChange:w=>C(Q=>({...Q,address:w.target.value})),placeholder:"Jr. Las Flores 123",isDisabled:!f})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Distrito"}),e.jsx(re,{value:T.district,onChange:w=>C(Q=>({...Q,district:w.target.value})),placeholder:"Callería",isDisabled:!f})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Referencia"}),e.jsx(re,{value:T.reference,onChange:w=>C(Q=>({...Q,reference:w.target.value})),placeholder:"Frente al parque",isDisabled:!f})]})]})]})]}),T.role==="repartidor"&&e.jsxs(k,{children:[e.jsx(n,{fontSize:"lg",fontWeight:"bold",mb:4,color:"green.600",children:"Datos de Repartidor"}),e.jsxs(u,{spacing:4,children:[e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Tipo de Vehículo"}),e.jsxs(Je,{value:T.vehicleType,onChange:w=>C(Q=>({...Q,vehicleType:w.target.value})),isDisabled:!f,children:[e.jsx("option",{value:"",children:"Seleccionar"}),e.jsx("option",{value:"motorcycle",children:"Motocicleta"}),e.jsx("option",{value:"bicycle",children:"Bicicleta"}),e.jsx("option",{value:"car",children:"Auto"}),e.jsx("option",{value:"truck",children:"Camión"})]})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Placa del Vehículo"}),e.jsx(re,{value:T.vehiclePlate,onChange:w=>C(Q=>({...Q,vehiclePlate:w.target.value})),placeholder:"ABC-123",isDisabled:!f})]})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Número de Licencia"}),e.jsx(re,{value:T.licenseNumber,onChange:w=>C(Q=>({...Q,licenseNumber:w.target.value})),placeholder:"12345678",isDisabled:!f})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Número de Seguro"}),e.jsx(re,{value:T.insuranceNumber,onChange:w=>C(Q=>({...Q,insuranceNumber:w.target.value})),placeholder:"987654321",isDisabled:!f})]})]}),e.jsxs(h,{spacing:4,w:"full",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Contacto de Emergencia"}),e.jsx(re,{value:T.emergencyContact,onChange:w=>C(Q=>({...Q,emergencyContact:w.target.value})),placeholder:"María García",isDisabled:!f})]}),e.jsxs(U,{children:[e.jsx(G,{children:"Teléfono de Emergencia"}),e.jsx(re,{value:T.emergencyPhone,onChange:w=>C(Q=>({...Q,emergencyPhone:w.target.value})),placeholder:"987654321",isDisabled:!f})]})]})]})]}),f&&e.jsxs(h,{justify:"flex-end",children:[e.jsx(O,{variant:"ghost",onClick:p,children:"Cancelar"}),e.jsx(O,{type:"submit",colorScheme:"blue",children:I?"Crear":"Actualizar"})]}),!f&&e.jsx(h,{justify:"flex-end",children:e.jsx(O,{onClick:p,children:"Cerrar"})})]})})})]})]})]})},Hl=()=>{const{token:s,checkAuth:t}=Rs(),[r,a]=S.useState(!0);return S.useEffect(()=>{(async()=>{try{console.log("🔄 Iniciando verificación de autenticación...");const l=await t();console.log("✅ Verificación completada, autenticado:",l)}catch(l){console.error("❌ Error en verificación de autenticación:",l)}finally{a(!1)}})()},[t]),r?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Cargando..."})]}):e.jsxs(ci,{children:[e.jsx(ns,{path:"/",element:e.jsx(jl,{}),children:e.jsx(ns,{index:!0,element:e.jsx(zl,{})})}),e.jsx(ns,{path:"/guest-order",element:e.jsx(_l,{})}),e.jsx(ns,{path:"/receipt/:id",element:e.jsx(Nl,{})}),e.jsx(ns,{path:"/track/:id",element:e.jsx(Rl,{})}),e.jsx(ns,{path:"/delivery-login",element:e.jsx(Fl,{})}),e.jsxs(ns,{path:"/dashboard",element:s?e.jsx(zn,{}):e.jsx(ft,{to:"/",replace:!0}),children:[e.jsx(ns,{index:!0,element:e.jsx(Ds,{requiredRoles:["admin","vendedor"],children:e.jsx(Al,{})})}),e.jsx(ns,{path:"orders-management",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(El,{})})}),e.jsx(ns,{path:"delivery-fees",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(kl,{})})}),e.jsx(ns,{path:"subscriptions",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(Wl,{})})}),e.jsx(ns,{path:"vales",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(Ml,{})})}),e.jsx(ns,{path:"collection-report",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx($l,{})})}),e.jsx(ns,{path:"clients",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(Bl,{})})}),e.jsx(ns,{path:"terms-and-conditions",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(Vl,{})})}),e.jsx(ns,{path:"users-management",element:e.jsx(Ds,{requiredRoles:["admin"],children:e.jsx(ql,{})})})]}),e.jsx(ns,{path:"/delivery-dashboard",element:s?e.jsx(zn,{}):e.jsx(ft,{to:"/delivery-login",replace:!0}),children:e.jsx(ns,{index:!0,element:e.jsx(Ds,{requiredRoles:["repartidor"],children:e.jsx(Ol,{})})})}),e.jsx(ns,{path:"*",element:e.jsx(ft,{to:"/",replace:!0})})]})},Ms={base:1,content:1,dropdown:100,sticky:200,banner:300,overlay:400,header:999,sidebar:1e3,modal:1300,popover:1400,tooltip:1500,notification:1600,toast:1700,skipLink:1800},Ul=ri`
  0% { opacity: 0.8; transform: scale(1); }
  50% { opacity: 0.4; transform: scale(1.2); }
  100% { opacity: 0.8; transform: scale(1); }
`,Gl=ni({zIndices:Ms,styles:{global:{".pulse-animation":{animation:`${Ul} 2s infinite`}}},components:{Modal:{baseStyle:{overlay:{zIndex:Ms.modal},dialogContainer:{zIndex:Ms.modal}}},Menu:{baseStyle:{list:{zIndex:Ms.dropdown}}},Popover:{baseStyle:{content:{zIndex:Ms.popover}}},Tooltip:{baseStyle:{zIndex:Ms.tooltip}},Drawer:{baseStyle:{overlay:{zIndex:Ms.modal},dialogContainer:{zIndex:Ms.modal}}}},colors:{brand:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1"}}});br.createRoot(document.getElementById("root")).render(e.jsx(pe.StrictMode,{children:e.jsx(ai,{theme:Gl,children:e.jsxs(di,{children:[e.jsx(Hl,{}),e.jsx(Hi,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,style:{zIndex:1700}})]})})}));
